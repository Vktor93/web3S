define("modules/clean/react/home/api",["require","exports","tslib","modules/clean/ajax","modules/clean/api_v2/client","modules/core/exception","modules/clean/web_timing_logger"],function(e,t,r,o,a,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=Promise.resolve({});t.makeRequest=function(e,t){void 0===t&&(t={});var a,n=function(a,n){(t.isBackground?o.SilentBackgroundRequest:o.WebRequest)(r.__assign({dataType:"json",success:a,error:function(r,o,a){var s=e&&e.url||"no url";i.reportStack("makeRequest to '"+s+"' failed - "+o+": '"+a+"'",{severity:i.SEVERITY.NONCRITICAL,exc_extra:{errorThrown:a,textStatus:o,requestParams:e,requestOptions:t,"exclog.exc_group":"homeapi:"+o+":"+a+":"+s}}),n(Error(a+" ("+s+")"))}},e))};return t.useQueue?(a=new Promise(function(e,t){s.finally(function(){n(e,t)})}),s=a):a=new Promise(function(e,t){n(e,t)}),a},t.logHomeActivity=function(e){var r=e.entryType,o=e.eventName,a=e.extra,i=e.role;Object.keys(a).forEach(function(e){return a[e]=String(a[e])});var s=window.performance&&window.performance.timing?window.performance.timing.navigationStart||window.performance.timing.fetchStart:void 0;return new Promise(function(e,d){n.waitForTTI().then(function(){t.makeRequest({url:"/home_feed/log_activity",type:"POST",data:{entry_type:r,event_name:o,extra:JSON.stringify(a),role:i,page_start_ts:s}},{isBackground:!0}).then(e,d)})})},t.setSectionVisibility=function(e,t,r){return(new a.ApiV2Client).rpc(e,"home/set_section_visibility",{section:t,visible:r})},t.createPaperDoc=function(e){return(new a.ApiV2Client).upload(e,"paper/docs/create",{import_format:"plain_text"},"")}}),define("modules/clean/react/home/starred/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredResourceActionTypes={LOADING_INITIAL:"HOME_STARRED_LOADING_INITIAL",LOADING_ALL:"HOME_STARRED_LOADING_ALL",LOAD_SUCCESS:"HOME_STARRED_LOAD_SUCCESS",LOAD_FAILURE:"HOME_STARRED_LOAD_FAILURE",HIDE_EMPTY_SECTION:"HOME_STARRED_HIDE_EMPTY_SECTION"},t.NOT_PAPER_USER_ERROR="not_paper_user",t.NUM_ACTIVITIES_PER_ITEM=5,t.StarredLoggingTypes={CLICK_STAR:"click_star",CLICK_UNSTAR:"click_unstar"}}),define("modules/clean/react/starred/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/starred/constants","modules/constants/home","modules/clean/react/starred/api","modules/clean/react/starred/model"],function(e,t,r,o,a,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){}return e.fetchStatuses=function(t,a,s){return void 0===s&&(s=!1),s||e.markAsLoading(a),i.fetchStatuses(t,a).then(function(e){r.dispatch({type:o.StarredActionTypes.SET_STATUS,starredStatuses:n.statusResultsToStarredStatuses(e)})}).catch(function(e){return r.dispatch({type:o.StarredActionTypes.LOAD_FAILURE,idTypePairs:a}),Promise.reject(e)})},e.markAsLoading=function(e){r.dispatch({type:o.StarredActionTypes.LOADING,idTypePairs:e})},e.renameExternalResource=function(e,t,a){r.dispatch({type:o.StarredActionTypes.RENAME_EXTERNAL_RESOURCE,id:e,name:a});var n=i.updateExternalResource(e,a,!0);return n.catch(function(a){throw r.dispatch({type:o.StarredActionTypes.RENAME_EXTERNAL_RESOURCE,id:e,name:t}),a}),n},e.update=function(e,t,n,s,d,c){var u={id:t,type:n};r.dispatch({type:o.StarredActionTypes.LOADING,idTypePairs:[u]});var p,l;if(n===o.IdTypes.EXTERNAL_RESOURCE_ID){if(null===d||void 0===d)throw new TypeError("Name of external resource cannot be null/undefined");l=i.updateExternalResource(t,d,s,c)}else l=i.update(e,t,n,s);return l.then(function(){return p=s}).catch(function(e){throw p=!s,e}).finally(function(){r.dispatch({type:o.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:{id:t,type:n},starred:p}]});var e={url:t,name:d,isStarred:s};window.chrome&&(a.IS_PROD?window.chrome.runtime.sendMessage(o.StarExtensionId_PROD,e):window.chrome.runtime.sendMessage(o.StarExtensionId_DEV,e))}),l},e})();t.StarredActions=s}),define("modules/clean/react/starred/api",["require","exports","modules/clean/ajax"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){var o=function(o,a){r.WebRequest({url:e,type:"POST",dataType:"json",data:t,success:o,error:function(e,t,r){return a(Error(r))}})};return new Promise(function(e,t){o(e,t)})};t.fetchStatuses=function(e,t){return o("/starred/get_status",{role:e,resources_json:JSON.stringify(t)})},t.update=function(e,t,r,a){return o("/starred/update",{role:e,resource_id:t,id_type:r,is_starred:a})},t.updateExternalResource=function(e,t,r,a){return o("/starred/update_external_resource",{url:e,name:t,is_starred:r,favicon_url:a})}}),define("modules/clean/react/starred/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredLoadingState={LOADING:"LOADING",LOAD_SUCCESS:"LOAD_SUCCESS",LOAD_FAILED:"LOAD_FAILED"},t.StarredActionTypes={LOADING:"STARRED_LOADING",SET_STATUS:"STARRED_SET_STATUS",LOAD_FAILURE:"STARRED_LOAD_FAILURE",RENAME_EXTERNAL_RESOURCE:"STARRED_RENAME_EXTERNAL_RESOURCE"},t.IdTypes={ENCODED_FILE_OBJ_ID:"ENCODED_FILE_OBJ_ID",EXTERNAL_RESOURCE_ID:"EXTERNAL_RESOURCE_ID",PAPER_ID_PATH:"PAPER_ID_PATH"},t.StarExtensionId_DEV="bkoifdjjfabbedgjlkmkcabdpajmmlhd",t.StarExtensionId_PROD="hjdobpfegefofikebjlabkpjlndkfefg"}),define("modules/clean/react/starred/id_type_pair",["require","exports"],function(e,t){"use strict";function r(e){return e.type+":"+e.id}function o(e){return e.slice(e.indexOf(":")+1)}Object.defineProperty(t,"__esModule",{value:!0}),t.idTypePairToString=r,t.idFromIdTypePairString=o}),define("modules/clean/react/starred/model",["require","exports"],function(e,t){"use strict";function r(e){return e.map(function(e){var t=e.id,r=e.type,o=e.is_starred,a=e.canonical_id,i=e.canonical_id_type,n={idTypePair:{id:t,type:r},starred:o};return a&&i&&(n.canonicalIdTypePair={id:a,type:i}),n})}Object.defineProperty(t,"__esModule",{value:!0}),t.statusResultsToStarredStatuses=r}),define("modules/clean/react/starred/star",["require","exports","tslib","external/classnames","external/react","modules/clean/react/starred/starred_activity_logger","modules/clean/react/css","modules/clean/react/starred/actions","modules/clean/react/starred/store","modules/clean/react/title_bubble","modules/core/i18n","modules/core/notify","external/spectrum/icon_star"],function(e,t,r,o,a,i,n,s,d,c,u,p,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){function t(t){var r=e.call(this,t)||this;return r.onStoreUpdate=function(){var e=r.getStateFromStore();r.setState(e)},r.onClick=function(e){if(e.stopPropagation(),e.preventDefault(),!r.state.isLoading){var t=!r.state.isStarred;t?i.starredActivityLogger.logClickStar(r.props.id,r.props.idType,r.props.role):i.starredActivityLogger.logClickUnstar(r.props.id,r.props.idType,r.props.role),r.props.onStarClick&&r.props.onStarClick(t),s.StarredActions.update(r.props.role,r.props.id,r.props.idType,t,r.props.itemName).catch(function(e){var o;o=r.props.itemName?t?u._("There was a problem starring %(item_name)s").format({item_name:r.props.itemName}):u._("There was a problem unstarring %(item_name)s").format({item_name:r.props.itemName}):t?u._("There was a problem starring your selection"):u._("There was a problem unstarring your selection"),p.error(o)})}},r.state=r.getStateFromStore(),r.removeStoreListener=d.StarredStore.addListener(r.onStoreUpdate),r}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){this.removeStoreListener&&this.removeStoreListener()},t.prototype.componentWillReceiveProps=function(e){this.props.id===e.id&&this.props.idType===e.idType||this.setState(this.getStateFromStore(e))},t.prototype.getStateFromStore=function(e){void 0===e&&(e=this.props);var t={id:e.id,type:e.idType};return{isLoading:d.StarredStore.getIsLoading(t),isStarred:d.StarredStore.getIsStarred(t)}},t.prototype.getTooltipContent=function(){return this.state.isStarred?u._("Remove from Starred"):u._("Add to Starred")},t.prototype.render=function(){if(void 0===this.state.isStarred)return null;var e={star__toggle:!0,"star__toggle--starred":this.state.isStarred,"star__toggle--unstarred":!this.state.isStarred,"star__toggle--loading":this.state.isLoading};return a.createElement(c,{content:this.getTooltipContent(),position:this.props.tooltipPosition},a.createElement("button",{className:o(e),role:"button","aria-pressed":this.state.isStarred,"aria-label":"Star",onClick:this.onClick,onDoubleClick:this.onClick},a.createElement(l.IconStar,{selected:this.state.isStarred||this.state.isLoading})))},t})(a.PureComponent);S.displayName="Star",S.defaultProps={tooltipPosition:c.POSITIONS.TOP},t.Star=n(S,["/static/css/starred/star-vfl2033jV.css"])}),define("modules/clean/react/starred/starred_activity_logger",["require","exports","modules/clean/react/home/api","modules/clean/react/home/starred/constants"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(){}return e.prototype.logClickStar=function(e,t,a){return r.logHomeActivity({eventName:o.StarredLoggingTypes.CLICK_STAR,role:a,extra:{resource_id:e,id_type:t}})},e.prototype.logClickUnstar=function(e,t,a){return r.logHomeActivity({eventName:o.StarredLoggingTypes.CLICK_UNSTAR,role:a,extra:{resource_id:e,id_type:t}})},e})();t.StarredActivityLogger=a,t.starredActivityLogger=new a}),define("modules/clean/react/starred/store",["require","exports","tslib","external/underscore","modules/clean/flux/dispatcher","modules/clean/flux/flux_store","modules/clean/react/starred/constants","modules/clean/react/home/starred/constants","modules/clean/react/starred/id_type_pair"],function(e,t,r,o,a,i,n,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=e.call(this,a)||this;return t.idsToLoadingState={},t.idsToStarred={},t}return r.__extends(t,e),t.prototype.getLoadingStates=function(){return this.idsToLoadingState},t.prototype.hasIdTypePair=function(e){return this.idsToLoadingState.hasOwnProperty(d.idTypePairToString(e))},t.prototype.getLoadingState=function(e){return this.idsToLoadingState[d.idTypePairToString(e)]},t.prototype.getIsStarred=function(e){return this.idsToStarred[d.idTypePairToString(e)]},t.prototype.getAllStarredPairStrings=function(){return o.keys(o.pick(this.idsToStarred,function(e){return e}))},t.prototype.getIsLoading=function(e){return this.getLoadingState(e)===n.StarredLoadingState.LOADING},t.prototype.onLoading=function(e){var t={};e.forEach(function(e){return t[d.idTypePairToString(e)]=n.StarredLoadingState.LOADING}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,t)},t.prototype.onSetStatus=function(e){void 0===e&&(e=[]);var t={},o={};e.forEach(function(e){var r=d.idTypePairToString(e.idTypePair);t[r]=n.StarredLoadingState.LOAD_SUCCESS,o[r]=e.starred}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,t),this.idsToStarred=r.__assign({},this.idsToStarred,o)},t.prototype.onLoadFailure=function(e){var t=this,o={};e.forEach(function(e){var r=d.idTypePairToString(e),a=t.idsToLoadingState[r];void 0!==a&&a!==n.StarredLoadingState.LOADING||(o[r]=n.StarredLoadingState.LOAD_FAILED)}),this.idsToLoadingState=r.__assign({},this.idsToLoadingState,o)},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case n.StarredActionTypes.LOADING:this.onLoading(t.idTypePairs);break;case n.StarredActionTypes.SET_STATUS:case s.StarredResourceActionTypes.LOAD_SUCCESS:this.onSetStatus(t.starredStatuses);break;case n.StarredActionTypes.LOAD_FAILURE:this.onLoadFailure(t.idTypePairs);break;default:return}this.__emitChange()},t})(i);t._StarredStoreClass=c,t.StarredStore=new c});
//# sourceMappingURL=pkg-starred.min.js-vflEwL4-3.map