(function(){define("modules/clean/avatar/faceholder",["external/react","modules/clean/avatar/size","modules/clean/avatar/style","modules/clean/css","modules/clean/react/image","modules/clean/static_urls"],function(e,t,n,s,r,o){var i,a,l,d,c;return a=t.VALID_AVATAR_DIMENSIONS,d=n.getClassName,c=o.static_url,l=e.DOM,i=e.createClass({displayName:"Faceholder",propTypes:{alt:e.PropTypes.string,dimension:e.PropTypes.oneOf(a).isRequired,onClick:e.PropTypes.func,optionalClass:e.PropTypes.string},statics:{SRC_MAP:{16:c("/static/images/avatar/faceholder-16-vflzvFMED.png"),24:c("/static/images/avatar/faceholder-24-vflpqFBTK.png"),32:c("/static/images/avatar/faceholder-32-vflKWtuU5.png"),48:c("/static/images/avatar/faceholder-48-vfll8Voom.png"),64:c("/static/images/avatar/faceholder-64-vflHTEplh.png")},SRC_HI_RES_MAP:{16:c("/static/images/avatar/faceholder-16@2x-vflBZ7FgU.png"),24:c("/static/images/avatar/faceholder-24@2x-vflVegRLu.png"),32:c("/static/images/avatar/faceholder-32@2x-vflYmh947.png"),48:c("/static/images/avatar/faceholder-48@2x-vflUglZDR.png"),64:c("/static/images/avatar/faceholder-64@2x-vfl8eFSM8.png")}},componentDidMount:function(){return s.require_css("/static/css/scooter/scooter-scoped-vfl8iXN08.css")},render:function(){var t,n;return t=["c-avatar--circle"],this.props.optionalClass&&t.push(this.props.optionalClass),n=e.createElement(r,{alt:this.props.alt||"",src:i.SRC_MAP[this.props.dimension],srcHiRes:i.SRC_HI_RES_MAP[this.props.dimension]}),null!=this.props.onClick&&this.props.alt?(t.push("u-unbutton"),l.button({className:d(this.props.dimension,t),onClick:this.props.onClick},n)):l.div({className:d(this.props.dimension,t),onClick:this.props.onClick},n)}})})}).call(this),function(){define("modules/clean/avatar/inherited_count_avatar",["external/classnames","external/react","modules/clean/react/css"],function(e,t,n){var s,r;return r=t.DOM,s=t.createClass({displayName:"InheritedMemberCountAvatar",propTypes:{inheritedMemberCount:t.PropTypes.number.isRequired,onClick:t.PropTypes.func},render:function(){var t;return t=e({"inherited-count-avatar u-pad-horizontal-xxs":!0}),null!=this.props.onClick?r.button({className:t,onClick:this.props.onClick},this.props.inheritedMemberCount):r.div({className:t},this.props.inheritedMemberCount)}}),s=n(s,["/static/css/avatar_list-vfll-ERpM.css","/static/css/scooter/scooter-scoped-vfl8iXN08.css"])})}.call(this),function(){define("modules/clean/avatar/list",["external/classnames","external/react","modules/clean/avatar/inherited_count_avatar","modules/clean/avatar/overflow_count_pill","modules/clean/avatar/size","modules/clean/react/css"],function(e,t,n,s,r,o){var i,a,l,d;return a=r.VALID_AVATAR_DIMENSIONS,l=t.createElement,d=t.DOM,i=t.createClass({displayName:"HorizontalAvatarList",propTypes:{avatars:t.PropTypes.array.isRequired,avatarDimension:t.PropTypes.oneOf(a).isRequired,maxVisible:t.PropTypes.number.isRequired,undisplayableCount:t.PropTypes.number.isRequired,onOverflowCountClick:t.PropTypes.func,overflowCountRenderer:t.PropTypes.func,animation:t.PropTypes.bool,inheritedCountAvatar:t.PropTypes.node,className:t.PropTypes.string,reverseAvatars:t.PropTypes.bool},getDefaultProps:function(){return{className:"",inheritedCountAvatar:null}},_defaultRenderOverflowCount:function(e){return l(s,{count:e,dimension:this.props.avatarDimension,key:"overflow_pill:"+e,onClick:this.props.onOverflowCountClick})},render:function(){var t,n,s,r,o;return t=this.props.avatars,n=this.props.maxVisible,s=0,this.props.undisplayableCount&&(s+=this.props.undisplayableCount),(this.props.undisplayableCount||t.length>n)&&(n--,s+=t.length-n,t=t.slice(0,n)),s&&(o=null!=(r=this.props.overflowCountRenderer)?r:this._defaultRenderOverflowCount,t.push(o(s))),this.props.reverseAvatars&&t.reverse(),d.div({className:e({"c-facepile":!0})},[this.props.inheritedCountAvatar?d.div({className:"u-l-ib u-mar-right-xxs",key:"inherited_count"},this.props.inheritedCountAvatar):void 0,d.div({className:this.getClassName(),key:"facepile"},t)])},getClassName:function(){return e(["horizontal-avatar-list",this.props.className,this.props.animation?["animation","is-animated"]:null])}}),i=o(i,["/static/css/avatar_list-vfll-ERpM.css"])})}.call(this),function(){define("modules/clean/avatar/overflow_count_pill",["external/react","modules/clean/avatar/size","modules/clean/avatar/style","modules/clean/css","modules/core/i18n"],function(e,t,n,s,r){var o,i,a,l;return o=t.VALID_AVATAR_DIMENSIONS,a=n.getClassName,l=r.ungettext,i=e.DOM,e.createClass({displayName:"OverflowCountPill",propTypes:{dimension:e.PropTypes.oneOf(o).isRequired,count:e.PropTypes.number.isRequired,onClick:e.PropTypes.func},componentDidMount:function(){return s.require_css("/static/css/scooter/scooter-scoped-vfl8iXN08.css")},render:function(){var e,t;return t=" +"+this.props.count+" ",e=l("%(count)s more member","%(count)s more members",this.props.count).format({count:this.props.count}),null!=this.props.onClick?i.button({className:a(this.props.dimension,["overflow-pill c-avatar--meta u-unbutton"]),onClick:this.props.onClick},i.span({"aria-hidden":!0},t),i.span({className:"ax-visually-hidden"},e)):i.div({className:a(this.props.dimension,["overflow-pill c-avatar--meta"])},i.span({"aria-hidden":!0},t),i.span({className:"ax-visually-hidden"},e))}})})}.call(this),function(){define("modules/clean/avatar/shared_link_avatar",["external/react","modules/clean/avatar/size","modules/clean/avatar/style","modules/clean/css","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s,r,o){var i,a,l,d,c;return i=t.VALID_AVATAR_DIMENSIONS,d=n.getClassName,c=r.static_url,a=o._,l=e.DOM,e.createClass({displayName:"SharedLinkAvatar",propTypes:{alt:e.PropTypes.string,dimension:e.PropTypes.oneOf(i).isRequired,isMaestroDesign:e.PropTypes.bool,onClick:e.PropTypes.func,optionalClass:e.PropTypes.string},componentDidMount:function(){return s.require_css("/static/css/scooter/scooter-scoped-vfl8iXN08.css")},render:function(){var e,t,n;return n=l.img({src:c("/static/images/avatar/shared-link-icon-vflHCU_m6.svg"),alt:this.props.alt||a("Shared link"),width:12,className:this.props.isMaestroDesign?"u-mar-horizontal-xs":void 0}),e=["c-avatar--meta"],null!=this.props.optionalClass&&e.push(this.props.optionalClass),null!=this.props.onClick&&e.push("u-unbutton"),t=d(this.props.dimension,e),null!=this.props.onClick?l.button({className:t,onClick:this.props.onClick},n):l.div({className:t,onClick:this.props.onClick},n)}})})}.call(this),function(){define("modules/clean/avatar/triple_avatars",["external/react","modules/clean/ajax","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/overflow_count_pill","modules/clean/avatar/size","modules/clean/react/css","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,i,a,l){var d,c,p,u,m;return d=o.AVATAR_DIMENSION_BY_SIZE,u=e.createElement,m=e.DOM,p=e.createClass({displayName:"TripleAvatars",getPropTypes:function(){return{contacts:e.PropTypes.arrayOf(e.PropTypes.shape({email:e.PropTypes.string,display_name:e.PropTypes.string,photo_url:e.PropTypes.string})),count:e.PropTypes.integer}},getAvatar:function(e){return u(n,{dimension:d.XLARGE,photoUrl:e.photo_url,defaultAvatar:u(s,{dimension:d.XLARGE,shape:"CIRCLE",initials:l.getInitials(e.display_name),name:e.display_name})})},render:function(){var e;return this.props.contacts&&0!==this.props.contacts.length?(e=this.props.contacts.length,this.props.count&&this.props.count>this.props.contacts.length&&(e=this.props.count),m.div({className:"triple-avatars-section"},this.getAvatar(this.props.contacts[0]),this.props.contacts.length>1?this.getAvatar(this.props.contacts[1]):void 0,3===e?this.getAvatar(this.props.contacts[2]):e>3?u(r,{dimension:d.XLARGE,count:e-2}):void 0)):m.div({})}}),c=i(p,["/static/css/scooter/scooter-scoped-vfl8iXN08.css"]),{TripleAvatars:c}})}.call(this),function(){define("modules/clean/clipboard",["jquery","modules/clean/static_urls","modules/core/dom","external/swfobject"],function(e,t,n,s){var r,o,i,a,l;return l=t.static_url,o=function(){var e,t;return e=(new Date).getTime(),t=("00000"+Math.floor(1e6*Math.random())).slice(-6),"swf_"+e+"_"+t},i=function(e,t){return e.on("mouseover",function(){return t.addClass("hovered")}),e.on("mousedown",function(){return t.addClass("pressed")}),e.on("mouseout",function(){return t.removeClass("hovered pressed")}),e.on("mouseup",function(){return t.removeClass("pressed")})},a=function(e,t){return window.ClipboardSWFRegister=window.ClipboardSWFRegister||{},window.ClipboardSWFRegister[e]=function(){return t()},"ClipboardSWFRegister."+e},r=function(t,r,d,c){var p,u,m;return null==d&&(d=null),null==c&&(c=null),c=c||e(document.body),m=o(),p=e("<div />",{id:"flash_copy_container"}).append(e("<div />",{id:m})).css({position:"absolute",zIndex:1}),i(p,r),c.append(p),n.clone_position(p,r,{}),u=a(m,d),window.copyLoaded=(function(n){return function(){var n;return n=e("#"+m)[0],n.setCopyText(t),n.setCallbackFunction(u)}})(this),s.embedSWF(l("/static/swf/copy_clipboard-vflvMcZTC.swf"),m,"100%","100%","6.0.65",!1,!1,{wmode:"transparent",scale:"exactfit",allowScriptAccess:"always"}),p},{clipboard_overlay:r}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/clipboard_v2",["jquery","external/flash_detect","external/react","modules/core/browser","modules/core/exception","modules/clean/clipboard"],function(t,n,s,r,o,i){return o.assert,(function(){function s(t,n,s,r){this.copyText=t,this.onSuccess=n,this.onError=s,this.clickHandler=r,this.do_copy=e(this.do_copy,this)}return s.prototype.setupCopy=function(e,n){var r,o,a;if(r=t(n),o=t(e),!s.is_flashless_clipboard_supported())return a=(function(e){return function(){return"function"==typeof e.onSuccess&&e.onSuccess(),"function"==typeof e.clickHandler?e.clickHandler():void 0}})(this),i.clipboard_overlay(this.copyText,o,a,r)},s.prototype.do_copy=function(){var e;if(s.is_supported())return s.is_flashless_clipboard_supported()?(e=document.execCommand("copy",!1),e?"function"==typeof this.onSuccess?this.onSuccess():void 0:"function"==typeof this.onError?this.onError():void 0):void 0},s.is_supported=function(){return s.is_flashless_clipboard_supported()||n.installed},s.is_flashless_clipboard_supported=function(){var e;return e=parseInt(r.version),r.chrome?e>=42:r.mozilla?e>=41:r.opera?e>=29:r.msie?e>=9:!!r.edge||!!r.safari&&e>=10},s})()})}.call(this),function(){define("modules/clean/components/title_bubble",["jquery","external/classnames","external/react","external/react-dom","modules/clean/react/css"],function(e,t,n,s,r){var o,i;return i=n.DOM,o=n.createClass({displayName:"TitleBubble",propTypes:{text:n.PropTypes.string.isRequired,direction:n.PropTypes.oneOf(["north","south","east","west"]).isRequired,onMouseEnter:n.PropTypes.func,respectLineBreaks:n.PropTypes.bool,className:n.PropTypes.string},getInitialState:function(){return{isChildFocused:!1}},componentDidMount:function(){return e(s.findDOMNode(this)).on("focusin.title-bubble",(function(e){return function(t){return e.setState({isChildFocused:!0})}})(this)).on("focusout.title-bubble",(function(e){return function(t){return e.setState({isChildFocused:!1})}})(this)).on("mouseenter.title-bubble",(function(e){return function(){var t;return"function"==typeof(t=e.props).onMouseEnter?t.onMouseEnter():void 0}})(this))},componentWillUnmount:function(){return e(s.findDOMNode(this)).off("focusin.title-bubble").off("focusout.title-bubble").off("mouseenter.title-bubble")},render:function(){var e;return e={"c-title-bubble":!0,"is-child-focused":this.state.isChildFocused,"c-title-bubble--respect-line-break":this.props.respectLineBreaks},e["c-title-bubble--"+this.props.direction.slice(0,1)]=!0,i.div({className:t([e,this.props.className]),"data-title":this.props.text,onClick:(function(e){return function(t){if(t.detail>0)return e.setState({isChildFocused:!1})}})(this)},this.props.children)}}),o=r(o,["/static/css/scooter/scooter-scoped-vfl8iXN08.css"])})}.call(this),function(){define("modules/clean/file_events",[],function(){return{DELETE:"db:bulk_delete",COPY:"db:bulk_copy",MOVE:"db:bulk_move",RENAME:"db:bulk_rename",PURGE:"db:bulk_purge",RESTORE:"db:bulk_restore",UPLOAD:"db:upload",COMPRESS:"db:compress",SF_NEW:"db:sf_new",SF_LEAVE:"db:sf_leave",SF_UNSHARE:"db:sf_unshare",SF_ADD_TO_DROPBOX:"db:sf_add_to_dropbox",SF_INVITE:"db:sf_invite",SF_IGNORE:"db:sf_ignore",LINKS_REMOVE:"db:link_remove",LINKS_ADD:"db:link_add",FILE_ACTIVITY_UPDATE:"db:file_activity_update"}})}.call(this),function(){var e={}.hasOwnProperty;define("modules/clean/flux/store_listener",["external/react"],function(t){var n;return n=function(n,s,r){var o;return t.createClass({displayName:"StoreListener("+(null!=(o=n.displayName)?o:"Unknown")+")",getInitialState:function(){return{childProps:r(this.props,s)}},componentDidMount:function(){var t,n;for(n in s)e.call(s,n)&&(t=s[n],t.add_change_listener(this._handleStoreChanged));return this.setState({childProps:r(this.props,s)})},componentWillUnmount:function(){var t,n,r;t=[];for(r in s)e.call(s,r)&&(n=s[r],t.push(n.remove_change_listener(this._handleStoreChanged)));return t},render:function(){var s,r,o,i;s={ref:"wrapped"},o=this.state.childProps;for(r in o)e.call(o,r)&&(i=o[r],s[r]=i);return t.createElement(n,s,this.props.children)},getWrappedComponent:function(){return this.refs.wrapped},getStores:function(){return s},_handleStoreChanged:function(){var e;if(this.isMounted()&&(e=r(this.props,s),null!=e))return this.setState({childProps:e})}})},{listenToStores:n}})}.call(this),function(){var e=function(e,n){function s(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return s.prototype=n.prototype,e.prototype=new s,e.__super__=n.prototype,e},t={}.hasOwnProperty,n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/browse/shared_with",["jquery","external/react","external/react-dom","external/underscore","modules/core/i18n","modules/core/user_i18n","modules/clean/ajax","modules/clean/avatar/size","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/flux/dispatcher","modules/clean/flux/store_mixin","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/sharing/shared_with_view","modules/clean/sharing/api","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal_util","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/ui_util","modules/clean/file_events","modules/clean/web_timing_logger","modules/core/browser","modules/core/dom"],function(t,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I,E,C,N,M,T,A){var P,k,x,F,L,R,D,O,U,B,q,H,V,G,W,K,Y,z,j,Q,Z,X,J;return i._,P=d.AVATAR_DIMENSION_BY_SIZE,k=h.BrowseActionTypes,D=h.LoadingStates,B=h.SharedWithActionTypes,x=_.BrowseContext,F=_.File,j=f.browseStore,W=g.SharedWithView,Y=y.SharingApi,L=v.FileShareApiClient,z=b.TRUELINK,X=S.shouldUsePublicFolderSharing,J=w.showShareModal,Z=I.sharingInfoStore,K=E.SharingActions,Q=s.createElement,O=5,R=100,U=100,"file_row_sharing_menu",G=(function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initializeWith=function(e){var t,n;return n=e.path,t=e.files,this._browseInitializeEverything({path:n,files:t})},n.prototype._init=function(){return this._sharedFolderDataByTargetNs={},this._sharedLinkDataMapsByFolderFQPath={},this._filesWeHaveSharedLinkDataFor={},this._sharedFileDataByFileId={},this._hasSharedDataLoadedByContainingPath={}},n.prototype.hasLinkDataForFile=function(e){return e.fq_path in this._filesWeHaveSharedLinkDataFor},n.prototype.clearSharedLinkDataCache=function(){return this._filesWeHaveSharedLinkDataFor={}},n.prototype.getDataForFile=function(e){var t,n,s,r,i,a,l,d,c,p,u,m;return e&&!e.target_ns&&this._canBeSharedFile(e)?(t=this._sharedFileDataByFileId[null!=(i=e.file_id)?i:e.fq_path]||{},s=this._sharedFolderDataByTargetNs[j.context().currentNSID]||{},r={},(null!=(a=t.joinedMembers)?a.length:void 0)||(null!=(l=t.groups)?l.length:void 0)||(null!=(d=t.invitations)?d.length:void 0)||(r.audienceDescription=s.audienceDescription),r.groups=o.uniq(o.union(t.groups,s.groups),!1,function(e){return e.gid}),r.invitations=o.uniq(o.union(t.invitations,s.invitations),!1,function(e){return e.invitation_id}),r.joinedMembers=o.uniq(o.union(t.joinedMembers,s.joinedMembers),!1,function(e){return e.user_id}),r.numUndisplayableUsersAndInvites=(t.numUndisplayableUsersAndInvites||0)+(s.numUndisplayableUsersAndInvites||0),n=s.memberCount||0,n+=((null!=(c=t.joinedMembers)?c.length:void 0)||0)+((null!=(p=t.invitations)?p.length:void 0)||0)+(t.numUndisplayableUsersAndInvites||0),n+=(null!=(u=t.groups)?u.map(function(e){return e.num_users||1}).reduce(function(e,t){return e+t},0):void 0)||0,r.memberCount=n):r=e&&e.target_ns?this._sharedFolderDataByTargetNs[e.target_ns]:this._sharedFolderDataByTargetNs[j.context().currentNSID],m=this._getSharedLinkInfoByFile(e),m?(r||(r={}),r.sharedLinkInfo=m):null!=r&&delete r.sharedLinkInfo,r||(r={}),r.hasSharedDataLoaded=this._getHasSharedDataLoaded(),r},n.prototype._getSharedLinkInfoByFile=function(e){var t,n,s;return t=j.path(),s=this._sharedLinkDataMapsByFolderFQPath[t],s&&e&&(n=s[this._sharedLinkKey(e)]),n},n.prototype._sharedLinkKey=function(e){return e.fq_path+"_"+e.ns_id+"_"+e.sjid},n.prototype._new_payload=function(e){switch(e.action.type){case k.LOAD_PATH:return this._pathLoaded(e.action.data);case k.ADD_FILES:return this._filesAdded(e.action.data);case k.INITIALIZE_EVERYTHING:return this._browseInitializeEverything(e.action.data);case k.CHANGE_FILES:return this._filesChanged(e.action.data);case B.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE:return this._signalSharedFileDataOutOfDate(e.action.data);case B.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE:return this._signalSharedFolderDataOutOfDate(e.action.data);case B.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE:return this._signalSharedLinkDataOutOfDate(e.action.data);case B.SET_SHARED_FOLDER_DATA:return this._setNSSharedWithData(e.action.data);case B.SET_SHARED_LINK_DATA:return this._setSharedLinkData(e.action.data);case B.SET_SHARED_FILE_DATA:return this._setSharedFileData(e.action.data);case B.CLEAR_SHARED_FOLDER_DATA_FOR_NS:return this._clearSharedFolderDataForNs(e.action.data);case B.REMOVE_SHARED_LINK_DATA:return this._removeSharedLinkData(e.action.data)}},n.prototype._fillInMissingSharedLinkData=function(e){var t,n,s,r,o,i,a;for(a=e.parentPath,s=e.files,r=[],o=0,i=s.length;o<i;o++)n=s[o],this.hasLinkDataForFile(n)||(this._filesWeHaveSharedLinkDataFor[n.fq_path]=!0,r.push(n));return q.loadLinkDataForFiles({parentPath:a,fileFqPaths:(function(){var e,n,s;for(s=[],e=0,n=r.length;e<n;e++)t=r[e],s.push(t.fq_path);return s})()}),q.loadLinkMetadata(r)},n.prototype._getHasSharedDataLoaded=function(){var e;return e=j.path(),e in this._hasSharedDataLoadedByContainingPath&&this._hasSharedDataLoadedByContainingPath[e]},n.prototype._setHasSharedDataLoaded=function(e){var t;return t=j.path(),this._hasSharedDataLoadedByContainingPath[t]=e},n.prototype._canBeSharedFile=function(e){return!(e.is_dir||e.isDeleted)},n.prototype._loadSharedFileData=function(e){var t,n,s,r,o,i;for(s=(null!=e?e:{invalidateCache:!1}).invalidateCache,s&&(this._sharedFileDataByFileId={}),n=[],i=j.files().toArray(),r=0,o=i.length;r<o;r++)t=i[r],!this._canBeSharedFile(t)||t.file_id in this._sharedFileDataByFileId||n.push(t.file_id);return q.loadSharedFileDataForFiles({fileIds:n})},n.prototype._pathLoaded=function(e){var t,n;return t=e.files,n=e.path,this._setHasSharedDataLoaded(!1),q.loadSFDataForPath({parentPath:n,abortCurrentRequest:!0}),this._loadSharedFileData({invalidateCache:!0}),this._filesAdded({files:t,path:n})},n.prototype._filesAdded=function(e){var t,n;return t=e.files,n=e.path,this._fillInMissingSharedLinkData({parentPath:n,files:t}),this._loadSharedFileData()},n.prototype._filesChanged=function(e){var t,n,s;if(s=e.path,n=e.fileDeltas,s===j.path()&&null!=n&&n.length)return u.waitFor([j.dispatchToken]),q.loadSFDataForPath({parentPath:s}),this.clearSharedLinkDataCache(),t=j.files().toArray(),this._fillInMissingSharedLinkData({parentPath:s,files:t}),this._loadSharedFileData({invalidateCache:!0})},n.prototype._signalSharedFileDataOutOfDate=function(e){var t;return t=e.fileIds,q.loadSharedFileDataForFiles({fileIds:t})},n.prototype._signalSharedFolderDataOutOfDate=function(e){var t;return t=e.parentPath,null==t&&(t=j.path()),q.loadSFDataForPath({parentPath:t})},n.prototype._signalSharedLinkDataOutOfDate=function(e){var t,n;return n=e.parentPath,t=e.fileFqPaths,null==n&&(n=j.path()),q.loadLinkDataForFiles({parentPath:n,fileFqPaths:t})},n.prototype._setNSSharedWithData=function(e){var t,n;return n=e.sharedFolderData,t=e.containingPath,this._sharedFolderDataByTargetNs=n,this._hasSharedDataLoadedByContainingPath[t]=!0,this.emit_change()},n.prototype._setSharedLinkData=function(e){var t,n,s,r,o,i,a,l;for(r=e.parentPath,i=e.sharedLinkData,l=this._sharedLinkDataMapsByFolderFQPath[r]||{},n=0,s=i.length;n<s;n++)o=i[n],t=o.file,a=o.sharedLinkToken,l[this._sharedLinkKey(t)]=a;return this._sharedLinkDataMapsByFolderFQPath[r]=l,this.emit_change()},n.prototype._setSharedFileData=function(e){var t;return t=e.sharedFileData,o.extend(this._sharedFileDataByFileId,t),this.emit_change()},n.prototype._clearSharedFolderDataForNs=function(e){var t;return t=e.targetNs,this._sharedFolderDataByTargetNs[t]=void 0,this.emit_change()},n.prototype._browseInitializeEverything=function(e){var t,n;return n=e.path,t=e.files,q.loadSFDataForPath({parentPath:n}),this._filesAdded({path:n,files:t})},n.prototype._removeSharedLinkData=function(e){var t,n,s,r,o,i;for(o=e.parentPath,n=e.files,i=this._sharedLinkDataMapsByFolderFQPath[o]||{},s=0,r=n.length;s<r;s++)t=n[s],i[this._sharedLinkKey(t)]=void 0;return this._sharedLinkDataMapsByFolderFQPath[o]=i,this.emit_change()},n})(p),V=new G,t(document).on(Y.REQUEST_SUCCEEDED_EVENT,function(e,t){var n;return n=t.request_url,n.indexOf("/share_ajax/leave")>-1?u.dispatch({type:B.CLEAR_SHARED_FOLDER_DATA_FOR_NS,data:{targetNs:t.ns_id}}):u.dispatch({type:B.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{parentPath:j.path()}})}),q=(function(){function e(){}return e.loadLinkMetadata=function(e){var t,n,s,r,o,i;if(i=j.user(),z.TRUELINK_BROWSE_LINK_ICON[i.id]&&z.TRUELINK_UI[i.id])return t=5,s=e.filter(function(e){return e.is_dir}).map(function(e){return"ns:"+e.ns_id+e.ns_path}),o=function(){var e;if(0!==s.length)return e=s.slice(0,t),s=s.slice(t),K.loadFolderLinkMetadataBatch(i,e).then(o)},n=e.filter(function(e){return!e.is_dir}).map(function(e){return e.file_id||e.fq_path}),r=function(){var e;if(0!==n.length)return e=n.slice(0,t),n=n.slice(t),K.loadFileMetadataBatch(i,e).then(r)},o(),r()},e.loadSFDataForPath=function(e){var t,n,s,r,o,i;return s=e.parentPath,t=null!=(r=e.abortCurrentRequest)&&r,i=j.user(),n=j.context().isNonUserRelativeContext,t&&null!=(o=this._currentSFDataRequest)&&o.abort(),this._currentSFDataRequest=l.WebRequest({url:"/share_ajax/shared_with",dataType:"json",subject_user:i,data:{max_results:O,fq_path_prefix:s,include_inherited:!0,admin_console:n?"true":void 0,sort_by_name:!0},success:function(e){var t,n,r,o,i;for(i={},t=0,n=e.length;t<n;t++)o=e[t],r={numUndisplayableUsersAndInvites:o.num_avatars_not_shown,groups:o.groups,invitations:o.invitations,joinedMembers:o.joined_members,audienceDescription:o.audience_description,memberCount:o.num_users_and_invites},i[o.ns_id]=r;return u.dispatch({type:B.SET_SHARED_FOLDER_DATA,data:{sharedFolderData:i,containingPath:s}})},complete:(function(e){return function(){return e._currentSFDataRequest=null}})(this)})},e.loadSharedFileDataForFiles=function(e){var t,n,s,r;if(n=e.fileIds,r=j.user(),null!==r&&(null!=r?r.is_email_verified:void 0))return t=new L({userId:r.id}),(s=function(e){var n,r,o;if(0!==e.length)return o=e.slice(0,U),n=e.slice(U),r=t.listMembersBatch({contentIds:o,limit:O}),r.then(function(e){var t;if(t={},e.forEach(function(e,n){return t[n]={numUndisplayableUsersAndInvites:0,groups:e.groups.valueSeq().map(C.apiGroupMemberToAvatarInfo).toArray(),invitations:e.invitees.valueSeq().map(C.apiInviteeMemberToAvatarInfo).toArray(),joinedMembers:e.users.valueSeq().map(C.apiUserMemberToAvatarInfo).toArray()}}),u.dispatch({type:B.SET_SHARED_FILE_DATA,data:{sharedFileData:t}}),n)return s(n)})})(n)},e.loadLinkDataForFiles=function(e){var t,s,r,o;if(s=e.parentPath,t=e.fileFqPaths,!z.TRUELINK_UI[j.user().id])return o=j.user(),(r=function(e){var t,i;if(0!==e.length)return i=e.slice(0,R),t=e.slice(R),l.SilentBackgroundRequest({url:"/sm/get_token_info",dataType:"json",data:{paths:JSON.stringify(i)},subject_user:o,success:function(e){var o,a,l,d,c,p,m,h,_,f,g;for(l=j.filesMap(),_=[],m=e.shmodels,d=0,c=m.length;d<c;d++)g=m[d],g.disabled||(o=l.get(g.path),o&&_.push({file:o,sharedLinkToken:g}));if(_.length&&u.dispatch({type:B.SET_SHARED_LINK_DATA,data:{parentPath:s,sharedLinkData:_}}),f=(function(){var t,n,s,r;for(s=e.shmodels,r=[],t=0,n=s.length;t<n;t++)h=s[t],r.push(h.path);return r})(),a=(function(){var e,t,s;for(s=[],e=0,t=i.length;e<t;e++)p=i[e],n.call(f,p)>=0||s.push(l.get(p));return s})().filter(function(e){return null!=e}),a.length&&u.dispatch({type:B.REMOVE_SHARED_LINK_DATA,data:{parentPath:s,files:a}}),t)return r(t)}})})(t)},e})(),H=s.createClass({displayName:"SharedWithController",mixins:[m(V,Z,j)],propTypes:{browseContext:s.PropTypes.instanceOf(x).isRequired,file:s.PropTypes.instanceOf(F),isInAudienceBox:s.PropTypes.bool,isMaestroDesign:s.PropTypes.bool,inSelectMode:s.PropTypes.bool,tabIndex:s.PropTypes.oneOf([0,-1]),actionHandlers:s.PropTypes.object},getDefaultProps:function(){return{isMaestroDesign:!0}},_get_state_from_stores:function(e){var t,n,s,r,o,i,a,l,d,c,p;return p=j.user().id,t=V.getDataForFile(e.file),c=Z.getSharingInfo(p,null!=(s=e.file)?s.fq_path:void 0),n=j.loadingState()===D.LOADING_FIRST_PAGE,{audienceDescription:null!=t?t.audienceDescription:void 0,numUndisplayableUsersAndInvites:null!=(r=null!=t?t.numUndisplayableUsersAndInvites:void 0)?r:0,groups:null!=(o=null!=t?t.groups:void 0)?o:[],hasSharedDataLoaded:(null!=t?t.hasSharedDataLoaded:void 0)&&!n,invitations:null!=(i=null!=t?t.invitations:void 0)?i:[],joinedMembers:null!=(a=null!=t?t.joinedMembers:void 0)?a:[],memberCount:null!=(l=null!=t?t.memberCount:void 0)?l:0,sharedLinkInfo:null!=(d=null!=t?t.sharedLinkInfo:void 0)?d:null,linkMetadata:null!=c?c.linkMetadata():void 0}},componentDidUpdate:function(){var e,t,n,s,o;if(null!=this.props.tabIndex){for(t=A.getFocusableElementsIn(r.findDOMNode(this),!1),o=[],n=0,s=t.length;n<s;n++)e=t[n],o.push(e.tabIndex=this.props.tabIndex);return o}},componentWillReceiveProps:function(e){return this.setState(this._get_state_from_stores(e))},_handleMembershipClick:function(){var e,t,n,s,r;if(null==this.props.file&&j.context().isCurrentlyInRoot)return void T.open_tab("/team#members");if((null==this.props.file||!F.isTeamMemberFolder(this.props.file))&&(null==this.props.file||F.canViewFileMembers(this.props.file,j.context())))return t=[j.user(),this.props.file?this.props.file:j.context()],r=t[0],e=t[1],this.props.browseContext.isNonUserRelativeContext&&null!=(null!=(n=this.props.actionHandlers)?n.onManage:void 0)?null!=(s=this.props.actionHandlers)?s.onManage(this.props.file):void 0:J(r,e,{browseContext:this.props.browseContext,origin:"BROWSE_FILE_ROW"})},handleOverflowCountClick:function(){return this._handleMembershipClick()},handleAvatarClick:function(){return this._handleMembershipClick()},handleSharedLinkClick:function(){return J(j.user(),this.props.file,{browseContext:this.props.browseContext,origin:"BROWSE_FILE_ROW"})},render:function(){var e,t,n,s,r;return t=j.context(),r=j.user(),t.isCurrentlyInRoot&&null==this.props.file&&!r.is_cdm_member?null:(e=this.props.file?F.canViewFileMembers(this.props.file,t):t.canViewContainingNSMembers,Q(W,{user:j.user(),file:this.props.file,onOverflowCountClick:this.handleOverflowCountClick,onAvatarClick:this.handleAvatarClick,groups:this.state.groups,invitations:this.state.invitations,joinedMembers:this.state.joinedMembers,numUndisplayableUsersAndInvites:this.state.numUndisplayableUsersAndInvites,memberCount:this.state.memberCount,parentFolderName:t.getNameOfTargetFolder(),animation:!1,avatarDimension:P.MEDIUM,maxVisibleAvatars:O,sharedLinkInfo:this.state.sharedLinkInfo,onSharedLinkClick:this.handleSharedLinkClick,publicFolderSharing:this.props.file&&X(null!=(n=null!=(s=this.props.browseContext)?s.config:void 0)?n:{},this.props.file.fq_path),isMaestroDesign:this.props.isMaestroDesign,inSelectMode:this.props.inSelectMode,isInAudienceBox:this.props.isInAudienceBox,audienceDescription:this.state.audienceDescription,hasSharedDataLoaded:this.state.hasSharedDataLoaded,canViewMembers:e&&!t.isInsideDeletedFolder,inContentManagerCdmRoot:!1,linkMetadata:this.state.linkMetadata}))}}),{SharedWithActions:q,SharedWithController:H,SharedWithStore:V}})}.call(this),function(){define("modules/clean/react/bubble",["external/react","external/underscore","modules/clean/css"],function(e,t,n){var s,r;return r=e.DOM,s={TOP:"top",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",RIGHT:"right",RIGHT_TOP:"right-top",RIGHT_BOTTOM:"right-bottom",LEFT:"left",LEFT_TOP:"left-top",LEFT_BOTTOM:"left-bottom"},e.createClass({displayName:"Bubble",statics:{ARROW:s},propTypes:{arrow:e.PropTypes.oneOf(t.values(s)),className:e.PropTypes.string},getDefaultProps:function(){return{arrow:null,className:""}},componentWillMount:function(){if("undefined"!=typeof window&&null!==window)return n.require_css("/static/css/react/bubble_box-vflpfsqHZ.css")},render:function(){var e,n;return e=["react-bubble-box","react-bubble-box--arrow-"+this.props.arrow,this.props.className],n=t.extend({},t.omit(this.props,["arrow","className"]),{className:e.join(" ")}),r.div(n,this._renderArrow(),this.props.children)},_renderArrow:function(){return null!=this.props.arrow?[r.div({className:"react-bubble-box__arrow-border",key:"arrow-border"}),r.div({className:"react-bubble-box__arrow",key:"arrow"})]:[]}})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/content_manager/api",["external/react","jquery","external/underscore","modules/clean/analytics","modules/clean/ajax","modules/clean/react_format","modules/clean/filepath","modules/clean/filetypes","modules/clean/history","modules/clean/pagination_manager","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/sort_helpers","modules/clean/react/browse/store","modules/clean/sharing/api/util/types","modules/clean/sharing/ui_util","modules/clean/teams/admin/api/admin_console_api_client","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/constants/browse","modules/constants/viewer","require"],function(t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I,E,C){var N,M,T,A,P,k,x,F,L,R,D,O,U,B,q,H,V,G,W,K,Y,z,j,Q,Z,X,J,$,ee,te,ne,se,re,oe,ie,ae,le;return T=r.ContentManagerActionsLogger,$=i.reactFormat,A=l.FileTypes,c.PaginationManager,p.LoadingStates,u.Config,u.BrowseContext,G=m.compare,V=h.browseStore,z=_.folderMetadataApiToRecord,P=f.GoldenGate,M=g.AdminConsoleApiClient,D=b._,oe=b.ungettext,O=function(e){return{fq_path:"/"+e.name,href:"/work/"+e.name,is_dir:!0,bytes:0,target_ns:e.team_folder_id,icon:q[e.status[".tag"]],team_folder_status:e.status[".tag"],type:A.TEAM_SHARED_FOLDER}},N="undefined"!=typeof window&&null!==window?n(window):null,R=180,F=new RegExp('([\\u0000-\\u001F]|\\\\|\\/|:|\\?|\\*|<|>|\\"|\\|)'),k=new RegExp('([\\u0000-\\u001F]|\\\\|\\/|:|\\?|\\*|\\"|\\|)'),L=new RegExp("[\\ufffe-\\uffff\\ud800-\\udfff]"),x=[".",".."],ae=function(t,n){return null==n&&(n=!1),
""===t?"":t.length>255?D("The folder name should be under 255 characters"):n&&t.startsWith(".")?D("The folder name can’t start with a dot (.)"):t.endsWith(".")?D("The folder name can’t end with a dot (.)"):e.call(x,t)>=0?D("The names dot (.) and dot dot (..) are’t allowed"):F.test(t)?D("The following characters aren’t allowed: \\ / : ? * < > ” |"):L.test(t)?D("The folder name contains invalid characters"):null},ie=function(e){return""===e?"":e.length>255?D("The file name should be under 255 characters"):k.test(e)?D("The following characters aren’t allowed: \\ / : ? * ” |"):L.test(e)?D("The file name contains invalid characters"):null},U=function(e,t){var n,s,r,o;for(o=[],n=0,r=e.length;n<r;n++)s=e[n],o.push(s.fq_path="/"+t+s.fq_path);return o},B=function(){var e;return e=P.hasContentManagerCdm(V.user().id),new M(isCMforCDM=e,flashError=!1)},Z=function(e){var t,n,r,i,a,l,d,c,p,u,m,h,_;return d=e.path,_=e.userId,m=e.sortFoldersFirst,r=e.includeDeletedFiles,i=e.nsId,l=e.onSuccess,a=e.onError,t=P.hasContentManagerCdm(_),n=B(),"/"!==d||t?(c=d.split("/"),p=c[1],u=t?1:2,h="/"+c.slice(u).join("/"),o.WebRequest({data:{show_deleted:r||"",admin_console:!0,ns_id:i,sort_folders_first:m},url:w({path:"/browse"+h}),subject_user:_,success:function(e){try{s.isString(e)&&(e=JSON.parse(e)),t||(e.paginated?U(e.first_page.items,p):U(e.file_info,p)),N.scrollTop(0),l({path:d,data:e})}catch(e){}},error:function(e,t,n){return"function"==typeof a?a(e,t,n):void 0}})):n.teamFoldersList().then(function(e){var t,n,s;return e.team_folders=e.team_folders.sort(function(e,t){return G(e.name.toUpperCase(),t.name.toUpperCase(),1)}),n=(function(){var t,n,r,o;for(r=e.team_folders,o=[],t=0,n=r.length;t<n;t++)s=r[t],o.push(O(s));return o})(),t={file_info:n,paginated:!1,inside_team_folder_root:!0,is_non_user_relative_context:!0},l({path:d,data:t})}).catch(function(e){if(!e.headers)throw e;return"function"==typeof a?a(e.headers,e.raw.status,e.raw.responseBody):void 0})},W=function(e,n){var s,r,o,i,a,l,d,c,p,u;return l=e.files,d=e.newPath,u=e.userId,c=e.onSuccess,null==n&&(n=!0),r=C("modules/clean/react/browse/actions").browseActions,s=C("modules/clean/react/modal").Modal,i=B(),a=V.context(),p=a.rootNSID,S.info(D("Copying files...",R)),o=n?{".tag":"check"}:null,i.bulkFileCopy(p,l,d,o).then(function(e){var t;return S.success(D("Copy completed.")),r.setPath({path:V.path(),nsId:a.rootNSID}),t=1===l.length?"copy":"copyBatch",H(t)}).catch(function(e){var n,r,o,i,a;return"cant_copy_shared_folder"===(null!=(r=e.error)?r[".tag"]:void 0)?S.error(D("Copying a shared folder isn’t supported for beta.")):"to"===(null!=(o=e.error)?o[".tag"]:void 0)&&"file_system_warnings"===(null!=(i=e.error)?i.to[".tag"]:void 0)?(S.clear(),n=null!=(a=e.error)?a.to.details[0]:void 0,n.blocking?S.error(D(n.text)):s.showInstance(t.createElement(s,{title:D(n.title),submitting:!1,acceptButtonText:D("Copy"),dismissButtonText:D("Cancel"),onAccept:function(){return W({files:l,newPath:d,userId:u,onSuccess:c},!1)},onDismiss:null},$(D(n.text+". <learnMoreLink>Learn more</learnMoreLink>"),{learnMoreLink:t.DOM.a({target:"_blank",href:n.learn_more})})))):S.error(D("There was a problem completing this request."))})},Y=function(e){var t,n,s,r;return r=e.files,s=e.context,t=C("modules/clean/react/browse/actions").browseActions,n=B(),S.info(D("Deleting files...",R)),n.bulkFileDelete(r).then(function(e){var n;return n=oe("Deleted %d item.","Deleted %d items.",r.length).format(r.length),S.success(n),t.setPath({path:V.path(),nsId:s.rootNSID}),H(1===r.length?r[0].is_dir?"deleteFolder":"deleteFile":"deleteBatch")}).catch(function(e){return S.error(D("There was a problem completing this request."))})},ee=function(e){var t,n,s,r,o,i,a;return o=e.file,e.userId,e.onSuccess,a=e.onError,i=e.newName,t=C("modules/clean/react/browse/actions").browseActions,s=V.context(),(r=o.is_dir?ae(i):ie(i))?(S.error(r),void a()):(n=B(),n.fileRename(o.ns_id,o.ns_path,i).then(function(e){return o.is_dir?S.success(D("Folder renamed.")):S.success(D("File renamed.")),t.setPath({path:V.path(),nsId:s.rootNSID}),t.setFileRenameComplete({file:o}),H("rename")}).catch(function(e){return S.error(D("There was a problem completing this request."))}))},X=function(e){var t,n,s,r,o,i;return e.path,r=e.files,o=e.newPath,e.userId,e.onSuccess,t=C("modules/clean/react/browse/actions").browseActions,n=B(),s=V.context(),i=s.rootNSID,S.info(D("Moving files...",R)),n.bulkFileMove(i,r,o).then(function(e){var n;return S.success(D("Move completed.")),t.setPath({path:V.path(),nsId:s.rootNSID}),n=1===r.length?"move":"moveBatch",H(n)}).catch(function(e){var t;return"cant_move_folder_into_itself"===(null!=(t=e.error)?t[".tag"]:void 0)?S.error(D("Moving a folder into itself isn’t allowed.")):S.error(D("There was a problem completing this request."))})},j=function(e){throw e.path,e.userId,e.namespaceToJournalIdMap,e.includeDeletedFiles,e.onSuccess,new Error("Not Implemented")},K=function(e){var t,n,s,r,o,i,a,l;return l=e.pathName,r=e.folderName,o=e.nsId,e.userId,a=e.onSuccess,i=e.onError,t=C("modules/clean/react/browse/actions").browseActions,(s=ae(r))?(S.error(s),void i()):(n=B(),n.folderCreate(o,l,r).then(function(e){var n;return S.success(D("Folder created.")),n={fq_path:"/"+r},a({changesets:null,createdFolder:n}),t.setPath({path:V.path(),nsId:o}),H("createFolder")}).catch(function(e){var t,n,s,r;return i(),"path"===(null!=(t=e.error)?t[".tag"]:void 0)&&"disallowed_name"===(null!=(n=e.error.path)?n[".tag"]:void 0)?S.error(D("The folder name is invalid.")):"path"===(null!=(s=e.error)?s[".tag"]:void 0)&&"conflict"===(null!=(r=e.error.path)?r[".tag"]:void 0)?S.error(D("A folder with the same name exists.")):S.error(D("Failed to create the folder."))}))},re=function(e){var t,n,s,r,o;return n=e.nsId,s=e.nsPath,o=e.policyUpdate,r=e.onSuccess,e.onError,t=new B,t.shareFolder(n,s,o).then(z).then(r)},le=function(e){var t,n,s,r,o;return r=e.nsId,o=e.nsPath,t=e.actions,s=e.listMembersArg,H("validateFolderPath"),n=B(),n.validateFolderPath(r,o,t,s)},te=function(e,t,n,s){var r;return r=B(),r.restoreFile(e,t,n).then(s)},ne=function(e,t){var n;return n=B(),n.restorePaths(e).then(t).catch(function(e){return S.error(D("There was a problem completing this request."))})},J=function(e,t,n){var s;return s=B(),s.permanentDeleteFile(e,t).then(n)},H=function(e){return T.log(V.context().rootNSID,e)},q={},se=function(e){return q=e},Q=function(e){return"/"===e.path&&!P.hasContentManagerCdm(e.user.id)},{validateFolderName:ae,loadPath:Z,renameFile:ee,copyFiles:W,deleteFiles:Y,moveFiles:X,getChangesForDirectory:j,setIcons:se,createNewFolder:K,shareFolder:re,validateFolderPath:le,restoreFile:te,restorePaths:ne,permanentDeleteFile:J,isInCMGoldenGateRoot:Q}})}.call(this),define("modules/clean/react/file_modal_controller",["require","exports","external/react","modules/clean/filepath","modules/clean/react/overquota_modal","modules/clean/react/file_modals","modules/clean/react/modal","modules/clean/sharing/browse_exports"],function(e,t,n,s,r,o,i,a){"use strict";function l(e,t,s){var r=n.createElement(o.FileTransferModal,{files:t,operation:o.Operations.COPY,user:e,onSuccess:s.onSuccess,onUndo:s.onUndo,onRequestNotSent:s.onRequestNotSent});i.Modal.showInstance(r)}function d(e,t,s,r){var a=n.createElement(o.FileTransferModal,{files:t,path:s,operation:o.Operations.MOVE,user:e,onSuccess:r.onSuccess,onUndo:r.onUndo,onRequestNotSent:r.onRequestNotSent});i.Modal.showInstance(a)}function c(){var e=n.createElement(r.OverquotaModal,null);i.Modal.showInstance(e)}function p(e,t,s){var r=n.createElement(o.RestoreFilesModal,{files:t,userId:e.id,onSuccess:s});i.Modal.showInstance(r)}function u(e,t,s){var r=n.createElement(o.PermanentlyDeleteModal,{files:t,userId:e.id,onSuccess:s});i.Modal.showInstance(r)}function m(e,t,r,a,l,d){void 0===l&&(l=!1),void 0===d&&(d=null);var c,p=s.filename(r.currentFQPath),u=r.isInsideSharedFolder;c=l?n.createElement(o.ExpOQDeleteFileModal,{files:t,user:e,parentSharedFolderName:u?p:null,onUndo:a,expSubgrowthBizWebClientOQDelete:l}):n.createElement(o.DeleteFileModal,{files:t,user:e,parentSharedFolderName:u?p:null,onUndo:a,onSuccess:d}),i.Modal.showInstance(c)}function h(e,t,s){var r=n.createElement(o.ContentManagerBridgeModal,{files:e,type:t,isLimitedTeam:s});i.Modal.showInstance(r)}function _(e,t,r){var l=n.createElement(o.NoAccessFolderModal,{folderName:s.filename(t.fq_path),folderPath:t.fq_path,userIsSameTeam:!!(e&&e.team_dbtid&&r.teamFolderOwnerTeamApiId&&e.team_dbtid===r.teamFolderOwnerTeamApiId),userIsSuperAdmin:!!e&&a.GoldenGate.hasContentManagerAndSuperAdmin(e.id)});i.Modal.showInstance(l)}function f(e){var t=n.createElement(o.ConfirmOwnershipTransferModal,{onAccept:e});i.Modal.showInstance(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.showCopy=l,t.showMove=d,t.showOverquota=c,t.showRestore=p,t.showPermanentlyDelete=u,t.showDelete=m,t.showContentManagerBridge=h,t.showNoAccess=_,t.showConfirmOwnershipTransferModal=f}),define("modules/clean/react/file_modals",["require","exports","tslib","external/react","external/react-dom","external/underscore","modules/clean/browse_interface","modules/clean/em_string","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/api","modules/clean/react/browse/render_partials","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/tree_view","modules/clean/react_format","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I){"use strict";function E(){return m.browseStore.context().isNonUserRelativeContext?h:p}function C(e,t){if(m.browseStore.context().isNonUserRelativeContext&&!v.GoldenGate.hasContentManagerCdm(t.id))return e[0].fq_path.split("/")[1]}Object.defineProperty(t,"__esModule",{value:!0});var N;(function(e){e[e.COPY=0]="COPY",e[e.MOVE=1]="MOVE"})(N=t.Operations||(t.Operations={}));var M=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePurged=function(){l.notifyPurgeSuccess(t.props.files.length),t.props.onSuccess()},t.handleAccept=function(){if(m.browseStore.context().isNonUserRelativeContext){var e=t.props.files[0];h.permanentDeleteFile(e.ns_id,e.ns_path,t.handlePurged)}else p.purgeFiles({files:t.props.files,userId:t.props.userId,onSuccess:t.handlePurged})},t}return n.__extends(t,e),t.prototype.isSingleSharedFolder=function(e){return 1===e.length&&e[0].type===c.FileTypes.SHARED_FOLDER},t.prototype.getTitle=function(e){var t=e.length;return this.isSingleSharedFolder(e)?w._("Remove access to folder?"):w.ungettext("Permanently delete %(num)s file?","Delete %(num)s items permanently?",t).format({num:t})},t.prototype.renderContent=function(e){var t=e.length;if(1===t){var n=d.filename(e[0].fq_path);return this.isSingleSharedFolder(e)?y.reactFormat(w._("Are you sure you want to remove your access to <strong>%(filename)s</strong>? It will no longer be viewable in your list of shared folders, and you won’t be able to re-add it to your Dropbox unless you’re re-invited."),{strong:s.createElement("strong",null),filename:n}):y.reactFormat(w._("Are you sure you want to delete <strong>%(filename)s</strong> from your Dropbox permanently?"),{strong:s.createElement("strong",null),filename:n})}return s.createElement("span",null,w.ungettext("Are you sure you want to permanently delete %(num)s item from your Dropbox?","Are you sure you want to permanently delete %(num)s items from your Dropbox?",t).format({num:t}))},t.prototype.render=function(){return s.createElement(f.Modal,{ref:"modal",title:this.getTitle(this.props.files),acceptButtonText:this.isSingleSharedFolder(this.props.files)?w._("Remove my access"):w._("Delete permanently"),dismissButtonText:w._("Cancel"),onAccept:this.handleAccept},this.renderContent(this.props.files))},t})(s.Component);M.defaultProps={onSuccess:o.noop},t.PermanentlyDeleteModal=M;var T=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleRestoreSuccess=function(){l.notifyRestoreSuccess(t.props.files),t.props.onSuccess()},t.handleRestoreClick=function(e){if(e.preventDefault(),m.browseStore.context().isNonUserRelativeContext){var n=t.props.files[0];if(n.is_dir||t.props.files.length>1){for(var s=[],r="",o=0,i=t.props.files;o<i.length;o++){var a=i[o];r="ns:"+a.ns_id+a.ns_path,s.push(r)}h.restorePaths(s,t.handleRestoreSuccess)}else h.restoreFile(n.ns_id,n.ns_path,n.latest_rev,t.handleRestoreSuccess)}else p.restoreFiles({files:t.props.files,userId:t.props.userId,onSuccess:t.handleRestoreSuccess});t.refs.modal.close()},t.handleCancelClick=function(e){e.preventDefault(),t.refs.modal.close()},t}return n.__extends(t,e),t.prototype.getTitle=function(e,t){var n=e-1;return 0===n?w._("Restore %(name)s?").format({name:t}):w.ungettext("Restore %(name)s and %(num)s other item?","Restore %(name)s and %(num)s other items?",n).format({num:n,name:t})},t.prototype.renderSingleFileContent=function(e,t){var n=d.filename(e.fq_path);return[y.reactFormat(w._("The most recent version of <strong>%(filename)s</strong> will be restored."),{strong:s.createElement("strong",null),filename:n}),s.createElement("div",{className:"file-modal__single-file-row"},s.createElement(u.FileIcon,{file:e,className:"brws-file-name-cell-icon file-modal__single-file-row-icon"}),!m.browseStore.context().isNonUserRelativeContext&&t?s.createElement("a",{href:t,className:"file-modal__single-file-row-link"},n):n)]},t.prototype.renderSingleFolderContent=function(e){var t=d.filename(e.fq_path);return[y.reactFormat(w._("Restoring this folder will bring back any files and folders in it. If you’d like specific people to have access, add them once you’ve restored the folder.")),s.createElement("div",{className:"file-modal__single-file-row"},s.createElement(u.FileIcon,{file:e,className:"brws-file-name-cell-icon file-modal__single-file-row-icon"}),t)]},t.prototype.renderMultiFileContent=function(e){return s.createElement("span",null,m.browseStore.context().isNonUserRelativeContext?y.reactFormat(w._("Restoring these items will bring back any files and folders inside them. If you’d like specific people to have access, add them once you’ve restored the items.")):w.ungettext("Are you sure you want to restore %(num)s item?","Are you sure you want to restore %(num)s items?",e.length).format({num:e.length}))},t.prototype.renderButtons=function(e){return s.createElement("div",{className:"file-modal__buttons"},e?s.createElement("div",{className:"file-modal__buttons__alt",ref:"revisionButton"},s.createElement("a",{href:e},w._("View other versions"))):void 0,s.createElement("div",{className:"file-modal__buttons__main"},s.createElement("button",{className:"button-primary db-modal-button",onClick:this.handleRestoreClick,ref:"primaryButton"},w._("Restore")),s.createElement("button",{className:"button-tertiary db-modal-button",onClick:this.handleCancelClick,ref:"tertiaryButton"},w._("Cancel"))))},t.prototype.render=function(){var e,t=this.props.files.length,n=null;return 1!==t||m.browseStore.context().isNonUserRelativeContext||(n=i.getFileHistoryUrl({fqPath:this.props.files[0].fq_path,userId:this.props.userId})),e=1===t?this.props.files[0].is_dir?this.renderSingleFolderContent(this.props.files[0]):this.renderSingleFileContent(this.props.files[0],n):this.renderMultiFileContent(this.props.files),s.createElement(f.Modal,{ref:"modal",title:this.getTitle(t,d.filename(this.props.files[0].fq_path)),buttonComponent:this.renderButtons(n)},e)},t})(s.Component);T.defaultProps={onSuccess:o.noop},t.RestoreFilesModal=_(T,["/static/css/react/file_modal-vfl5O9OmZ.css"]);var A=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedPath:null},t.handleMoveSuccess=function(e){var n=e.changesets,s=e.rollbackHints,r=t.props.files.length,o=t.props.user;l.notifyMoveSuccess(r,o,n,t.state.selectedPath,s,t.props.onUndo),t.props.onSuccess(e)},t.handleCopySuccess=function(e){var n=e.changesets,s=e.rollbackHints,r=t.props.files.length,o=t.props.user;l.notifyCopySuccess(r,o,n,t.state.selectedPath,s,t.props.onUndo),t.props.onSuccess(e)},t.handleAccept=function(){var e,n=E();t.props.operation===N.MOVE?(e=n.moveFiles({path:t.props.path,files:t.props.files,newPath:t.state.selectedPath,userId:t.props.user.id,onSuccess:t.handleMoveSuccess}),e||t.props.onRequestNotSent&&t.props.onRequestNotSent()):t.props.operation===N.COPY&&(e=n.copyFiles({files:t.props.files,newPath:t.state.selectedPath,userId:t.props.user.id,onSuccess:t.handleCopySuccess}),e||t.props.onRequestNotSent&&t.props.onRequestNotSent())},t.handleFolderSelected=function(e){t.setState({selectedPath:e})},t.handleModalShown=function(){var e=r.findDOMNode(t.refs.treeView);if(e)return e.focus()},t}return n.__extends(t,e),t.prototype.getTitle=function(){var e,t=this.props.files.length;return this.props.operation===N.MOVE?e=this.props.files[0].is_dir?w.ungettext("Move %(num)s folder to…","Move %(num)s items to…",t,{comment:'"items" is a (potential) mix of files and folders'}):w.ungettext("Move %(num)s file to…","Move %(num)s items to…",t,{comment:'"items" is a (potential) mix of files and folders'}):this.props.operation===N.COPY&&(e=this.props.files[0].is_dir?w.ungettext("Copy %(num)s folder to…","Copy %(num)s items to…",t,{comment:'"items" is a (potential) mix of files and folders'}):w.ungettext("Copy %(num)s file to…","Copy %(num)s items to…",t,{comment:'"items" is a (potential) mix of files and folders'})),e.format({num:t})},t.prototype.getActionButtonText=function(){return this.props.operation===N.COPY?w._("Copy"):this.props.operation===N.MOVE?w._("Move"):void 0},t.prototype.render=function(){return s.createElement(f.Modal,{ref:"modal",title:this.getTitle(),acceptButtonText:this.getActionButtonText(),onAccept:this.handleAccept,acceptButtonDisabled:!this.state.selectedPath,autoFocusPrimaryInput:!1,onShow:this.handleModalShown,dismissButtonText:w._("Cancel")},s.createElement(g.FolderTreeView,{ref:"treeView",rootPath:"/",user:this.props.user,onFolderSelected:this.handleFolderSelected,isRootSelectable:!0,treeRootName:C(this.props.files,this.props.user)}))},t})(s.Component);A.defaultProps={onSuccess:o.noop},t.FileTransferModal=A;var P=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSuccess=function(e){var n=e.changesets,s=e.rollbackHints;return l.notifyDeleteSuccess(t.props.files.length,t.props.user,n,s,t.props.onUndo),t.props.onSuccess(e)},t.handleAccept=function(){var e=m.browseStore.context();return e.isNonUserRelativeContext?h.deleteFiles({files:t.props.files,context:e}):p.deleteFiles({files:t.props.files,userId:t.props.user.id,onSuccess:t.handleSuccess})},t.isRemovingSharedFolder=function(){return 1===t.props.files.length&&t.props.files[0].target_ns},t.getTitle=function(){var e=t.props.files;return e.length<1?"":1===e.length?e[0].is_dir?w._("Delete folder?"):w._("Delete file?"):w.ungettext("Delete %(item_count)s item?","Delete %(item_count)s items?",e.length).format({item_count:e.length})},t.getContents=function(){var e=t.props.files;if(e.length<1)return"";var n=d.filename(e[0].fq_path),r=e[0].target_ns;if(null!=t.props.parentSharedFolderName){var o=t.props.parentSharedFolderName;return 1===e.length?y.reactFormat(w._("Are you sure you want to delete <b>%(filename)s</b> from the shared folder ‘%(shared_folder_name)s’?"),{filename:n,shared_folder_name:o,b:s.createElement("b",null)}):w.ungettext("Are you sure you want to delete %(item_count)s item from the shared folder ‘%(shared_folder_name)s’?","Are you sure you want to delete %(item_count)s items from the shared folder ‘%(shared_folder_name)s’?",e.length).format({item_count:e.length,shared_folder_name:o})}return 1===e.length&&r&&!m.browseStore.context().isNonUserRelativeContext?y.reactFormat(w._("Are you sure you want to remove the shared folder <b>%(filename)s</b> from your Dropbox? This shared folder will stay shared with other members and you can re-add it later."),{filename:n,b:s.createElement("b",null)}):1===e.length?y.reactFormat(w._("Are you sure you want to delete <b>%(filename)s</b> from your Dropbox?"),{filename:n,b:s.createElement("b",null)}):w.ungettext("Are you sure you want to delete %(item_count)s item from your Dropbox?","Are you sure you want to delete %(item_count)s items from your Dropbox?",e.length).format({item_count:e.length})},t}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(f.Modal,{ref:"modal",title:this.getTitle(),onAccept:this.handleAccept,acceptButtonText:this.isRemovingSharedFolder()&&!m.browseStore.context().isNonUserRelativeContext?w._("Remove"):w._("Delete"),dismissButtonText:w._("Cancel")},this.getContents())},t})(s.Component);P.defaultProps={onSuccess:o.noop,parentSharedFolderName:null},t.DeleteFileModal=P;var k=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAcceptAndCloseModal=function(){t.handleAccept(),f.Modal.close()},t.upgradeRedirect=function(){var e=new I({path:"/plans",query:{trigger:"nr",tk:"oq_delete_modal"}});S.redirect(e.toString())},t}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(f.Modal,{ref:"modal",title:this.getTitle(),onAccept:this.handleAccept,buttonComponent:this.renderButtons(),acceptButtonText:this.isRemovingSharedFolder()?w._("Remove"):w._("Delete"),dismissButtonText:w._("Cancel")},this.getContents(),this.renderAdditionalContent())},t.prototype.renderAdditionalContent=function(){var e=this.props.files;return null==(null!=e?e.length:void 0)||e.length<1?"":e[0].target_ns&&1===e.length&&!m.browseStore.context().isNonUserRelativeContext?s.createElement("div",{className:"u-mar-top-s"},w._("Or, get more space for your files when you upgrade your account.")):!e[0].target_ns||e.length>1?s.createElement("span",{className:"oq-delete-file-modal-upsell__additional-text"},w._("Instead, get more space for your files when you upgrade your account.")):void 0},t.prototype.renderButtons=function(){return s.createElement("div",{className:"oq-delete-file-modal-upsell__buttons"},s.createElement("button",{className:"button-primary db-modal-button",onClick:this.upgradeRedirect,ref:"primaryButton"},w._("Upgrade")),s.createElement("button",{className:"button-tertiary db-modal-button u-mar-left-s",onClick:this.handleAcceptAndCloseModal,ref:"secondaryButton"},this.isRemovingSharedFolder()?w._("Remove"):w._("Delete")))},t})(P);t.ExpOQDeleteFileModal=k;var x=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAccept=function(){var e=t.props.files[0].fq_path;v.asyncGoToContentManagerForPath({isLimitedTeam:t.props.isLimitedTeam,containingFolder:d.parent_dir(e),filenameToSelect:d.filename(e),isCDM:!1})},t}return n.__extends(t,e),t.prototype.getModalMessage=function(){return"archive"===this.props.type?w._("You can archive team folders in the Admin Console."):"rename"===this.props.type?w._("You can rename team folders in the Admin Console."):void 0},t.prototype.render=function(){return s.createElement(f.Modal,{ref:"modal",style:"clean",onAccept:this.handleAccept,acceptButtonText:w._("Go to Admin Console"),altAction:s.createElement("a",{onClick:function(){return f.Modal.close()}},w._("Cancel")),width:350,showX:!1,className:"content-manager-bridge-modal"},this.getModalMessage())},t})(s.Component);t.ContentManagerBridgeModal=x;var F=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAcceptClick=function(){t.props.userIsSuperAdmin&&t.props.userIsSameTeam&&v.asyncGoToContentManagerForPath({isLimitedTeam:!1,containingFolder:t.props.folderPath,isCDM:!0})},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.userIsSuperAdmin&&this.props.userIsSameTeam,t="";return t=e?w._("You aren’t a member of this folder. However, as an admin, you can access it via the content tab in the Admin Console."):this.props.userIsSameTeam?w._("You don’t have permission to open the folder “%(folder_name)s”. Contact your <admin_link>team admins</admin_link> to gain access."):w._("You don’t have permission to open the folder “%(folder_name)s”."),s.createElement(f.Modal,{ref:"modal",style:"default",acceptButtonText:e?w._("Go to the content tab"):w._("Done"),dismissButtonText:e?w._("Cancel"):null,onAccept:this.handleAcceptClick,title:w._("No access to the folder “%(folder_name)s”").format({folder_name:a.em_snippet(this.props.folderName,b.SNIPPET_SIZES.FILENAME)})},s.createElement("div",null,y.reactFormat(t,{folder_name:a.em_snippet(this.props.folderName,b.SNIPPET_SIZES.FILENAME),admin_link:s.createElement("a",{href:"/team?_tk=left_nav_team",target:"_blank",key:"admin_link",rel:"noopener noreferrer"})})))},t})(s.Component);t.NoAccessFolderModal=F;var L=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAcceptAndCloseModal=function(){t.props.onAccept(),f.Modal.close()},t}return n.__extends(t,e),t.prototype.render=function(){var e=w._("If you make this move, you'll no longer be the owner of some of the folders.");return s.createElement(f.Modal,{ref:"modal",style:"default",onAccept:this.handleAcceptAndCloseModal,acceptButtonText:w._("Move items anyways"),dismissButtonText:w._("Cancel"),title:w._("Move items?")},s.createElement("div",null,e))},t})(s.Component);t.ConfirmOwnershipTransferModal=L}),define("modules/clean/react/overquota_modal",["require","exports","tslib","external/react","external/spectrum/tertiary_link","modules/clean/react/css","modules/clean/react/image","modules/core/i18n","modules/clean/static_urls","modules/clean/react/modal","modules/constants/payments"],function(e,t,n,s,r,o,i,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dismiss=function(){d.Modal.close()},t}return n.__extends(t,e),t.prototype._renderButtons=function(){var e=c.OUT_OF_SPACE_URL+"?oqa="+this.props.oqa;return s.createElement(d.ModalButtons,{className:"oq-modal__buttons"},s.createElement("a",{href:e,id:"oq-cta-button",className:"mc-button mc-button-primary"},a._("Get more space")))},t.prototype._renderAltAction=function(){return this.props.dismissText?s.createElement("div",{className:"overquota_modal__alt-action-container"},s.createElement(r.TertiaryLink,{onClick:this._dismiss},this.props.dismissText)):null},t.prototype._renderContentTitle=function(){return s.createElement("p",{className:"oq-modal__content--title"},a._("Your Dropbox is full"))},t.prototype._renderImage=function(){return s.createElement(i,{src:l.static_url("/static/images/pro/overquota/overquota-folder-vflgFxxXj.png"),srcHiRes:l.static_url("/static/images/pro/overquota/overquota-folder@2x-vfloUmya6.png")})},t.prototype.render=function(){return s.createElement(d.Modal,{className:"overquota_modal",title:a._("Your Dropbox is full"),buttonComponent:this._renderButtons(),altAction:this._renderAltAction(),style:"clean",showX:!0},s.createElement("div",{className:"oq-modal__content"},this._renderImage(),this._renderContentTitle(),s.createElement("p",null,this.props.tagline)))},t})(s.Component);p.defaultProps={tagline:a._("Before you can update or move your files, you need more space."),oqa:"upl_f"},t.OverquotaModalElement=p,t.OverquotaModal=o(p,["/static/css/react/overquota_modal-vflG9lYFj.css"])}),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/radio",["external/classnames","external/react","external/react-dom"],function(t,n,s){var r,o,i,a,l,d;return n.DOM,d=n.PropTypes,i={Normal:"normal",Large:"large"},l=Object.keys(i).map(function(e){return i[e]}),a=d.oneOfType([d.string,d.number,d.bool]),o=n.createClass({displayName:"RadioItem",propTypes:{className:d.string,value:a,_radioGroupData:d.shape({variant:d.oneOf(l),name:d.string.isRequired,radioGroupValue:a,onSelect:d.func})},_handleClick:function(){var e;this._isSelected()||(s.findDOMNode(this.refs.input).focus(),"function"==typeof(e=this.props._radioGroupData).onSelect&&e.onSelect(this.props.value))},_handleChange:function(){var e;"function"==typeof(e=this.props._radioGroupData).onSelect&&e.onSelect(this.props.value)},_getId:function(){return this.props._radioGroupData.name+"_"+this.props.value},_isSelected:function(){return this.props._radioGroupData.radioGroupValue===this.props.value},render:function(){var s,r,o,a;return r=this.props._radioGroupData,a=["c-radio-wrapper",this.props.className],s={"c-radio":!0,"c-radio--selected":this._isSelected()},o=r.variant,e.call(l,o)>=0&&r.variant!==i.Normal&&(s["c-radio--"+r.variant]=!0),n.createElement("div",{className:t(a),onClick:this._handleClick},n.createElement("input",{id:this._getId(),ref:"input",type:"radio",name:r.name,value:this.props.value,checked:this._isSelected(),onChange:this._handleChange}),n.createElement("div",{className:t(s)},n.createElement("div",{className:"c-radio__inner"})),n.createElement("label",{className:"c-radio-content",htmlFor:this._getId()},this.props.children))}}),r=n.createClass({displayName:"RadioGroup",propTypes:{className:d.string,variant:d.oneOf(l),name:d.string,legend:d.string.isRequired,align:d.oneOf(["top","bottom","middle","baseline"]),displayLegend:d.bool,valueLink:d.object},getDefaultProps:function(){return{className:null,type:i.Normal,align:"middle",displayLegend:!1}},_onRadioItemSelect:function(e){var t;null!=(t=this.props.valueLink)&&t.requestChange(e)},render:function(){var e,s,r,i;return s=this.props.name||"radio-"+Math.floor(1e9*Math.random()),e=n.Children.map(this.props.children,(function(e){return function(t){return t.type===o?n.cloneElement(t,{_radioGroupData:{variant:e.props.variant,name:s,radioGroupValue:e.props.valueLink.value,onSelect:e._onRadioItemSelect}}):t}})(this)),r={"c-radio-group__legend":!0,"ax-visually-hidden":!this.props.displayLegend},i=["c-radio-group","align-"+this.props.align,this.props.className],n.createElement("fieldset",{className:t(i)},n.createElement("legend",{className:t(r)},this.props.legend),e)}}),{RadioGroup:r,RadioItem:o,RadioItemVariant:i}})}.call(this),function(){define("modules/clean/react/sharing/shared_with_view",["external/classnames","external/react","modules/clean/avatar/inherited_count_avatar","modules/clean/avatar/size","modules/clean/components/loading_indicator","modules/clean/components/title_bubble","modules/clean/sharing/constants","modules/clean/em_string","modules/clean/react/browse/models","modules/clean/sharing/api/types/metadata","modules/clean/sharing/member_avatars","modules/clean/static_urls","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/constants/viewer","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_){var f,g,y,v,b,S,w,I,E,C,N,M,T,A,P,k,x,F;return g=s.AVATAR_DIMENSION_BY_SIZE,E=i.SNIPPET_SIZES,M=i.TRUELINK,v=l.File,b=d.LinkAudience,C=d.SharedContentLinkMetadata,x=p.static_url,T=u.UserEducationEffect,A=_._,F=_.ungettext,k=t.DOM,P=t.createElement,S=5,f=g.SMALL,y=12,w="--",I="--",N=t.createClass({displayName:"SharedWithView",mixins:[c],propTypes:{user:t.PropTypes.object.isRequired,file:t.PropTypes.instanceOf(v),onOverflowCountClick:t.PropTypes.func,onAvatarClick:t.PropTypes.func,groups:t.PropTypes.array,invitations:t.PropTypes.array,joinedMembers:t.PropTypes.array,numUndisplayableUsersAndInvites:t.PropTypes.number,memberCount:t.PropTypes.number,numInheritedMembers:t.PropTypes.number,parentFolderName:t.PropTypes.string,animation:t.PropTypes.bool,titleButtonDirection:t.PropTypes.string,avatarDimension:t.PropTypes.number,maxVisibleAvatars:t.PropTypes.number,sharedLinkInfo:t.PropTypes.object,onSharedLinkClick:t.PropTypes.func,isMaestroDesign:t.PropTypes.bool,inSelectMode:t.PropTypes.bool,isInAudienceBox:t.PropTypes.bool,audienceDescription:t.PropTypes.string,hasSharedDataLoaded:t.PropTypes.bool,canViewMembers:t.PropTypes.bool,inContentManagerCdmRoot:t.PropTypes.bool,
linkMetadata:t.PropTypes.instanceOf(C),publicFolderSharing:t.PropTypes.bool},getDefaultProps:function(){return{titleButtonDirection:"south",avatarDimension:f,maxVisibleAvatars:S,file:null,canViewMembers:!0,inContentManagerCdmRoot:!1,inSelectMode:!1,memberCount:0}},render:function(){var e,t;return this.props.inContentManagerCdmRoot?0===this.props.groups.length?k.div({}):(e=this.props.groups[0].num_users,k.div({className:"audience-description",onClick:function(e){return e.stopPropagation()}},F("%(num)s member","%(num)s members",e).format({num:e}))):this.props.isInAudienceBox?this.props.canViewMembers?(null!=(t=this.props.file)?t.isDeleted:void 0)?null:k.div({className:this.getClassName()},this.props.hasSharedDataLoaded?P(T,{containerName:this.constructor.displayName,name:"AudienceBoxAvatars"},this.renderAudienceBoxAvatars()):P(r,{style:r.LoadingIndicatorStyle.DOTS})):null:this.props.isMaestroDesign?k.div({className:this.getClassName()},this._hasSharedLink()?this.renderSharedLinkInColumn():void 0,this.renderAudienceDescription()):k.div({className:this.getClassName()},this.renderAvatars())},getClassName:function(){return e({"shared-with-members":!0,"shared-with-members--golden-gate":!this.props.isMaestroDesign,clearfix:!0,"audience-box u-pad-top-xs u-pad-bottom-s u-mar-bottom-xs":this.props.isInAudienceBox})},renderSharedLinkInColumn:function(){var e,t;return t=this.props.onSharedLinkClick,e=this.props.inSelectMode,P(o,{key:"shared_link",text:this.getDescriptionForSharedLinkInfo(this.props.sharedLinkInfo,this.props.linkMetadata),direction:this.props.titleButtonDirection,className:"audience-description__link-avatar"},k.img({src:x("/static/images/avatar/shared-link-icon-vflHCU_m6.svg"),alt:this.props.alt||A("Shared link"),width:y,height:y,onClick:function(n){if(!e)return t(),n.stopPropagation()}}))},renderAudienceDescription:function(){var e,t,n,s,r,i,l,d,c,p,u,m,h,_,f,g,y;return this.props.hasSharedDataLoaded?((null!=(_=this.props.file)?_.isDeleted:void 0)?n=A("Deleted"):this.props.canViewMembers?this.props.audienceDescription&&(n=this.props.audienceDescription):n=I,s=(this.props.groups||[]).concat(this.props.joinedMembers||[]).concat(this.props.invitations||[]),p=s.length+(this.props.numUndisplayableUsersAndInvites||0),f=this.findOwnerAndMeInJoinedMembers(this.props.joinedMembers||[]),f[0],c=f[1],p>=0&&(1!==p||null==c)&&(n||(n=F("%(num)s member","%(num)s members",this.props.memberCount).format({num:this.props.memberCount})),y=s.slice(0,this.props.maxVisibleAvatars),m=(function(){var e,t,n;for(n=[],e=0,t=y.length;e<t;e++)d=y[e],n.push(a.em_snippet(d.display_name||d.email||d.name||d.email_or_fbname,E.DISPLAY_NAME));return n})(),p>this.props.maxVisibleAvatars&&(m.pop(),e=p-(this.props.maxVisibleAvatars-1),u=F("and %(num)s more...","and %(num)s more...",e,{comment:"Number of additional members in the file. Expected to be >= 2."}).format({num:e}),m.push(u)),r=m.join("\n")),this.props.publicFolderSharing&&this.props.file&&!this.props.file.is_dir?n||(n=A("Anyone")):n||(n=A("Only you")),h=this.props.onAvatarClick,i=this.props.inSelectMode,l=null!=(g=this.props.file)?g.isDeleted:void 0,t=k.div({className:"audience-description",onClick:function(e){if(!i&&!l)return h(),e.stopPropagation()}},n),r?P(o,{key:"membership_column_bubble",respectLineBreaks:!0,text:r,direction:this.props.titleButtonDirection},t):t):null},renderAudienceBoxAvatars:function(){var e,t,n,s,r,o,i;return e=[],s=this.props.joinedMembers?this.props.joinedMembers:[],t=this.props.groups?this.props.groups.slice():[],n=this.props.invitations?this.props.invitations.slice():[],this._addSharedLinkIfExists(e),i=[],o=this.findOwnerAndMeInJoinedMembers(s),o[0],r=o[1],null!=r&&(i.push(r.user_id),e.push(this.renderJoinedMember(r))),this.addGroupsMembersInvitations(e,t,s,n,i),1===e.length&&null!=r?k.div({className:"audience-box--text-only"},A("Only you have access")):this.renderAvatarList(e)},renderAvatars:function(){var e,t,n,s,r,o,i,a,l;return(null!=(i=this.props.file)?i.isDeleted:void 0)?k.span({"aria-hidden":!0},A("deleted")):(r=this.props.joinedMembers?this.props.joinedMembers:[],n=this.props.groups?this.props.groups.slice():[],s=this.props.invitations?this.props.invitations.slice():[],e=[],this._addSharedLinkIfExists(e),l=[],a=this.findOwnerAndMeInJoinedMembers(r),a[0],o=a[1],null!=o&&l.push(o.user_id),this.addGroupsMembersInvitations(e,n,r,s,l),t=0===e.length&&0===this.props.numInheritedMembers,t?this.props.hasSharedDataLoaded?k.span({"aria-hidden":!0},w):void 0:this.renderAvatarList(e))},_addSharedLinkIfExists:function(e){if(this._hasSharedLink())return M.TRUELINK_UI[this.props.user.id]?e.push(this.renderSharedLink(null,this.props.linkMetadata)):e.push(this.renderSharedLink(this.props.sharedLinkInfo))},_hasSharedLink:function(){return M.TRUELINK_UI[this.props.user.id]?this.props.linkMetadata&&this.props.linkMetadata.current_audience!==b.members:Boolean(this.props.sharedLinkInfo)}}),{SharedWithView:N}})}.call(this),define("modules/clean/react/starred/browse_exports",["require","exports","modules/clean/react/starred/store","modules/clean/react/starred/browse_update","modules/clean/react/starred/star","modules/clean/react/starred/actions"],function(e,t,n,s,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredStore=n.StarredStore,t.checkForMissingStarredData=s.checkForMissingStarredData,t.Star=r.Star,t.StarredActions=o.StarredActions}),define("modules/clean/react/starred/browse_update",["require","exports","modules/clean/react/home/home_access/home_access_util","modules/clean/react/starred/actions","modules/constants/starred","modules/clean/react/starred/store"],function(e,t,n,s,r,o){"use strict";function i(e){var t=e.files,i=e.isNonUserRelativeContext,a=e.user;if(n.isHomeEnabled()&&!i){var l=t.map(function(e){return{type:r.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID,id:e.file_id}}).filter(function(e){return!(!e.id||o.StarredStore.hasIdTypePair(e))});l.length&&s.StarredActions.fetchStatuses(a.role,l)}}Object.defineProperty(t,"__esModule",{value:!0}),t.checkForMissingStarredData=i}),function(){define("modules/clean/react/tabs/tab_nav",["jquery","external/underscore","external/classnames","external/react","modules/clean/react/css","modules/clean/react/tabs/tab_bar","modules/clean/react/tabs/tab_util","modules/clean/react/tabs/tabs"],function(e,t,n,s,r,o,i,a){var l,d,c,p;return d=a.TabContent,p=s.DOM,l=s.PropTypes,c=s.createClass({displayName:"TabNav",propTypes:{tabs:l.arrayOf(l.oneOfType([l.string,l.number,l.shape({value:l.oneOfType([l.string,l.number]),label:l.string,rightAlign:l.bool})])),defaultSelectedIndex:l.number,onChange:l.func,idPrefix:l.string,variant:l.string,className:l.string},getDefaultProps:function(){return{defaultSelectedIndex:0,variant:i.variants.DEFAULT,onChange:function(){}}},getInitialState:function(){return{selectedIndex:this.props.defaultSelectedIndex}},componentWillReceiveProps:function(e){if(this.props.defaultSelectedIndex!==e.defaultSelectedIndex)return this.setState({selectedIndex:e.defaultSelectedIndex})},_onChange:function(e,t){return this.props.onChange(e,t),this.setState({selectedIndex:t})},render:function(){var e;return e=this.props.idPrefix?this.props.idPrefix:"tabset"+t.uniqueId(),p.div({className:n(this.props.variant,this.props.className)},s.createElement(o,{tabs:this.props.tabs,onChange:this._onChange,idPrefix:e,selectedIndex:this.state.selectedIndex}),s.createElement(d,{isSelected:!0,id:i.getTabContentId(e),tabId:i.getTabId(e,this.state.selectedIndex)},this.props.children))}}),r(c,["/static/css/legacy_packages/components-vflfWNhxV.css"])})}.call(this),function(){define("modules/clean/react/teams/modals/limited_team_folder_settings_modal",["external/react","external/underscore","modules/core/i18n","modules/clean/analytics","modules/clean/react/modal","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/sharing/folder_settings_modal","modules/constants/python"],function(e,t,n,s,r,o,i,a){var l,d,c,p,u;return p=n._,c=s.TeamsWebActionsLogger,l=r.Modal,d=i.SharedFolderSettingsModal,u=e.createElement,{showWithProps:function(e){var n,s;return n={altAction:u(o,{upsellText:p("Want to access these settings as well as other admin controls? Upgrade to %(trademark_business)s.").format({trademark_business:a.TRADEMARK_BUSINESS}),upgradeButtonText:p("Upgrade now"),redirectQuery:{tk:"team_settings",_camp:"modal"},logEventName:"team_folder_settings_upsell"})},s=l.showInstance(u(d,t(e).extend(n))),c.log("team_folder_settings",null,null,null,!1,c.LOG_CATEGORY.TEAM_INFO),s}}})}.call(this),function(){define("modules/clean/react/teams/modals/limited_team_share_folder_modal",["external/react","modules/core/i18n","modules/clean/analytics","modules/clean/filepath","modules/clean/react/modal","modules/core/browser","modules/core/uri"],function(e,t,n,s,r,o,i){var a,l,d,c,p,u,m;return c=t._,d=n.TeamsWebActionsLogger,l=r.Modal,m=e.DOM,u=e.createElement,p=function(e){return d.log(e,null,null,null,!1,d.LOG_CATEGORY.TEAM_INFO)},a=e.createClass({mixins:[e.addons.PureRenderMixin],displayName:"LimitedTeamShareFolderModal",propTypes:{fqPath:e.PropTypes.string.isRequired},_navigateToTeam:function(){return p("team_folder_share_invite"),o.redirect(i({path:"/team",query:{invite_members:"",tk:"team_folder_share_invite",_camp:"modal"}}))},render:function(){var e;return e=s.filename(this.props.fqPath),u(l,{title:c("Share %(folder_name)s").format({folder_name:e}),acceptButtonText:c("Invite"),onAccept:this._navigateToTeam,showButtonDivider:!0},m.div({},c("To share the %(folder_name)s with someone, invite them to join your team!").format({folder_name:e})))}}),{showModalInstance:function(e){var t;return t=l.showInstance(u(a,e)),p("team_folder_share"),t}}})}.call(this),function(){define("modules/clean/react/teams/modals/limited_team_upsell_modal_banner",["external/react","modules/core/browser","modules/core/uri","modules/clean/react/button","modules/clean/analytics"],function(e,t,n,s,r){var o,i,a,l,d;return i=s.button,o=r.TeamsWebActionsLogger,l=e.DOM,a=e.createElement,d=e.PropTypes,e.createClass({mixins:[e.addons.PureRenderMixin],propTypes:{upgradeButtonText:d.string.isRequired,upsellText:d.string.isRequired,logEventName:d.string,redirectUrl:d.string,redirectQuery:d.shape({tk:d.string,_camp:d.string})},displayName:"LimitedTeamUpsellModalBanner",_handleCTAClick:function(){return this.props.logEventName&&o.log(this.props.logEventName,{},null,null,!1,o.LOG_CATEGORY.UPGRADE),t.redirect(n({path:this.props.redirectUrl?this.props.redirectUrl:"/team/upgrade",query:this.props.redirectQuery}))},render:function(){return l.div({className:"modal-upsell-bar"},l.div({className:"modal-upsell-bar__message"},this.props.upsellText),l.div({className:"modal-upsell-bar__action"},a(i,{className:"modal-upsell-bar__cta-button",onClick:this._handleCTAClick},this.props.upgradeButtonText)))}})})}.call(this),define("modules/clean/react/tree_view",["require","exports","tslib","external/classnames","external/immutable","external/react","external/react-dom","external/underscore","jquery","modules/clean/ajax","modules/clean/em_string","modules/clean/filepath","modules/clean/keycode","modules/clean/react/browse/store","modules/clean/react/css","modules/clean/react/sprite","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_LABEL_LENGTH=20,t.INDENT_SIZE_PX=15;var v;(function(e){e[e.None=0]="None",e[e.TreeItem=1]="TreeItem",e[e.HeaderItem=2]="HeaderItem",e[e.StaticHeader=3]="StaticHeader"})(v=t.RootStyle||(t.RootStyle={}));var b=(function(){function e(e){this.key=e.key,this.label=e.label?e.label:"",this.icon=e.icon?e.icon:null,this.disabled=!!e.disabled,this.canExpand=!!e.canExpand,this.forceExpanded=!!e.forceExpanded}return e})();t.TreeItem=b;var S=(function(){function e(e){var t=r.Map();this.rootItem=e.rootItem,this.items=e.items,this.childItemsByParentKey=e.childItemsByParentKey||t,this.parentItemByChildKey=e.parentItemByChildKey||r.Map()}return e.createWithRootItem=function(t){return new e({rootItem:t,items:r.Map([[t.key,t]])})},e.prototype.getParentItem=function(e){if(e){var t=this.parentItemByChildKey.get(e.key);return t?this.items.get(t):null}},e.prototype.getChildItems=function(e){return this.childItemsByParentKey.get(e.key)||null},e.prototype.isParent=function(e){return this.childItemsByParentKey.has(e.key)},e.prototype.setChildItems=function(t,n){n=r.List(n);var s=r.Map(n.map(function(e){return[e.key,e]})),o=r.Map(this.items).merge(s),i=r.Map(this.childItemsByParentKey).set(t.key,n),a=r.Map(this.parentItemByChildKey);return n.forEach(function(e){return a=a.set(e.key,t.key)}),new e({rootItem:this.rootItem,items:o,childItemsByParentKey:i,parentItemByChildKey:a})},e})();t.Tree=S;var w=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return o.createElement("ul",{className:"tree-view__group",role:"group"},this.props.children)},t})(o.Component),I=(function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){if(e.preventDefault(),e.stopPropagation(),!t.props.item.disabled){var n=i.findDOMNode(t.refs.expandButton);n&&n.contains(e.target)||t.props.onClick&&t.props.onClick(t.props.item)}},t.handleExpandClick=function(e){e.preventDefault(),t.props.onExpandButtonClick&&t.props.onExpandButtonClick(t.props.item,!t.props.isExpanded)},t}return n.__extends(r,e),r.prototype.renderExpandButton=function(){return o.createElement("div",{className:"tree-view__expand-button",onClick:this.handleExpandClick,ref:"expandButton",role:"button"},o.createElement(_,{group:"web",name:this.props.isExpanded?"bullet_minus":"bullet_plus",alt:this.props.isExpanded?g._("Collapse"):g._("Expand")}))},r.prototype.renderIcon=function(){return o.createElement("div",{className:"tree-view__icon-wrapper"},o.createElement(_,{className:"tree-view__item-icon",group:"web",name:this.props.item.icon,alt:""}))},r.prototype.render=function(){var e=!this.props.canExpand,n=s({"tree-view__item":!0,"tree-view__item--leaf":e}),r=this.props.canExpand&&!this.props.showAsHeader;return o.createElement("li",{key:this.props.item.key,id:this.props.id,className:n,onClick:this.handleClick,role:"treeitem","aria-disabled":this.props.item.disabled,"aria-label":this.props.item.label,"aria-level":this.props.level+1,"aria-selected":!!this.props.isSelected||void 0,"aria-expanded":r?this.props.isExpanded:void 0},o.createElement("span",{className:s({"tree-view__item-row":!0,"tree-view__item-row--disabled":this.props.item.disabled}),style:{paddingLeft:this.props.showAsHeader?0:this.props.level*t.INDENT_SIZE_PX}},this.props.showAsHeader||e?void 0:this.renderExpandButton(),this.props.item.icon?this.renderIcon():void 0,this.props.item.label?o.createElement("span",{className:"tree-view__item-label"},c.em_snippet(this.props.item.label,t.MAX_LABEL_LENGTH)):void 0),this.props.children)},r})(o.Component);I.defaultProps={isSelected:!1,isExpanded:!1,canExpand:!1,level:0,onClick:a.noop,onExpandButtonClick:a.noop,showAsHeader:!1},t.TreeItemView=I;var E=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderIcon=function(){return this.props.item.icon?o.createElement(_,{className:"tree-view__header-icon",group:"web",name:this.props.item.icon,alt:""}):null},t.prototype.render=function(){return o.createElement("div",{className:"tree-view__item-row"},this.renderIcon(),o.createElement("h3",{className:"tree-view__header",id:this.props.id},this.props.item.label))},t})(o.Component),C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedItemKey:null,expandedItemKeys:r.Set([t.props.tree.rootItem.key]),showFocused:!1},t.selectItem=function(e){t.setState({selectedItemKey:null!=e&&e.key?e.key:null}),t.props.onItemSelected(e)},t.handleExpandButtonClick=function(e,n){t.setState({expandedItemKeys:t.setItemExpanded(e.key,n)}),t.props.onItemExpanded(e,n)},t.handleKeyDown=function(e){switch(e.which){case u.KeyCode.UP:t.advanceSelection(!0)&&e.preventDefault();break;case u.KeyCode.DOWN:t.advanceSelection(!1)&&e.preventDefault();break;case u.KeyCode.RIGHT:if(null!=t.state.selectedItemKey){var n=t.props.tree.items.get(t.state.selectedItemKey);t.canItemExpand(n)&&(t.handleExpandButtonClick(n,!0),e.preventDefault())}break;case u.KeyCode.LEFT:if(t.state.selectedItemKey){var n=t.props.tree.items.get(t.state.selectedItemKey);t.canItemExpand(n)&&(t.handleExpandButtonClick(n,!1),e.preventDefault())}}},t.handleOnFocus=function(){return t.setState({showFocused:!0})},t.handleOnBlur=function(){return t.setState({showFocused:!1})},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){l(i.findDOMNode(this)).on({keydown:this.handleKeyDown})},t.prototype.componentWillUnmount=function(){l(i.findDOMNode(this)).off("keydown")},t.prototype.componentDidUpdate=function(e,t){if(this.state.selectedItemKey&&this.state.selectedItemKey!==t.selectedItemKey){var n=l(i.findDOMNode(this)),s=n.find('[aria-selected="true"]').eq(0);s.length&&this.scrollElementIntoViewIfNeeded(s,n)}},t.prototype.scrollElementIntoViewIfNeeded=function(e,t){var n=t.scrollTop(),s=n+e.position().top;if(s-n<0)return void t.scrollTop(s);var r=t.innerHeight(),o=n+r,i=e.innerHeight();s+i>o&&t.scrollTop(s-r+i)},t.prototype.hasSelectableRootItem=function(){var e=this.props.rootStyle;return e===v.TreeItem||e===v.HeaderItem},t.prototype.getHTMLIdPrefix=function(){return this.HTMLIdPrefix||(this.HTMLIdPrefix="tree-view-"+Math.floor(16777215*Math.random()).toString(16))},t.prototype.getLastLeafOf=function(e){var t=this.props.tree.getChildItems(e);return this.state.expandedItemKeys.contains(e.key)&&null!=t&&t.size>0?this.getLastLeafOf(t.last()):e},t.prototype.getPrevItem=function(e){if(!e)return null;var t=this.props.tree.getParentItem(e);if(!t)return null;var n=this.props.tree.getChildItems(t),s=n.indexOf(e);if(s>0)return this.getLastLeafOf(n.get(s-1));if(0===s){return t===this.props.tree.rootItem&&!this.hasSelectableRootItem()?null:t}return null},t.prototype.getNextItem=function(e,t){if(void 0===t&&(t=!0),!e)return null;var n=this.state.expandedItemKeys.contains(e.key),s=n&&this.props.tree.isParent(e);if(t&&s)return this.props.tree.getChildItems(e).first();var r=this.props.tree.getParentItem(e);if(!r)return null;var o=this.props.tree.getChildItems(r),i=o.size-1,a=o.indexOf(e);return a===i?this.getNextItem(r,!1):0<=a&&a<i?o.get(a+1)||null:null},t.prototype.advanceSelection=function(e){if(void 0===e&&(e=!1),!this.state.selectedItemKey){var t=void 0;if(this.hasSelectableRootItem())t=this.props.tree.rootItem;else{var n=this.props.tree.getChildItems(this.props.tree.rootItem);t=n?n.first():null}return this.selectItem(t),!0}var s=this.props.tree.items.get(this.state.selectedItemKey),r=e?this.getPrevItem(s):this.getNextItem(s);return!!r&&(this.selectItem(r),!0)},t.prototype.getValidHTMLIdForItem=function(e){return(""+this.getHTMLIdPrefix()+e.key).replace(/\s+/g,"_")},t.prototype.setItemExpanded=function(e,t){return t?this.state.expandedItemKeys.add(e):this.state.expandedItemKeys.delete(e)},t.prototype.canItemExpand=function(e){return e&&(e.canExpand||this.props.tree.isParent(e))},t.prototype.renderSingleItem=function(e,t,s,r){void 0===r&&(r={});var i=n.__assign({id:this.getValidHTMLIdForItem(e),key:e.key,item:e,isSelected:this.state.selectedItemKey===e.key,isExpanded:this.state.expandedItemKeys.contains(e.key)||e.forceExpanded,canExpand:this.canItemExpand(e)&&!e.forceExpanded,level:t,onClick:this.selectItem,onExpandButtonClick:this.handleExpandButtonClick},r),a=this.props.treeItemView;return o.createElement(a,n.__assign({},i),s)},t.prototype.renderItemAndDescendants=function(e,t){var n,s=this.state.expandedItemKeys.contains(e.key)||e.forceExpanded;return this.props.tree.isParent(e)&&s&&(n=this.renderChildrenOfItemAsGroup(e,t+1)),this.renderSingleItem(e,t,n)},t.prototype.renderChildrenOfItemAsGroup=function(e,t){var n=this;if(!e||!this.props.tree.isParent(e))return null;var s=this.props.tree.getChildItems(e).map(function(e){return n.renderItemAndDescendants(e,t)});return o.createElement(w,null,s.toJS())},t.prototype.render=function(){var e,t,n,r=this.props.tree.rootItem;if(this.props.rootStyle===v.TreeItem)t=o.createElement(w,null,this.renderItemAndDescendants(r,0));else if(this.props.rootStyle===v.HeaderItem)e=this.getValidHTMLIdForItem(r),t=o.createElement(w,null,this.renderSingleItem(r,0,null,{showAsHeader:!0,id:e}),this.renderChildrenOfItemAsGroup(r,0));else if(this.props.rootStyle===v.StaticHeader)e=this.getValidHTMLIdForItem(r),t=o.createElement(w,null,o.createElement(E,{item:r,id:e}),this.renderChildrenOfItemAsGroup(r,0));else{if(this.props.rootStyle!==v.None)throw new Error("Unknown root style: "+this.props.rootStyle);t=this.renderChildrenOfItemAsGroup(this.props.tree.rootItem,0)}if(this.state.selectedItemKey){var i=this.props.tree.items.get(this.state.selectedItemKey);n=this.getValidHTMLIdForItem(i)}return o.createElement("div",{role:"tree",tabIndex:0,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,className:s("tree-view","ax-focusable",{"is-focused":this.state.showFocused}),"aria-labelledby":e?e:void 0,"aria-activedescendant":n},t,this.props.children)},t})(o.Component);C.defaultProps={rootStyle:v.None,onItemSelected:function(e){},onItemExpanded:function(e,t){},treeItemView:I},t.TreeView=h(C,["/static/css/react/tree_view-vflwT7sZY.css","/static/css/accessibility-vflMqZNeg.css"]);var N=(function(e){function s(){var t=null!==e&&e.apply(this,arguments)||this;return t._pendingAjaxRequest=null,t.state={showLoadingScreen:!1,tree:void 0},t.asyncFetchSubFoldersForItem=function(e){var n,s,r=e.key,o=e===t.state.tree.rootItem;o&&t.setState({showLoadingScreen:!0});var i=m.browseStore.context();i.isNonUserRelativeContext?(s="/browse_util/tree_view_team_folder_contents",n={ns_id:i.rootNSID,ns_path:r,hide_tmfs:!0}):(s="/browse_util/tree_view_folders",n={folder:r}),t._pendingAjaxRequest&&t._pendingAjaxRequest.abort(),t._pendingAjaxRequest=d.WebRequestOref({url:s,type:"POST",subject_user:t.props.user.id,data:n,success:function(n){var s=t.parseFolderList(n),r=t.state.tree.setChildItems(e,s);t.setState({tree:r})},error:function(){y.error(g._("An error occurred while trying to load your folder."))},complete:function(){null!=t._pendingAjaxRequest&&(t._pendingAjaxRequest=null,o&&t.setState({showLoadingScreen:!1}))}})},t.handleItemSelected=function(e){t.props.onFolderSelected(e.key)},t.handleExpandButtonClick=function(e,n){n&&!t.state.tree.isParent(e)&&t.asyncFetchSubFoldersForItem(e)},t.renderLoadingMessage=function(){return o.createElement("span",{className:"tree-view__loading-label"},g._("Loading your folders…"))},t}return n.__extends(s,e),s.prototype.componentWillMount=function(){if(!this.state.tree){var e=this.constructRootItem();this.setState({tree:S.createWithRootItem(e)})}},s.prototype.componentDidMount=function(){this.asyncFetchSubFoldersForItem(this.state.tree.rootItem)},s.prototype.componentWillUnmount=function(){this._pendingAjaxRequest&&(this._pendingAjaxRequest.abort(),this._pendingAjaxRequest=null)},s.prototype.constructRootItem=function(){var e,t=this.props.treeRootName||f.get_role_title(this.props.user)||g._("Dropbox");return e=f.get_viewer().is_paired?this.props.user.is_team?"s_briefcase":"s_house":"dropbox",new b({key:this.props.rootPath,icon:e,label:t})},s.prototype.parseFolderList=function(e){return JSON.parse(e).map(function(e){return new b({key:e.path,label:p.filename(e.path),canExpand:e.has_subdirs,icon:e.icon,disabled:e.read_only})})},s.prototype.render=function(){var e=this.props.isRootSelectable?v.HeaderItem:v.StaticHeader;return o.createElement(t.TreeView,{tree:this.state.tree,rootStyle:e,onItemSelected:this.handleItemSelected,onItemExpanded:this.handleExpandButtonClick},this.state.showLoadingScreen?this.renderLoadingMessage():void 0)},s})(o.Component);N.defaultProps={rootPath:"/",onFolderSelected:function(e){},isRootSelectable:!1,treeRootName:null},t.FolderTreeView=N}),define("modules/clean/sharing/actions/share_modal",["require","exports","tslib","jquery","external/react","external/react-dom","modules/clean/ajax","modules/clean/analytics","modules/clean/api_v2/error","modules/clean/browse_interface","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/react/browse/nav_actions","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/file_viewer/store","modules/clean/react/modal","modules/clean/react/pass/actions","modules/clean/react/pass/constants","modules/clean/react/pass/data_helpers","modules/clean/react/pass/store","modules/clean/react_format","modules/clean/sharing/action_types","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api","modules/clean/sharing/api/types/metadata","modules/clean/sharing/api/util/types","modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal","modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal","modules/clean/sharing/confirmation_modals/simple_confirm_modal","modules/clean/sharing/constants","modules/clean/sharing/link_settings_modal","modules/clean/sharing/parent_folder_access_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/stores/sharing_info_util","modules/clean/sharing/ui_util","modules/clean/stormcrow/stormcrow_exposure_logger","modules/clean/teams/membership_discovery_util","modules/clean/teams/modals/create_team_prompt_modal","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/zendesk_feedback","modules/constants/teams","modules/core/browser","modules/core/i18n","modules/core/notify","modules/clean/react/snackbar"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I,E,C,N,M,T,A,P,k,x,F,L,R,D,O,U,B,q,H,V,G,W,K,Y,z){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var j=r.createElement,Q=K.i18n_default_project("sharing")._,Z=(function(){function t(t,s,o){var i=this;this.groupSeenStateInfo=null,this.presentAccountIds=null,this.hasLoggedSet={},this.changeAccess=function(e,t,n){void 0===n&&(n=!1);var s=Promise.resolve({}),o=e.memberId(),a=i.getContentInfo(),l=a.id,d=h.browseStore.context().isNonUserRelativeContext;if(t===k.MEMBER_ACTION.REMOVE)o!==i.user.account_id||d?(s=(a.isFileFolder()?i.client.getParentFolderAccess({contentId:i.sharingInfo.parentSharedFolderId(),memberId:o}):i.removeMember(l,e,n,a.isFolder())).then(function(t){i.showParentFolderAccessModalIfQualified("remove",e,t)}),i.openShareModal()):i.client.relinquishMembership({contentId:l,leaveACopy:n}).then(function(){a.isFolder()?O.sharingNotificationSuccess(Q("Folder access removed.")):O.sharingNotificationSuccess(Q("File access removed.")),g.Modal.close(),i.redirectToBrowseUrl("/")});else if(t===k.ACCESS_LEVEL.OWNER)s=i.client.transferContent({contentId:l,memberId:o}).then(function(){i.dispatch(I.ShareModalActionTypes.TRANSFER_OWNER_SUCCESS),O.sharingNotificationSuccess(Q("Made %(name)s the owner").format({name:e.displayName()})),i.fetchInitialData(),i.openShareModal()});else{var c=void 0;if(a.isFileFolder()&&t===k.ACCESS_LEVEL.READER)c=i.client.getParentFolderAccess({contentId:i.sharingInfo.parentSharedFolderId(),memberId:o,accessLevel:t});else{var p=i.getContentInfo().isFileFolder();p&&i.dispatch(I.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:e});var u=Date.now();c=i.shareIfFileFolder(w.reactFormat(Q("Sharing <st>%(folder_name)s</st>..."),{st:r.createElement("strong",null),folder_name:a.name()})).then(function(){return k.SHARING_UNSHARING.SNACKBAR_MESSAGES&&z.Snackbar.complete(w.reactFormat(Q("Shared <st>%(folder_name)s</st>."),{st:r.createElement("strong",null),folder_name:a.name()})),p&&i.dispatch(I.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e}),i.changeMemberAccess(i.getContentInfo().id,e,t)}).catch(function(t){k.SHARING_UNSHARING.SNACKBAR_MESSAGES&&i.reportShareFailure(t,u),p&&i.dispatch(I.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e})})}s=c.then(function(t){i.showParentFolderAccessModalIfQualified("update",e,t)})}return s.then(i.refreshSharedWithColumnContentData)},this.changeLinkAudience=function(e){var t=new N.CombinedPolicy({audience:e}),n=Date.now();if(i.getContentInfo().isFileFolder())return i.shareIfFileFolder(w.reactFormat(Q("Changing link settings for <st>%(folder_name)s</st>..."),{st:r.createElement("strong",null),folder_name:i.getContentInfo().name()}),t).then(function(){k.SHARING_UNSHARING.SNACKBAR_MESSAGES&&z.Snackbar.complete(w.reactFormat(Q("Changed link settings for <st>%(folder_name)s</st>."),{st:r.createElement("strong",null),folder_name:i.getContentInfo().name()}))}).catch(function(e){return k.SHARING_UNSHARING.SNACKBAR_MESSAGES&&i.reportShareFailure(e,n),Promise.reject(e)});var s=i.sharingInfo.linkMetadata(),o=s&&s.current_audience||N.LinkAudience.members;i.dispatch(I.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_REQUEST,{newAudience:e});var a,d;return i.getContentInfo().isFile()?(a=k.ALPHA_FILE_METADATA_PERMISSIONS,d=i.client.updatePolicy.bind(i.client)):(a=k.ALPHA_FOLDER_METADATA_PERMISSIONS,d=i.client.updatePolicyAlpha.bind(i.client)),d({actions:Object.keys(a),contentId:i.getContentInfo().id,newPolicy:t}).then(function(e){i.dispatch(I.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_SUCCESS,{metadata:e})}).catch(l.catchApiError(function(){return i.dispatch(I.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_FAILURE,{prevAudience:o}),Promise.reject({})}))},this.changeRecipientAccess=function(e){i.dispatch(I.ShareModalActionTypes.CHANGE_RECIPIENT_ACCESS,{newAccess:e})},this.changeRecipientMessage=function(e){i.dispatch(I.ShareModalActionTypes.CHANGE_RECIPIENT_MESSAGE,{message:e})},this.createSharedLink=function(){return i.log("CLICK_TIB_CREATE_LINK"),i.dispatch(I.ShareModalActionTypes.CREATE_LINK_REQUEST),i.client.createSharedLink({fileIdOrPath:i.getContentInfo().displayPath()}).then(function(e){i.dispatch(I.ShareModalActionTypes.CREATE_LINK_SUCCESS,{linkMetadata:e}),i.refreshSharedWithColumnLinkData()}).catch(l.catchApiError(function(e){return e instanceof l.AppError&&e.error&&"access_denied"===e.error[".tag"]&&(i.getContentInfo().isFolder()?O.sharingNotificationError(Q("You don’t have permission to create a link to this folder")):O.sharingNotificationError(Q("You don’t have permission to create a link to this file"))),i.dispatch(I.ShareModalActionTypes.CREATE_LINK_FAILURE),Promise.reject(e)}))},this.fetchMetadataForFile=function(e){return E.SharingActions.loadFileMetadata({user:i.user,contentId:e.id,sourceUrl:e.url(),client:i.client}).catch(l.catchApiError(i.handleLoadingError))},this.fetchMetadataForFileFolder=function(e){var t,s,r=k.MEMBER_ACTION.ALL,o=i.user.is_cdm_member?k.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE:k.VALIDATE_PATH_PERMISSIONS,a={actions:Object.keys(o),listMembersArg:{actions:r},shouldParseMetadataFromError:!0};return h.browseStore.context().isNonUserRelativeContext&&!i.user.is_cdm_member?(t=function(e){var t=_.validateFolderPath(e);return i.client.validatePathContinue(t,!1)},s={nsId:e.nsId(),nsPath:e.nsPath()}):(t=i.client.validateFqPath,s={fqPath:e.displayPath(),shareAsConfidential:i.sharingInfo.shareAsConfidential()}),t(n.__assign({},s,a)).then(function(e){var t=e.metadata,n=e.inheritedMembers;i.handleGetMetadataSuccess(t);var s=i.getContentInfo();i.listMembers(s.id,s.url(),s.isFileFolder()&&n||void 0)}).catch(l.catchApiError(i.handleLoadingError))},this.fetchMetadataForSharedFolder=function(e){return i.client.getMetadata({contentId:e.id,actions:Object.keys(k.ALPHA_FOLDER_METADATA_PERMISSIONS)}).then(i.handleGetMetadataSuccess).catch(l.catchApiError(i.handleLoadingError))},this.handleMemberAccessChange=function(e,t){var n=e.displayName();if(t===k.MEMBER_ACTION.REMOVE||t===k.ACCESS_LEVEL.OWNER){
var s=t===k.MEMBER_ACTION.REMOVE&&e.memberId()===i.user.account_id,r=i.getContentInfo().isFolder(),o=i.getContentInfo().isNestedSharedFolder(),a=e.permissions.leave_a_copy&&e.permissions.leave_a_copy.allow,l=function(n){i.changeAccess(e,t,n===!0)},d=i.openShareModal;s?A.showRelinquishMembershipConfirmationModal(r,o,l,d,a):T.showMemberAccessChangeConfirmationModal(n,t,r,o,a,l,d)}else i.changeAccess(e,t)},this.handleGetMetadataSuccess=function(e){i.dispatch(I.ShareModalActionTypes.FETCH_METADATA_SUCCESS,{metadata:e}),p.dispatch({type:L.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:i.user})},this.handleLinkSettingsClick=function(){var e=function(){i.refreshSharedWithColumnLinkData(),i.setLinkMetadata(void 0),i.openShareModal()},t=i.sharingInfo.getInitialProps().onDeleteLink||e,n=function(e){i.setLinkMetadata(e),i.refreshSharedWithColumnLinkData()},s=x.showUpgradeToBizBanner(i.user);a.TeamsWebActionsLogger.log("open_link_settings_modal"),g.Modal.showInstance(r.createElement(x.SharedLinkSettingsModal,{client:i.client,isFile:i.getContentInfo().isFile(),linkMetadata:i.sharingInfo.linkMetadata(),onClose:i.openShareModal,onDeleteLink:t,onPolicySet:n,showUpgradeToBiz:s,isTeam:i.user.is_team}))},this.handleLoadingError=function(e){e instanceof l.AppError?("not_a_member"===e.error[".tag"]||"no_access"===e.error[".tag"]?(O.sharingNotificationError(Q("You don’t have permission to share this folder")),g.Modal.close()):"invalid_id"===e.error[".tag"]&&(O.sharingNotificationError(Q("This folder can’t be shared")),g.Modal.close()),i.dispatch(I.ShareModalActionTypes.FETCH_METADATA_FAILURE,{reason:e.error&&e.error.bad_path&&e.error.bad_path[".tag"]})):(O.sharingNotificationError(e.message||Q("There was a problem completing this request.")),g.Modal.close())},this.handleSelectLinkAudience=function(e){if(i.sharingInfo.contentInfo().isFile())return i.changeLinkAudience(e);var t=i.sharingInfo.linkMetadata(),n=t&&t.current_audience||N.LinkAudience.members,s=t.audience_options.toArray().indexOf(n),o=t.audience_options.toArray().indexOf(e);if(o<s){var a="";if(e===N.LinkAudience.public)a=Q("All items in this folder will become viewable by anyone with the link.");else{if(e!==N.LinkAudience.team)throw"audience type not supported: %(newAudience)s".format({newAudience:e});a=Q("All items in this folder will become viewable by anyone on your team.")}g.Modal.showInstance(r.createElement(P.SimpleConfirmModal,{title:Q("Change link audience?"),confirmText:Q("Change audience"),onConfirm:function(){i.changeLinkAudience(e),i.openShareModal()},onCancel:i.openShareModal},a))}else if(o>s)return i.changeLinkAudience(e)},this.handleSetConfidential=function(e){var t=i.getContentInfo(),n=t.isSharedFolder()?t.sharedFolderId().toString():void 0;return n?i.client.setConfidentiality({contentId:n,confidential:e}):i.client.share({fqPath:t.displayPath(),confidential:e})},this.openShareModal=function(){g.Modal.showInstance(j(i.shareModalClass,{actionHandler:i}))},this.recipientsChange=function(e,t){return void 0===t&&(t=""),Promise.resolve({}).then(function(){i.dispatch(I.ShareModalActionTypes.CHANGE_RECIPIENTS,{recipientTokens:e,recipientRawInput:t})})},this.redirectToPath=function(t,n){if(!h.browseStore.user()){var s=d.browse_uri_for_fq_path(i.user,t);return n&&s.updateQuery({shareoptions:"1"}),void W.redirect(s.toString())}var r=function(){n&&e(["modules/clean/sharing/share_modal_util"],function(e){(0,e.showShareModal)(i.user,h.browseStore.context(),{origin:"PARENT_FOLDER_MODAL"})})};t!==h.browseStore.context().currentFQPath?(m.browseNavActions.setUrl({path:t}),m.browseNavActions.setPath({path:t,onPathLoaded:r})):r()},this.refreshSharedWithColumnContentData=function(){i.getContentInfo().isFolder()?p.dispatch({type:u.SharedWithActionTypes.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{}}):p.dispatch({type:u.SharedWithActionTypes.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[i.getContentInfo().id]}})},this.handleShareClick=function(e,t){return i.sharingInfo.contentInfo().pathExists()?i.sendShare(e):Promise.resolve().then(function(){i.setContentNameAndSendShare(e,t)})},this.sharingProgressSnackbar=function(e){var t=function(){z.Snackbar.warn(Q("Sharing is taking a while. We’ll let you know when it’s done."))};z.Snackbar.show(r.createElement(z.Snackbar,{onTimeout:t,syncProgressLoop:!0,title:e,timeoutDelayMs:k.SHARING_UNSHARING.TRANSITION_MS,variant:"sync"}))},this.tooManyFilesSnackbar=function(){var e=function(){W.open_tab("/help/files-folders/share-with-others#foldersize")};z.Snackbar.show(r.createElement(z.Snackbar,{actionButtonText:Q("Learn more"),closeButtonText:Q("Close"),onActionClick:e,title:Q("Sharing unsuccessful. This folder has too many files."),variant:"fail"}))},this.shareIfFileFolder=function(e,t){if(k.SHARING_UNSHARING.SNACKBAR_MESSAGES&&i.sharingProgressSnackbar(e),!i.getContentInfo().isFileFolder())return Promise.resolve({});if(i.sharingInfo.shareFolderPromise())return i.sharingInfo.shareFolderPromise();var n;if(n=i.sharingInfo.isNonUserRelativeContext()&&!i.user.is_cdm_member?"ns:"+i.getContentInfo().nsId()+i.getContentInfo().nsPath():i.getContentInfo().displayPath(),k.TRUELINK.TRUELINK_UI[i.user.id]){var s=i.sharingInfo.linkMetadata();s&&s.current_audience!==N.LinkAudience.members&&(t||(t=new N.CombinedPolicy),t.audience||(t=t.set("audience",s.current_audience)))}var r={fqPath:n,folderPolicy:t,confidential:!1};i.sharingInfo.shareAsConfidential()&&(r.confidential=!0);var o=i.client.share(r);return i.dispatch(I.ShareModalActionTypes.SHARE_FOLDER_REQUEST,{promise:o}),o.then(function(e){return i.dispatch(I.ShareModalActionTypes.SHARE_FOLDER_SUCCESS,{metadata:e}),p.dispatch({type:L.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:i.user}),e}).catch(function(e){return i.dispatch(I.ShareModalActionTypes.SHARE_FOLDER_FAILURE),Promise.reject(e)})},this.reportShareFailure=function(e,t){Date.now()-t>k.SHARING_UNSHARING.TRANSITION_MS&&e instanceof l.ServerError?i.tooManyFilesSnackbar():z.Snackbar.fail(O.convertIfHTML(O.genAddMemberErrorMessage(e)))},this.showParentFolderAccessModalIfQualified=function(e,t,n){null!=n&&g.Modal.showInstance(r.createElement(F.ParentFolderAccessModal,{contentInfo:i.getContentInfo(),memberAccessLevelResult:n,memberDisplayName:t.displayName(),originalAction:e,isInContentManager:i.sharingInfo.isNonUserRelativeContext(),onClose:i.openShareModal,onParentFolderClicked:i.redirectToPath}))},this.parseParentFolderAccessError=function(e){var t=e.error;if("member_error"===e.error[".tag"]&&(t=e.error.member_error),"no_explicit_access"===t[".tag"])return M.memberAccessLevelApiToRecord(i.user.id,t);O.sharingNotificationError(e.message||Q("There was a problem completing this request."))},this.turnLinkOnIfQualified=function(){var e=i.sharingInfo.linkMetadata();return!k.TRUELINK.TRUELINK_UI[i.user.id]||!k.TRUELINK.BROAD_AUDIENCE[i.user.id]||i.sharingInfo.parentSharedFolderId()||e&&e.current_audience!==N.LinkAudience.members?Promise.resolve({}):i.waitForAllMembersLoaded().then(function(){if(!i.sharingInfo.hasNonOwnerMembers())return i.changeLinkAudience(N.LinkAudience.default_on)})},this.updateLinkSettings=function(){},this.waitForAllMembersLoaded=function(){if(i.sharingInfo.areMembersFullyLoaded())return Promise.resolve({});var e=i.sharingInfo.fetchingMembersRequest();return e&&e.promise||Promise.resolve({})},this.client=t,this.user=s,this.shareModalClass=o}return t.prototype.initializeShareModal=function(e,t){void 0===t&&(t={});var n=e.contentInfo;return p.dispatch({type:I.ShareModalActionTypes.SHARE_MODAL_OPEN,data:{shareModalInfo:e,initialProps:t},contentIds:D.getContentIdsForContentInfo(n),user:this.user}),this.sharingInfo=R.sharingInfoStore.getSharingInfo(this.user.id,n.id),this.fetchInitialData()},t.prototype.fetchInitialData=function(){var e=this.sharingInfo.contentInfo(),t=this.sharingInfo.isNonUserRelativeContext();this.beginTime=Date.now(),this.fetchPassInfo(),this.fetchUpsellExperimentVariant();var n=[];return e.isFileFolder()?n.push(this.fetchMetadataForFileFolder(e)):(n.push(this.listMembers(e.id,e.url())),e.isFile()?n.push(this.fetchMetadataForFile(e)):e.isSharedFolder()&&n.push(this.fetchMetadataForSharedFolder(e))),n.push(this.fetchMemberCounts()),k.TRUELINK.TRUELINK_UI[this.user.id]?(this.sharingInfo.isTeamPolicyLoaded()||n.push(this.fetchTeamPolicy()),this.sharingInfo.areSharingPrefsLoaded()||n.push(this.fetchSharingPrefs())):(n.push(this.fetchTeamPolicy()),n.push(this.fetchSharingPrefs()),this.sharingInfo.canShareLink()&&!t&&e.isMounted()&&n.push(this.fetchLinkMetadata())),Promise.all(n)},t.prototype.fetchPassInfo=function(){var e=this;this.sharingInfo.shouldBlockMemberListOnPassLoad()&&setTimeout(function(){return e.dispatch(I.ShareModalActionTypes.UNBLOCK_MEMBER_LIST_ON_PASS_LOAD)},4e3);var t=this.getPassFileInfo(),n=t.nsId,s=t.sjid;if(t.fromBrowse){var r=S.passFetchingStatus(n,s);v.fetchingStatusIsSuccessful(r)?(this.groupSeenStateInfo=S.getLinkAndGroupInfo(n,s)[1],this.presentAccountIds=S.presence(n,s)):r||b.PassHelpers.setup({user:this.user,fileData:this.getFileData(),prevFileData:null,shouldWritePresence:!1})}},t.prototype.getSharingInfo=function(){return this.sharingInfo},t.prototype.clearCachedPassInfo=function(){e=[null,null],this.groupSeenStateInfo=e[0],this.presentAccountIds=e[1];var e},t.prototype.getPassInfo=function(){var e=this.getContentInfo();if(e.isFolder())return[{},[],v.PASS_FETCHING_STATUS.ERROR];if(this.groupSeenStateInfo&&this.presentAccountIds)return[this.groupSeenStateInfo,this.presentAccountIds,v.PASS_FETCHING_STATUS.PASS_SUCCESS];var t=this.getPassFileInfo(),n=t.nsId,s=t.sjid;if(!n||!s)return l=[{},[]],this.groupSeenStateInfo=l[0],this.presentAccountIds=l[1],[{},[],v.PASS_FETCHING_STATUS.ERROR];var r=S.getPassPermissions(e.id);if(S.isPassPermissionsPending(e.id)||null==r)return[{},[],v.PASS_FETCHING_STATUS.FETCHING];if(null!=r&&!r.canShowPresence)return[{},[],v.PASS_FETCHING_STATUS.ERROR];var o=S.passFetchingStatus(n,s);if(v.fetchingStatusIsSuccessful(o)){var i=S.getLinkAndGroupInfo(n,s),a=S.presence(n,s);return this.groupSeenStateInfo=i[1],this.presentAccountIds=a?a.slice():[],this.isContentInfoForFilePreview(e)&&this.presentAccountIds.indexOf(this.user.account_id)<0&&this.presentAccountIds.push(this.user.account_id),[this.groupSeenStateInfo,this.presentAccountIds,o]}return[{},[],o];var l},t.prototype.getPassFileInfo=function(){var e,t,n,s=this.getContentInfo(),r=!s.isFolder()&&["BROWSE_FILE_ACTIONS","BROWSE_FILE_FACEPILE","BROWSE_FILE_ROW"].indexOf(s.extras.origin)>=0,o=["BROWSE_FILE_ACTIONS","BROWSE_FILE_FACEPILE","BROWSE_FILE_ROW","PREVIEW_PAGE","PREVIEW_PAGE_FACEPILE"].indexOf(s.extras.origin)>=0;return o&&!s.isSharedFolder()?(e=s.nsId(),t=s.sjid(),n=s.beaconContext()):(i=[null,null,null],e=i[0],t=i[1],n=i[2]),{nsId:e,sjid:t,beaconContext:n,fromBrowse:r,contentInfoId:s.id};var i},t.prototype.getUrl=function(){return this.getPassFileInfo().fromBrowse?void 0:f.FileViewerStore.instance.getSharedLinkInfo()&&f.FileViewerStore.instance.getSharedLinkInfo().url},t.prototype.getFileData=function(e){var t=this.getPassFileInfo();return{file:{ns_id:t.nsId,sjid:t.sjid,beacon_context:t.beaconContext,file_id:t.contentInfoId},url:e}},t.prototype.getContentInfo=function(){return this.sharingInfo.contentInfo()},t.prototype.dispatch=function(e,t){void 0===t&&(t={}),p.dispatch({type:e,data:t,contentIds:[this.getContentInfo().id],user:this.user})},t.prototype.changeMemberAccess=function(e,t,n){var s=this,r=t.access_type;return this.dispatch(I.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_REQUEST,{member:t,newAccess:n}),this.client.updateMember({contentId:e,memberId:t.memberId(),accessLevel:n}).then(function(e){if(e.access_level&&e.warning)return s.dispatch(I.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:e.access_level}),e}).catch(l.catchApiError(function(e){return s.dispatch(I.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:r}),s.parseParentFolderAccessError(e)}))},t.prototype.fetchLinkMetadata=function(){var e=this;return"/"===this.getContentInfo().displayPath()||k.TRUELINK.TRUELINK_UI[this.user.id]?Promise.resolve({}):(this.dispatch(I.ShareModalActionTypes.FETCH_LINK_METADATA_REQUEST),this.client.sharedLinkInfo({fileIdOrPath:this.getContentInfo().idForLink()}).then(function(t){e.dispatch(I.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{linkMetadata:t})}).catch(function(){e.dispatch(I.ShareModalActionTypes.FETCH_LINK_METADATA_FAILURE),h.browseStore.context().isNonUserRelativeContext||(O.sharingNotificationError(Q("There was a problem completing this request.")),g.Modal.close())}))},t.prototype.fetchMemberCounts=function(){var e=this,t=this.getContentInfo();return this.dispatch(I.ShareModalActionTypes.FETCH_MEMBER_COUNTS_REQUEST),t.isSharedFolder()||t.isFolder()&&t.isInSharedFolder()?this.client.getMemberCounts({contentId:t.isSharedFolder()?t.sharedFolderId():t.nsId()}).then(function(t){e.dispatch(I.ShareModalActionTypes.FETCH_MEMBER_COUNTS_SUCCESS,{memberCounts:t})}):Promise.resolve({})},t.prototype.fetchSharingPrefs=function(){var e=this;return this.dispatch(I.ShareModalActionTypes.FETCH_SHARING_PREFS_REQUEST),this.client.getSharingPrefs().then(function(t){e.dispatch(I.ShareModalActionTypes.FETCH_SHARING_PREFS_SUCCESS,{sharingPrefs:t})})},t.prototype.logBizTeamsManageAccessInviteVariant=function(e){(new U.StormcrowExposureLogger).logExposure("subgrowth_biz_teams_manage_access_invite",e)},t.prototype.fetchUpsellExperimentVariant=function(){var e=this;i.SilentBackgroundRequest({url:"/get_sl_upsell_variant",data:{_subject_uid:this.user.id},success:function(t){var n=JSON.parse(t);n&&n.variant&&e.dispatch(I.ShareModalActionTypes.FETCH_UPSELL_EXPERIMENT_VARIANT,n)}})},t.prototype.onShareModalUnmount=function(e){this.teardownPass();var t=e&&e.serializeInputData()||{};this.dispatch(I.ShareModalActionTypes.SHARE_MODAL_CLOSE,t)},t.prototype.fetchTeamPolicy=function(){var e=this;return this.dispatch(I.ShareModalActionTypes.FETCH_TEAM_POLICY_REQUEST),this.client.getCurrentAccountCached().then(function(t){e.dispatch(I.ShareModalActionTypes.FETCH_TEAM_POLICY_SUCCESS,{teamPolicy:t.team&&t.team.sharing_policies})})},t.prototype.getSuggestableUsers=function(t){var n=this;B.filterSuggestableUsers(t,function(t){var s=t.contacts,o=t.is_admin,i=n.getContentInfo().id;s.length>0?e(["modules/clean/teams/membership_suggestion_modal"],function(e){var t=e.MembershipSuggestionModal;g.Modal.showInstance(r.createElement(t,{isAdmin:o,isFile:n.sharingInfo.contentInfo().isFile(),contacts:s,nsId:i,accessLevel:n.sharingInfo.recipientAccess()}))}):g.Modal.close()},function(){return g.Modal.close()})},t.prototype.handleContentNameChange=function(e){var t="SIMPLIFIED_WIZARD_UI::CONTENT_NAME_CHANGE";this.hasLoggedSet[t]||(this.sharingExperimentsLog(t),this.hasLoggedSet[t]=!0),this.dispatch(I.ShareModalActionTypes.HANDLE_CONTENT_NAME_CHANGE,{name:e})},t.prototype.handleContentNameFocusChange=function(e){this.dispatch(I.ShareModalActionTypes.HANDLE_CONTENT_NAME_FOCUS_CHANGE,{focus:e})},t.prototype.handleUpdateFilePolicy=function(e,t){this.handleUpdateSharingSettings(e);var n=this.getSharingInfo().filePolicy(),s=this.getPassFileInfo(),r=s.nsId,o=s.sjid,i=s.fromBrowse,a=s.contentInfoId;if(null!=r&&null!=o)if(n.viewer_info_policy===N.ViewerInfoPolicy.disabled&&t.viewer_info_policy===N.ViewerInfoPolicy.enabled)this.clearCachedPassInfo(),y.PassActions.resetPassInfo(r,o),y.PassActions.fetchPassError(r,o),this.dispatch(I.ShareModalActionTypes.CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO);else{var l=n.audience===N.LinkAudience.members!=(t.audience===N.LinkAudience.members),d=n.viewer_info_policy===N.ViewerInfoPolicy.enabled&&t.viewer_info_policy===N.ViewerInfoPolicy.disabled;if(l||d){this.clearCachedPassInfo();var c=this.getUrl();d&&this.listMembers(a,c),b.PassHelpers.setup({user:this.user,fileData:this.getFileData(c),prevFileData:null,shouldWritePresence:!i})}}},t.prototype.handleUpdateSharingSettings=function(e){this.dispatch(I.ShareModalActionTypes.UPDATE_SHARING_SETTINGS_SUCCESS,{metadata:e})},t.prototype.listMembers=function(e,t,n){return E.SharingActions.listMembers({user:this.user,contentId:this.getContentInfo().id,isFolder:this.sharingInfo.isFolder(),url:t,members:n,client:this.client})},t.prototype.isContentInfoForFilePreview=function(e){return("PREVIEW_PAGE"===e.extras.origin||"PREVIEW_PAGE_FACEPILE"===e.extras.origin)&&!e.isFolder()},t.prototype.log=function(e,t){void 0===t&&(t={}),O.logTiburonEvent(this.getContentInfo(),this.user.id,e,t)},t.prototype.logIfHaventBefore=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!0),this.hasLoggedSet[e]||(this.hasLoggedSet[e]=!0,n&&(t.timing=Date.now()-this.beginTime),this.log(e,t))},t.prototype.onClickX=function(e){e&&e.finishLogging(!0),this.showTruelinkFeedbackIfQualified(),g.Modal.close()},t.prototype.redirectToBrowseUrl=function(e){m.browseNavActions.setUrl({path:e})},t.prototype.redirectToUpgrade=function(){W.redirect("/upgrade?oqa=spw")},t.prototype.refreshSharedWithColumnLinkData=function(){p.dispatch({type:u.SharedWithActionTypes.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.getContentInfo().displayPath()]}})},t.prototype.removeMember=function(e,t,n,s){var r=this;return this.dispatch(I.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:t}),this.client.removeMember({contentId:e,memberId:t.memberId(),leaveACopy:n}).then(function(e){return r.fetchMemberCounts().then(function(){if(e&&null!=e.access_level&&null!=e.warning)return r.dispatch(I.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS,{member:t,access:e.access_level}),e;s?O.sharingNotificationSuccess(Q("Folder access removed.")):O.sharingNotificationSuccess(Q("File access removed.")),r.dispatch(I.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS,{member:t})})}).catch(l.catchApiError(function(e){return r.dispatch(I.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:t}),r.parseParentFolderAccessError(e)}))},t.prototype.setAddMessageAsCommentChecked=function(e){this.dispatch(I.ShareModalActionTypes.SET_COMMENT_CHECKBOX_PREF_REQUEST,{checked:e}),this.client.setSharingPrefs({add_message_as_comment_checked:e})},t.prototype.setAddMessageAsCommentHelpClosed=function(){this.dispatch(I.ShareModalActionTypes.SET_COMMENT_CHECKBOX_HELP_PREF_REQUEST),this.client.setSharingPrefs({add_message_as_comment_help_shown:!1})},t.prototype.setContentNameAndSendShare=function(e,t){var n=this,r=o.findDOMNode(t),i=r&&r.value,a=c.parent_dir(this.sharingInfo.fqPath());new C.SharingApi(this.user).validate_new_sf_path(i,O.getNewFolderPathFromContentName(i,a),function(){n.dispatch(I.ShareModalActionTypes.VALIDATE_CONTENT_NAME_SUCCESS,{contentName:i}),n.sendShare(e)},function(e){n.sharingExperimentsLog("SIMPLIFIED_WIZARD_UI::INVALID_CONTENT_NAME");var t=H.extract_errors(e.responseText);n.dispatch(I.ShareModalActionTypes.VALIDATE_CONTENT_NAME_ERROR,{errorMsg:t.folder_name&&t.folder_name.message_text});var o=s(r);o&&o.select()})},t.prototype.setLinkMetadata=function(e){this.dispatch(I.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{linkMetadata:e})},t.prototype.sendShare=function(e){var t=this;this.log("CLICK_TIB_SEND_BUTTON");var n,s,o,i=Date.now(),a=this.isNewlySharedContent();return this.recipientsChange(e&&e.getContacts()).then(function(){return t.sharingInfo.contactsError().level===O.CONTACT_ERROR_LEVEL.ERROR?Promise.reject({}):(t.dispatch(I.ShareModalActionTypes.SEND_SHARE_REQUEST),n=M.contactsToMembers(t.sharingInfo.recipientTokens()),s=G.SHOW_CREATE_TEAM_MODAL_AFTER_SHARING&&a&&n.length>=2,o=t.sharingInfo.ownerTeam()&&G.SUBGROWTH_PROJECT_MAGNET,s||o||!k.SHARING_UNSHARING.SNACKBAR_MESSAGES||(t.showTruelinkFeedbackIfQualified(),g.Modal.close()),t.shareIfFileFolder(w.reactFormat(Q("Sharing <st>%(folder_name)s</st>..."),{st:r.createElement("strong",null),folder_name:t.sharingInfo.contentInfo().name()})))}).then(function(){return t.turnLinkOnIfQualified(),t.client.addMembers({accessLevel:t.sharingInfo.recipientAccess(),contentId:t.sharingInfo.contentInfo().id,addMessageAsComment:t.sharingInfo.isAddMessageAsCommentChecked(),customMessage:t.sharingInfo.recipientMessage(),members:n})}).catch(l.catchApiError(function(e){t.dispatch(I.ShareModalActionTypes.SEND_SHARE_FAILURE);var s=O.genAddMemberErrorMessage(e);return k.SHARING_UNSHARING.SNACKBAR_MESSAGES?t.reportShareFailure(e,i):Y.error(s),t.log("SHARE_MODAL_SEND_FAIL",{timing:Date.now()-i,num_recipients:n.length}),Promise.reject({})})).then(function(){if(t.dispatch(I.ShareModalActionTypes.SEND_SHARE_SUCCESS),k.SHARING_UNSHARING.SNACKBAR_MESSAGES?z.Snackbar.complete(w.reactFormat(Q("Shared <st>%(folder_name)s</st>."),{st:r.createElement("strong",null),folder_name:t.sharingInfo.contentInfo().name()})):Y.success(O.genShareSuccessMessage(t.sharingInfo.recipientTokens(),t.sharingInfo.contentInfo().name(),t.sharingInfo.isTeamSharedFolder(),t.sharingInfo.isFolderInsideTeamFolderTree())),t.log("SHARE_MODAL_SEND_SUCCESS",{timing:Date.now()-i,num_recipients:n.length}),t.sharingInfo.getInitialProps().onSuccessSharing&&t.sharingInfo.getInitialProps().onSuccessSharing(),e&&e.finishLogging(!1),t.refreshSharedWithColumnContentData(),s)g.Modal.showInstance(r.createElement(q.CreateTeamPromptModal,{invitedMembers:t.sharingInfo.recipientTokens().filter(function(e){return e.email!==t.user.email})}));else if(o){var a=t.sharingInfo.recipientTokens().map(function(e){return e.email});t.getSuggestableUsers(a)}else k.SHARING_UNSHARING.SNACKBAR_MESSAGES||(t.showTruelinkFeedbackIfQualified(),g.Modal.close())})},t.prototype.isNewlySharedContent=function(){var e=this.getContentInfo();return e.isFileFolder()||e.isFile()&&!this.sharingInfo.hasNonOwnerMembers()},t.prototype.sharingExperimentsLog=function(e,t){void 0===t&&(t={});var n=this.getContentInfo().extras.modalSessionId;t.modalSessionId=t.modalSessionId||n,a.SharingExperimentsLogger.log(this.user.id,e,t)},t.prototype.showTruelinkFeedbackIfQualified=function(){k.TRUELINK.TRUELINK_UI[this.user.id]&&(this.sharingInfo.hasChangedSharingSettings()?V.showFeedbackFlyoutIfAllowed("settings"):this.sharingInfo.hasChangedLinkAudience()&&V.showFeedbackFlyoutIfAllowed("sender"))},t.prototype.teardownPass=function(){this.clearCachedPassInfo(),this.getPassFileInfo().fromBrowse&&b.PassHelpers.teardown({user:this.user,fileData:this.getFileData(),async:!0,shouldWritePresence:!1})},t.prototype.updateBanner=function(e){this.dispatch(I.ShareModalActionTypes.UPDATE_BANNER,{banner:e})},t})();t.ShareModalActionHandler=Z}),define("modules/clean/sharing/api",["require","exports","jquery","modules/clean/ajax"],function(e,t,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.user=e}return e.prototype.get_sync_vars_for_ns_id=function(e,t,n){var s={ns_id:e,sub_path:t};this._make_request("/sharing/get_sync_vars_for_ns_id",s,n,null,!0)},e.prototype.validate_new_sf_path=function(e,t,n,s){var r={share_type:"new",folder_name:e,path:t};this._make_request("/share_ajax/validate_folder",r,n,s,!0)},e.prototype.validate_shareable_existing_sf_path=function(e,t,n){var s={share_type:"shareable_existing",path:e};this._make_request("/share_ajax/validate_folder",s,t,n,!0)},e.prototype._make_request=function(t,r,o,i,a,l){void 0===a&&(a=!1),void 0===l&&(l=!0);var d={url:t,data:r,success:function(s,i,a){o(a),n(document).trigger(e.REQUEST_SUCCEEDED_EVENT,{request_url:t,ns_id:r.ns_id||null})},error:function(e){i&&i(e)}};l&&(d.subject_user=this.user.id),a?s.FormWebRequest(d):s.WebRequest(d)},e})();r.REQUEST_SUCCEEDED_EVENT="db:sharing_api:request_succeeded",t.SharingApi=r}),define("modules/clean/sharing/components/button_group",["require","exports","tslib","external/spectrum/button","external/react","modules/clean/react/css"],function(e,t,n,s,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this;return r.createElement("div",{className:"sharing-button-group"},this.props.options.map(function(t){var n=t.value,o=t.label,i=n===e.props.value;return r.createElement(s.Button,{key:n,variant:i?"primary":"secondary",onClick:function(){return e.props.onSelectValue(n)},disabled:i},o)}))},t})(r.Component);t.ButtonGroup=o(i,["/static/css/sharing/components-vflrV8W4h.css"])}),define("modules/clean/sharing/confirmation_modals/confirm_with_option_modal",["require","exports","tslib","external/react","modules/clean/react/modal"],function(e,t,n,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(t){var n=e.call(this,t)||this;if(null==n.props.children)throw new Error("Must have children prop");return n.state={checked:!1},n.handleOptionClick=n.handleOptionClick.bind(n),n.handleAccept=n.handleAccept.bind(n),n.handleDismissCompleted=n.handleDismissCompleted.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(r.Modal,{acceptButtonText:this.props.confirmText,autoClose:this.props.autoClose,className:"simple-modal confirm-with-option-modal",dismissButtonText:this.props.cancelText,onAccept:this.handleAccept,onDismissCompleted:this.handleDismissCompleted,title:this.props.title},s.createElement("div",{className:"simple-modal-content"},s.createElement("div",{className:"confirm-with-option-modal__body-text"},this.props.children),this.renderOption()))},t.prototype.renderOption=function(){return this.props.showOption?s.createElement("div",{className:"u-mar-vertical-s confirm-with-option-modal__option"},s.createElement("input",{"aria-checked":this.state.checked,checked:this.state.checked,className:"confirm-with-option-modal__option-input",id:"confirm-with-option-modal__input",name:"confirmation_option",onClick:this.handleOptionClick,role:"checkbox",type:"checkbox"}),s.createElement("label",{className:"confirm-with-option-modal__option-label",htmlFor:"confirm-with-option-modal__input"},this.props.optionLabel)):null},t.prototype.handleOptionClick=function(){this.setState({checked:!this.state.checked})},t.prototype.handleAccept=function(){this.props.onConfirm&&this.props.onConfirm(this.state.checked)},t.prototype.handleDismissCompleted=function(){this.props.onCancel&&this.props.onCancel(this.state.checked)},t})(s.Component);t.ConfirmWithOptionModal=o}),function(){define("modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal",["external/purify","external/react","modules/clean/em_string","modules/clean/react/modal","modules/clean/react_format","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,i,a){var l,d,c,p,u,m,h,_;return c=s.Modal,h=r.reactFormat,l=o.ConfirmWithOptionModal,d=i.MEMBER_ACTION,u=t.createElement,m=t.DOM,p=a.i18n_default_project("sharing")._,_=function(e,t,s,r,o,i,a){var _,f,g,y,v;return y=n.em_snippet(e,40),g=null,t===d.REMOVE?(v=p("Remove access for %(name)s?").format({name:y}),s?(_=r?h(p("<strong>%(name)s</strong> may still have access to this folder through a company group or parent folder."),{strong:m.strong(),name:y}):h(p("If you remove <strong>%(name)s</strong>, they won’t be able to see future changes to these files."),{strong:m.strong(),name:y}),o&&(g=p("%(name)s should be able to keep a copy of these files").format({name:y}))):_=h(p("If you continue, <strong>%(name)s</strong> will lose access to this file."),{strong:m.strong(),name:y}),f=p("Remove")):(v=p("Make %(name)s the owner of this folder?").format({name:y}),_=h(p("Only <strong>%(name)s</strong> will be able to unshare this folder or change folder settings."),{strong:m.strong(),name:y}),f=p("Make owner")),c.showInstance(u(l,{autoClose:!1,confirmText:f,cancelText:p("Cancel"),onConfirm:i,onCancel:a,optionLabel:g,showOption:null!=g,title:v},_))},{showMemberAccessChangeConfirmationModal:_}})}.call(this),function(){define("modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal",["external/purify","external/react","modules/clean/react/modal","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/core/i18n"],function(e,t,n,s,r){var o,i,a,l,d;return i=n.Modal,o=s.ConfirmWithOptionModal,l=t.createElement,a=r.i18n_default_project("sharing")._,d=function(e,t,n,s,r){var d,c,p;return c=null,e?(p=a("Remove your access to this folder?"),d=a(t?"You may still have access to this folder through a company group or parent folder.":"If you continue, you won’t be able to access this folder anymore."),r&&(c=a("Keep a copy of this folder"))):(p=a("Remove your access to this file?"),d=a("If you continue, you won’t be able to access this file anymore.")),i.showInstance(l(o,{cancelText:a("Cancel"),confirmText:a("Remove my access"),onCancel:s,onConfirm:n,optionLabel:c,showOption:null!=c,title:p},d))},{showRelinquishMembershipConfirmationModal:d}})}.call(this),define("modules/clean/sharing/confirmation_modals/reset_access_modal",["require","exports","external/react","modules/clean/em_string","modules/clean/react/modal","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,i,a){"use strict";function l(e){var t,a=d("Let removed members keep a copy of these files");t=d(e.linkAccessLanguage?e.isFolder?e.isNestedSharedFolder?"The link to this folder will no longer work. Unsharing will only remove members who             don’t have access to the parent folder.":"The link to this folder will no longer work, and everyone will lose access to it.             You’ll still keep a copy of this folder in your Dropbox account.":"Everyone else will lose access to this file and its link         except those who have access from a parent folder.         You’ll still keep a copy of this file in your Dropbox.":e.isFolder?"Everyone else will lose access to this folder. You’ll         still keep a copy of this folder in your Dropbox.":"Everyone else will lose access to this file. You’ll         still keep a copy of this folder in your Dropbox.");var l=d("Unshare “%(content_name)s”?").format({content_name:s.em_snippet(e.contentName,i.SNIPPET_SIZES.FILENAME)});r.Modal.showInstance(n.createElement(o.ConfirmWithOptionModal,{cancelText:d("Cancel"),confirmText:d("Unshare"),onCancel:e.onCancel,onConfirm:e.onConfirm,optionLabel:a,showOption:e.allowLeaveACopy&&e.isFolder,title:l},t))}Object.defineProperty(t,"__esModule",{value:!0});var d=a.i18n_default_project("sharing")._;t.confirmResetAccess=l}),define("modules/clean/sharing/confirmation_modals/simple_confirm_modal",["require","exports","tslib","external/react","modules/clean/react/modal","modules/core/i18n"],function(e,t,n,s,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o.i18n_default_project("sharing")._,a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(r.Modal,{style:"bare"},s.createElement("div",{className:"simple-confirm-modal"},s.createElement("div",{className:"simple-confirm-modal__main"},s.createElement("div",{className:"simple-confirm-modal__title"},this.props.title),s.createElement("div",{className:"simple-confirm-modal__body"},this.props.children)),s.createElement("div",{className:"simple-confirm-modal__footer"},s.createElement("button",{className:"simple-confirm-modal__cancel c-btn c-btn--secondary",onClick:this.props.onCancel},this.props.cancelText||i("Cancel")),s.createElement("button",{className:"simple-confirm-modal__confirm c-btn c-btn--primary",onClick:this.props.onConfirm},this.props.confirmText))))},t})(s.Component);t.SimpleConfirmModal=a}),define("modules/clean/sharing/content_info",["require","exports","tslib","external/immutable","modules/constants/python"],function(e,t,n,s,r){"use strict";function o(e){var t=(e.isFolder?e.targetNsId:e.fileId)||e.fqPath;if(null===t)throw new Error("Not enough fields provided for extras");return t}Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){
return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.createFromParams=function(e){var n=new a(e);return new t({extras:n,id:o(n)})},t.prototype.setNsId=function(e){var t=this.setIn(["extras","targetNsId"],e);return t.set("id",o(t.extras))},t.prototype.setFQPath=function(e){var t=this.setIn(["extras","fqPath"],e);return t.set("id",o(t.extras))},t.prototype.isFolder=function(){return this.extras.isFolder},t.prototype.isFile=function(){return!this.isFolder()},t.prototype.isFileFolder=function(){return this.isFolder()&&!this.isSharedFolder()},t.prototype.isSharedFolder=function(){return Boolean(this.extras.targetNsId)},t.prototype.isTeamSharedFolder=function(){return this.extras.isTeamSharedFolder},t.prototype.isInSharedFolder=function(){return Boolean(this.extras.nsId&&this.extras.nsId!==this.extras.userHomeNs)},t.prototype.isNestedSharedFolder=function(){return this.isInSharedFolder()&&this.isSharedFolder()},t.prototype.isOSXPackage=function(){var e=this.extras.fqPath,t=e.substr(e.lastIndexOf("."));return r.PACKAGE_EXTS.indexOf(t)>=0},t.prototype.isMounted=function(){return!this.extras.url},t.prototype.url=function(){return this.extras.url},t.prototype.pathExists=function(){return Boolean(this.extras.exists)},t.prototype.name=function(){return this.displayPath()?this.displayPath().split("/").pop():this.filename()},t.prototype.idForLink=function(){var e=this.extras.fileId||this.extras.fqPath;if(!e)throw new Error("No identifiers for getting links");return e},t.prototype.sharedFolderId=function(){var e=this.extras.targetNsId;if(!e)throw new Error("No shared folder ID");return e},t.prototype.displayPath=function(){return this.extras.fqPath},t.prototype.filename=function(){return this.extras.filename},t.prototype.nsId=function(){if(!this.extras.nsId)throw new Error("Can't determine nsId");return this.extras.nsId},t.prototype.nsPath=function(){if(null===this.extras.nsPath)throw new Error("Can't determine nsPath");return this.extras.nsPath},t.prototype.sjid=function(){return this.extras.sjid},t.prototype.teamGroupInfo=function(){return this.extras&&this.extras.teamGroupInfo},t.prototype.beaconContext=function(){return this.extras&&this.extras.beaconContext},t})(s.Record({extras:null,id:null},"ContentInfo"));t.ContentInfo=i;var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(s.Record({beaconContext:null,exists:!0,fileId:null,filename:null,fqPath:null,isFolder:null,isTeamSharedFolder:!1,modalSessionId:null,nsId:null,nsPath:null,origin:null,sjid:null,targetNsId:null,url:null,userHomeNs:null,teamGroupInfo:null},"ContentInfoExtras"));t.ContentInfoExtras=a}),define("modules/clean/sharing/file_settings_modal",["require","exports","tslib","external/react","external/underscore","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/react/util","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/constants","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/settings_modal_components","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/ui_util","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=w.i18n_default_project("sharing")._,E=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleAcceptClick=function(){var e=n.getPolicyDiff();e?p.setStatePromise(n,{isSubmitting:!0}).then(function(){return n.getClient().updatePolicy({contentId:n.props.contentId,newPolicy:e,actions:Object.keys(f.ALPHA_FILE_METADATA_PERMISSIONS)})}).catch(o.catchApiError(function(){n.setState({isSubmitting:!1}),Promise.reject({})})).then(function(e){S.sharingNotificationSuccess(I("File settings updated")),n.props.onPolicySet&&n.props.onPolicySet(e)}):n.props.onPolicySet&&n.props.onPolicySet(void 0)},n.handleDismissClick=function(){d.Modal.close(),n.props.onCancel&&n.props.onCancel()},n.handleDismissCompleted=function(){n.props.onCancel&&n.props.onCancel()},n.handlePolicyUpdate=function(e,t){n.setState({desiredPolicy:n.state.desiredPolicy.set(e,t)})},n.getPolicyDiff=function(){var e={};return n.state.desiredPolicy.keySeq().toArray().map(function(t){var s=n.state.desiredPolicy.get(t),o=n.props.initialPolicy.get(t);("object"==typeof s?r.isEqual(s,o):s===o)||(e[t]=n.state.desiredPolicy.get(t))}),e},n.handleUnshareFile=function(){var e=function(){return f.SHARING_UNSHARING.SNACKBAR_MESSAGES&&c.Snackbar.sync(I("Unsharing %(file_name)s...").format({file_name:n.props.fileName}),!0),n.getClient().unshare({contentId:n.props.contentId}).then(function(){n.refreshSharedMemberData(),S.sharingNotificationSuccess(I("Unshared %(file_name)s.").format({file_name:n.props.fileName})),d.Modal.close(),f.TRUELINK.TRUELINK_UI[n.props.user.id]&&u.SharingActions.loadFileMetadata({user:n.props.user,contentId:n.props.contentId})})};_.confirmResetAccess({allowLeaveACopy:!1,contentName:n.props.fileName,isFolder:!1,isNestedSharedFolder:!1,linkAccessLanguage:f.TRUELINK.TRUELINK_UI[n.props.user.id],onConfirm:e})},n.refreshSharedMemberData=function(){a.dispatch({type:l.SharedWithActionTypes.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[n.props.contentId]}})},n.state={isSubmitting:!1,desiredPolicy:t.initialPolicy},n}return n.__extends(t,e),t.prototype.render=function(){return f.TRUELINK.TRUELINK_UI[this.props.user.id]?this.openSharingSettingsModal():s.createElement(C,{canChangeOptions:this.props.canChangeOptions,canChangeViewerInfo:this.wrapCanChangePolicy(g.VIEWER_INFO_POLICY),canUnshareFile:this.props.canUnshareFile,contentId:this.props.contentId,desiredPolicy:this.state.desiredPolicy,fileName:this.props.fileName,handleUnshareFile:this.handleUnshareFile,isSubmitting:this.state.isSubmitting,onAccept:this.handleAcceptClick,onDismiss:this.handleDismissClick,onDismissCompleted:this.handleDismissCompleted,onPolicyUpdate:this.handlePolicyUpdate,ownerTeam:this.props.ownerTeam,user:this.props.user,viewerInfoDenyReason:b.getPassDenyReason(this.props.initialPolicy,this.props.permissions)})},t.prototype.getClient=function(){return new m.FileShareApiClient({userId:this.props.user.id})},t.prototype.wrapCanChangePolicy=function(e){var t=this.props.canChangeOptions;return b.isCommonSharingSettingsPolicy(e)&&(t=b.canChangePolicy(e,this.props.initialPolicy,this.state.desiredPolicy,this.props.linkMetadata,this.props.permissions)),t},t.prototype.openSharingSettingsModal=function(){var e=this,t=function(t,n){return[e.state.desiredPolicy.get(t),e.wrapCanChangePolicy(t)]};return s.createElement(v.SharingSettingsModal,{contentId:this.props.contentId,currentPolicy:this.props.initialPolicy,fileName:this.props.fileName,folderName:this.props.fileName,getEffectivePolicyValue:t,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,isFolder:!1,isLoading:!1,isSubmitting:this.state.isSubmitting,linkMetadata:this.props.linkMetadata,onDismiss:this.handleDismissClick,onOptionChange:this.handlePolicyUpdate,onSaveSettings:this.handleAcceptClick,onUnshare:this.handleUnshareFile,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,policyUpdate:this.getPolicyDiff(),user:this.props.user})},t})(s.Component);E.displayName="FileSettingsModal",t.FileSettingsModal=E;var C=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e;return this.props.canChangeOptions&&(e=s.createElement(y.SettingsModalButtons,{disableSave:!1,isAccepting:this.props.isSubmitting,onAccept:this.props.onAccept,onDismiss:this.props.onDismiss})),s.createElement(d.Modal,{autoClose:!1,className:"file-settings-modal",buttonComponent:s.createElement("span",null),onDismissCompleted:this.props.onDismissCompleted,title:I("“%(file_name)s” settings").format({file_name:i.em_snippet(this.props.fileName,f.SNIPPET_SIZES.FILENAME)})},s.createElement("div",{className:"file-settings-form"},this.renderHeader(),this.renderPolicies(),this.renderButtons(),e))},t.prototype.renderHeader=function(){if(!this.props.canChangeOptions)return s.createElement("div",{className:"u-pad-xs u-font-center u-mar-bottom-s file-settings-form__no-permission-banner"},I("You don’t have permission to change the settings on this file."))},t.prototype.renderPolicies=function(){return s.createElement("div",null,null!=this.props.desiredPolicy.viewer_info_policy?this.renderViewerInfoPolicy():void 0)},t.prototype.renderViewerInfoPolicy=function(){var e;return e=this.props.ownerTeam?I("Show viewer info to members of %(company_name)s and people who can edit").format({company_name:this.props.ownerTeam.name}):I("Show viewer info to people who can edit"),s.createElement(y.SinglePolicyControl,{canChange:this.props.canChangeViewerInfo,denyReason:this.props.viewerInfoDenyReason,policyName:h.ViewerInfoPolicy.policy_name,policyDescription:I("Show who views this file?"),currentValue:this.props.desiredPolicy.viewer_info_policy,options:[{label:e,value:h.ViewerInfoPolicy.enabled},{label:I("Don’t show who views"),value:h.ViewerInfoPolicy.disabled}],handleOptionChange:this.props.onPolicyUpdate})},t.prototype.renderButtons=function(){var e;return this.props.canUnshareFile&&(e=s.createElement("div",{className:"u-l-fl"},s.createElement("button",{className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.handleUnshareFile},I("Unshare file")))),s.createElement("div",{className:"u-mar-top-m clearfix"},e)},t})(s.Component);C.displayName="FileSettingsModalContents",t.FileSettingsModalContents=C}),function(){define("modules/clean/sharing/folder_settings_modal",["external/classnames","external/immutable","external/purify","external/react","external/underscore","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/react/browse/store","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/react/util","modules/clean/react_format","modules/clean/sharing/actions/share_modal","modules/clean/sharing/constants","modules/clean/sharing/ui_util","modules/clean/sharing/settings_modal_components","modules/clean/sharing/share_page/action_types","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/clean/user","modules/constants/python","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I,E,C,N,M,T,A,P){var k,x,F,L,R,D,O,U,B,q,H,V,G,W,K,Y,z,j,Q,Z,X,J,$,ee,te,ne,se,re,oe,ie,ae,le,de,ce,pe,ue,me,he,_e;return ae=o.catchApiError,V=o.ServerError,oe=d.browseStore,U=p.Modal,X=p.SimpleModal,$=u.Snackbar,he=m.setStatePromise,me=h.reactFormat,W=_.ShareModalActionHandler,q=f.SHARING_UNSHARING,H=f.SNIPPET_SIZES,te=f.TRUELINK,pe=g.genContentManagerBridgeUri,_e=g.sharingNotificationError,g.sharingNotificationSuccess,G=y.SettingsModalButtons,J=y.SinglePolicyControl,K=v.SharePageActionTypes,D=b.FolderShareApiClient,ne=b.TeamSharingPolicies,k=S.CombinedPolicy,R=S.FolderPolicy,L=S.FolderPermissions,O=S.LinkMetadata,Y=S.SharedContentLinkMetadata,z=S.SharedFolderMetadata,de=w.confirmResetAccess,Z=I.SharingSettingsModal,ie=E.canChangePolicy,ue=E.isCommonSharingSettingsPolicy,ee=N.TRADEMARK_BUSINESS,le=s.createElement,ce=s.DOM,se=T.i18n_default_project("sharing")._,x={shared_folder_member_policy:"team"},F={shared_folder_member_policy:"team"},B={member_policy:"shared_folder_member_policy"},j=s.createClass({displayName:"SharedFolderSettingsModal",propTypes:{actionHandler:s.PropTypes.instanceOf(W),altAction:s.PropTypes.node,folderName:s.PropTypes.string.isRequired,folderId:s.PropTypes.string,folderPath:s.PropTypes.string,hasDisplayableMembers:s.PropTypes.bool,hasNonOwnerMembers:s.PropTypes.bool,nsId:s.PropTypes.string,nsPath:s.PropTypes.string,initialHasParentSharedFolder:s.PropTypes.bool,initialIsTeamSharedFolder:s.PropTypes.bool,initialMetadata:s.PropTypes.instanceOf(z),initialOwnerTeam:s.PropTypes.shape({id:s.PropTypes.string.isRequired,name:s.PropTypes.string.isRequired}),initialPermissions:s.PropTypes.instanceOf(L),initialPolicy:s.PropTypes.oneOfType([s.PropTypes.instanceOf(k),s.PropTypes.instanceOf(R)]),isFolderInsideTeamFolderTree:s.PropTypes.bool,isLimitedTeam:s.PropTypes.bool,isSharedFolder:s.PropTypes.bool,isUserOnOwnerTeam:s.PropTypes.bool,linkMetadata:s.PropTypes.oneOfType([s.PropTypes.instanceOf(O),s.PropTypes.instanceOf(Y)]),onCancel:s.PropTypes.func,onPolicySet:s.PropTypes.func,onUnshare:s.PropTypes.func,showContentManagerBridge:s.PropTypes.bool,showViewerInfoSettings:s.PropTypes.bool,isInContentManager:s.PropTypes.bool,teamPolicy:s.PropTypes.instanceOf(ne),updateLinkSettings:s.PropTypes.func,user:s.PropTypes.instanceOf(C).isRequired},getInitialState:function(){return{currentPolicy:this.props.initialPolicy,hasParentSharedFolder:this.props.initialHasParentSharedFolder,isLoading:!(null!=this.props.initialPolicy&&null!=this.props.initialPermissions),isPolicyChangeRecursive:this._hasRecursivePolicyChanges(this.props.initialIsTeamSharedFolder,this.props.initialHasParentSharedFolder),isSubmitting:!1,isTeamSharedFolder:this.props.initialIsTeamSharedFolder,metadata:this.props.initialMetadata,teamPolicy:this.props.teamPolicy,newPolicy:this.props.initialPolicy,ownerTeam:this.props.initialOwnerTeam,permissions:this.props.initialPermissions}},componentDidMount:function(){if(this.state.isLoading)return this._fetchInitialState()},render:function(){var e;return e={altAction:this.props.altAction,contentId:this.props.folderId,currentPolicy:this.state.currentPolicy,folderId:this.props.folderId,folderName:this.props.folderName,folderPath:this.props.folderPath,getEffectivePolicyValue:this._getEffectivePolicyValue,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,hasParentSharedFolder:this.state.hasParentSharedFolder,isFolder:!0,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isInContentManager:this.props.isInContentManager,isLimitedTeam:this.props.isLimitedTeam,isLoading:this.state.isLoading,isSharedFolder:this.props.isSharedFolder,isSubmitting:this.state.isSubmitting,isTeamSharedFolder:this.state.isTeamSharedFolder,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onDismiss:this._handleDismiss,onOptionChange:this._handleOptionChange,onSaveSettings:this._handleSaveSettings,onUnshare:this._handleUnshareFolder,ownerTeam:this.state.ownerTeam,permissions:this.state.permissions,showContentManagerBridge:this.props.showContentManagerBridge,showViewerInfoSettings:this.props.showViewerInfoSettings,shouldHideHeader:this.state.shouldHideHeader,teamPolicy:this.state.teamPolicy,policyUpdate:this._getPolicyUpdate(),user:this.props.user},te.TRUELINK_UI[this.props.user.id]?le(Z,e):le(Q,e)},_getClient:function(){var e;return e=oe.context().isNonUserRelativeContext,new D({userId:this.props.user.id,isNonUserRelativeContext:e})},_fetchFolderMetadata:function(){var e;return e=[{".tag":"change_options"},{".tag":"unshare"}],null!=this.props.folderId?this._getClient().getMetadata({contentId:this.props.folderId,actions:e}):this._getClient().validateFqPath({fqPath:this.props.folderPath,actions:e}).then(function(e){return e.metadata})},_fetchInitialState:function(){return this._fetchFolderMetadata().then((function(e){return function(t){var n,s,r,o;if(e.isMounted())return n=t.policy,s={hasParentSharedFolder:null!=t.parent_shared_folder_id,isTeamSharedFolder:t.is_team_folder,shouldHideHeader:"folder_is_limited_team_folder"===(null!=(r=t.permissions)&&null!=(o=r.change_options)?o.reason:void 0),isLoading:!1,permissions:t.permissions,newPolicy:n,ownerTeam:t.owner_team,metadata:t},null!=e.props.folderId&&(s.currentPolicy=n),s.isPolicyChangeRecursive=e._hasRecursivePolicyChanges(s.isTeamSharedFolder,s.hasParentSharedFolder),he(e,s)}})(this)).catch(ae(function(){return U.close()}))},_hasRecursivePolicyChanges:function(e,t){return e||t},_handlePolicyUpdate:function(e,t){return this.setState({newPolicy:this.state.newPolicy.set(e,t)})},_handleSaveSettings:function(){var e,t,s;if(t=this._getPolicyUpdate(),null!=t)return e=(function(e){return function(){var n;return n=e.props.onPolicySet,(e.isMounted()?he(e,{isSubmitting:!0}):Promise.resolve()).then(function(){var n,s,r,o,i,a;return a=Date.now(),r=function(e){return q.SNACKBAR_MESSAGES||A.success(se("Folder settings updated")),Promise.resolve({policyUpdate:t,sharedFolderMetadata:e})},s=function(e){return q.SNACKBAR_MESSAGES?$.complete(se("Successfully changed settings and shared folder.")):A.success(se("Folder settings updated")),Promise.resolve({policyUpdate:t,sharedFolderMetadata:e})},n=function(e){if(q.SNACKBAR_MESSAGES)return this.props.actionHandler.reportShareFailure(e,a)},null!=e.props.folderId?(o=e._getClient().updatePolicyAlpha,o({contentId:e.props.folderId,newPolicy:t,url:null!=(i=e.props.linkMetadata)?i.url:void 0}).then(r)):(t=te.TRUELINK_UI[e.props.user.id]?new k(t):new R(t),e.props.actionHandler.shareIfFileFolder(se("Changing settings and sharing folder..."),t).then(s).catch(n))}).then(function(e){var t,s;return t=e.policyUpdate,s=e.sharedFolderMetadata,"function"==typeof n?n(t,s):void 0}).catch(ae(function(t){var n;if(q.SNACKBAR_MESSAGES||A.error(null!=(n=t.user_message)?n:se("Something went wrong! Please try again.")),e.isMounted())return e.setState({isSubmitting:!1})}))}})(this),this.state.isPolicyChangeRecursive?(s=this.props,X.show({title_text:se("Save settings?"),body_html:this.state.isTeamSharedFolder?n.sanitize(se("Your changes will be applied to this team folder and any folders inside it.")):n.sanitize(se("Your changes will be applied to this folder and any folders inside it.")),confirm_text:se("Save settings"),cancel_text:se("Cancel"),autoclose:!1,confirm_callback:e,cancel_completed_callback:function(){return U.showInstance(le(j,s))}})):e()},_handleDismiss:function(){var e;return U.close(),"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_handleDismissCompleted:function(){var e;return"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_unsharingProgressSnackbar:function(e){var t,n;return t=function(){return $.warn(se("Unsharing is taking a while. We’ll let you know when it’s done."))},n=me(se("Unsharing <st>%(folder_name)s</st>..."),{st:ce.strong(),folder_name:this.props.folderName}),$.show(le($,{onTimeout:t,syncProgressLoop:!0,title:n,timeoutDelayMs:q.TRANSITION_MS,variant:"sync"}))},_tooManyFilesSnackbar:function(){var e;return e=function(){return M.open_tab("/help/files-folders/unshare-folder#foldersize")},$.show(le($,{actionButtonText:se("Learn more"),closeButtonText:se("Close"),onActionClick:e,title:se("Unsharing unsuccessful. This folder has too many files."),variant:"fail"}))},_handleUnshareFolder:function(){var e,t,n,s,r,o;if(null!=this.props.folderId&&(null!=(n=this.state.permissions)&&null!=(s=n.unshare)?s.allow:void 0))return e=(function(e){return function(t){var n,s;return s=Date.now(),q.SNACKBAR_MESSAGES&&e._unsharingProgressSnackbar(e.props.folderName),n=e._getClient().unshare({contentId:e.props.folderId,leaveACopy:t}),n.then(function(){var t;return q.SNACKBAR_MESSAGES?$.complete(me(se("Unshared <st>%(folder_name)s</st>"),{st:ce.strong(),folder_name:e.props.folderName})):A.success(se("Unshared “%(folder_name)s”").format({folder_name:e.props.folderName})),null!=(t=e.props.actionHandler)&&t.refreshSharedWithColumnContentData(),U.close(),l.dispatch({type:K.UNSHARE_FOLDER_SUCCESS,metadata:e.state.metadata,user:e.props.user})}).catch(function(t){var n;return n=Date.now(),q.SNACKBAR_MESSAGES&&n-s>q.TRANSITION_MS&&t instanceof V?e._tooManyFilesSnackbar():_e(se("There was problem while unsharing this folder. Try again later.")),l.dispatch({type:K.UNSHARE_FOLDER_ERROR,metadata:e.state.metadata,user:e.props.user})})}})(this),t=(function(e){return function(){return U.showInstance(le(j,e))}})(this.props),de({allowLeaveACopy:null!=(r=this.state.permissions)&&null!=(o=r.leave_a_copy)?o.allow:void 0,contentName:this.state.metadata.name,isFolder:!0,isNestedSharedFolder:this.props.hasParentSharedFolder,linkAccessLanguage:te.TRUELINK_UI[this.props.user.id],onCancel:t,onConfirm:e})},_getPolicyUpdate:function(){var e;return null==this.state.newPolicy&&null==this.state.currentPolicy?null:(e={},this.state.newPolicy.forEach((function(t){return function(n,s){var o,i,a,l;if(l=t._getEffectivePolicyValue(s),i=l[0],o=l[1],o&&(a="object"==typeof n?r.isEqual(n,i):n===i,!a))return e[s]=n}})(this)),e)},_handleOptionChange:function(e,t){var n;if((null!=(n=this._getPolicyUpdate())?n[e]:void 0)!==t)return"function"==typeof this._handlePolicyUpdate?this._handlePolicyUpdate(e,t):void 0},_getEffectivePolicyValue:function(e,t){var n,s,r,o,i,a;return null==t&&(t=void 0),i=B[e],null!=i&&null!=this.props.teamPolicy&&(a=this.props.teamPolicy.get(i)),s=null!=(r=null!=t?t[e]:void 0)?r:this.state.currentPolicy.get(e),n=null!=(o=this.state.permissions.change_options)?o.allow:void 0,null!=a&&x[i]===a&&(n=!1,s=F[i]),ue(e)&&(n=ie(e,this.state.currentPolicy,this.state.newPolicy,this.props.linkMetadata,this.state.permissions,this.props.showContentManagerBridge)),this.props.showContentManagerBridge&&(n=!1),[s,n]}}),re=s.createClass({displayName:"SharedFolderSettingsModalContents",propTypes:{altAction:s.PropTypes.node,currentPolicy:s.PropTypes.instanceOf(R),folderId:s.PropTypes.string,folderName:s.PropTypes.string.isRequired,folderPath:s.PropTypes.string,permissions:s.PropTypes.instanceOf(L),getEffectivePolicyValue:s.PropTypes.func,hasParentSharedFolder:s.PropTypes.bool,isLimitedTeam:s.PropTypes.bool,isLoading:s.PropTypes.bool.isRequired,isSharedFolder:s.PropTypes.bool,isSubmitting:s.PropTypes.bool,isTeamSharedFolder:s.PropTypes.bool,isUserOnOwnerTeam:s.PropTypes.bool,onDismiss:s.PropTypes.func,onSaveSettings:s.PropTypes.func,onOptionChange:s.PropTypes.func,onUnshare:s.PropTypes.func,ownerTeam:s.PropTypes.shape({id:s.PropTypes.string.isRequired,name:s.PropTypes.string.isRequired}),showContentManagerBridge:s.PropTypes.bool,showViewerInfoSettings:s.PropTypes.bool,shouldHideHeader:s.PropTypes.bool,teamPolicy:s.PropTypes.instanceOf(ne),policyUpdate:s.PropTypes.instanceOf(R)},getDefaultProps:function(){return{currentPolicy:null,folderId:null,getEffectivePolicyValue:null,hasParentSharedFolder:!1,isTeamSharedFolder:!1,onDismiss:null,onOptionChange:null,onSaveSettings:null,onUnshareFolder:null,ownerTeam:null,shouldHideHeader:!1,teamPolicy:null,policyUpdate:null}},render:function(){var t,n;return le(U,{altAction:this.props.altAction,autoClose:!1,className:e({"shared-folder-settings-modal":!0,"shared-folder-settings-modal--no-permissions":!(null!=(t=this.props.permissions)&&null!=(n=t.change_options)?n.allow:void 0)}),buttonComponent:ce.span(),onDismissCompleted:this.props.onDismiss,title:this.props.isTeamSharedFolder?se("“%(folder_name)s” team folder settings").format({folder_name:i.em_snippet(this.props.folderName,H.FILENAME)}):se("“%(folder_name)s” settings").format({folder_name:i.em_snippet(this.props.folderName,H.FILENAME)})},this.props.isLoading?ce.div({className:"shared-folder-settings-modal__loading-text"},se("Loading...")):ce.div({},this._renderHeader(),this._renderPolicies(),this._renderButtons()))},_renderHeader:function(){var t,n,s,o,i,l,d;if(!this.props.shouldHideHeader)return t={"shared-folder-settings-form__team-folder-banner":!0,"u-pad-xs":!0,"u-font-center":!0,"u-mar-bottom-s":!0},l=ce.div({},se("These settings will apply to all folders inside “%(folder_name)s”.").format({folder_name:this.props.folderName})),this.props.isInContentManager?ce.div({className:e(t)},l):this.props.showContentManagerBridge?(n=a.parent_dir(this.props.folderPath),s=a.filename(this.props.folderPath),d=pe({containingFolder:n,filenameToSelect:s,isLimitedTeam:this.props.isLimitedTeam}),ce.div({className:e(t)},l,ce.div({},se("You can change these settings in the Admin Console. "),ce.a({href:d.toString(),target:"_blank"},se("Open in new tab."))))):(this.props.isTeamSharedFolder||this.props.hasParentSharedFolder)&&this.props.isUserOnOwnerTeam?ce.div({className:e(t)},l,ce.div({},ce.a({href:"/team",target:"_blank"},se("To edit, ask your admin.")))):(null!=(o=this.props.permissions)&&null!=(i=o.change_options)?i.allow:void 0)?void 0:ce.div({className:e(r.extend(t,{"shared-folder-settings-form__team-folder-banner":!1,"shared-folder-settings-form__no-permissions-banner":!0}))},se("You don’t have permission to change the settings on this folder."))},_renderPolicies:function(){var e,t,n,s,r;return n=null!=this.props.ownerTeam,s=null!=this.props.ownerTeam&&!this.props.isLimitedTeam,r=this.props.showViewerInfoSettings&&null!=this.props.currentPolicy.viewer_info_policy,t=this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree,ce.div({},n?this._renderPolicy("member_policy",se(t?"Who can be added to folders?":"Who can be invited to this folder?"),[{label:this.props.isLimitedTeam?se("Only people on your team"):se("Only people on your %(trademark_business)s account").format({trademark_business:ee}),value:"team"},{label:se("Anyone"),value:"anyone"}]):void 0,this._renderPolicy("acl_update_policy",se(t?"Who can manage access to folders?":"Who can manage access to this folder?"),[{label:se(t?"Only Team Admins":"Only owners"),value:"owner"},{label:n?this.props.isLimitedTeam?se("Anyone on your team with edit permissions"):se("Anyone on your %(trademark_business)s account with edit permissions").format({trademark_business:ee}):se("People with edit permissions"),value:"editors"}]),s?this._renderPolicy("shared_link_policy",se(this.props.isTeamSharedFolder?"Allow members of this team folder to share links with others?":"Allow links to be shared with people outside of this folder?"),[{label:se("No"),value:"members"},{label:se("Yes"),value:"anyone"}]):void 0,r?(e=this.props.ownerTeam?se("Show viewer info to members of %(company_name)s and people who can edit").format({company_name:this.props.ownerTeam.name}):se("Show viewer info to people who can edit"),this._renderPolicy("viewer_info_policy",se("Show who views files in this folder?"),[{label:e,value:"enabled"},{label:se("Don’t show viewer info"),value:"disabled"}])):void 0)},_renderPolicy:function(e,t,n){var s,r,o;return o=this.props.getEffectivePolicyValue(e,this.props.policyUpdate),r=o[0],s=o[1],le(J,{canChange:s,policyName:e,policyDescription:t,currentValue:r,options:n,handleOptionChange:this.props.onOptionChange})},_renderButtons:function(){var e,t,n;return e=null!=(t=this.props.permissions)&&null!=(n=t.unshare)?n.allow:void 0,ce.div({className:"u-mar-top-m clearfix"},this.props.isSharedFolder&&e?ce.div({className:"u-l-fl"},ce.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.onUnshare},se(this.props.hasParentSharedFolder?"Reset membership":"Unshare folder"))):void 0,this._renderUpdateSettingsButtons())},_renderUpdateSettingsButtons:function(){var e;if(null!=(e=this.props.permissions)?e.change_options.allow:void 0)return le(G,{disableSave:null==this.props.policyUpdate,isAccepting:this.props.isSubmitting,onAccept:this.props.onSaveSettings,onDismiss:this.props.onDismiss})}}),Q=c(re,["/static/css/sharing/share_modal-vflqUEM1t.css"],[J]),{SharedFolderSettingsModal:j,SharedFolderSettingsModalContents:Q}})}.call(this),function(){define("modules/clean/sharing/link_description",["external/react","modules/clean/em_string","modules/clean/react_format","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/viewer","modules/core/i18n","modules/constants/python","modules/constants/sharing"],function(e,t,n,s,r,o,i,a,l){var d,c,p,u,m,h,_,f,g,y,v,b,S,w,I,E,C,N,M;return C=n.reactFormat,d=s.LinkAudience,c=r.SNIPPET_SIZES,p=a.TRADEMARK_BUSINESS,N=i.i18n_default_project("sharing"),u=N._,M=N.ungettext,v=e.DOM,w=function(e){return(function(){switch(e){case"public":return u("Anyone with the link");case"team_only":return u("Only people on your Dropbox team");case"password":return u("Only people with the password");case"team_and_password":return u("Only people on your Dropbox team with the password");default:throw Error("Unknown visibility option "+e)}})()},b=function(e,n,s){return null==s&&(s=null),e?(function(){switch(n){case"public":return u("Anyone with the link can comment.");case"team_only":return u("Only people on your Dropbox team can comment.");case"password":return u("Only people with the password can comment.");case"team_and_password":return u("Only people on your Dropbox team with the password can comment.");case"shared_folder_only":return u("Only members of the shared folder “%(shared_folder_name)s” can comment.").format({shared_folder_name:t.em_snippet(s,c.FILENAME)});case"only_you":return u("Only you can comment.");default:throw Error("Unknown visibility setting "+n)}})():u("No one can comment.")},I=function(e){var t,n,s,r;return t=null!=(r=null!=e?e.current_audience:void 0)?r:d.members,!(null!=e?e.url:void 0)&&t!==d.members||t===d.default_on?u("Updating link..."):(s=o.get_viewer().team_is_limited,n=(function(){if(t===d.members)return u("Only invited members can access");if(t===d.public)return u(e.password_protected?"Anyone with the link and password can view":"Anyone with the link can view");if(t===d.team)return e.password_protected?s?u("Only people on your team with the password can view"):u("Only people on your %(trademark_business)s team with the password can view").format({trademark_business:p}):s?u("Only people on your team can view"):u("Only people on your %(trademark_business)s team can view").format({trademark_business:p});throw Error("Unknown link audience "+e.current_audience)})(),e.expiry&&t!==d.members&&(n=n+" ("+E(e)+")"),n)},E=function(e,t){var n,s,r,o,i;return i=e.expiry-new Date,o=36e5,r=24*o,n=Math.floor(i/r),n<1?(s=Math.floor(i/o)+1,t?M("Expires in the next hour","Expires in the next %(num_hours)s hours",s,"sharing").format({num_hours:s}):M("link turns off in the next hour","link turns off in the next %(num_hours)s hours",s,"sharing",'comes after a phrase like: "Anyone with the link can view"').format({num_hours:s})):t?M("Expires in 1 day","Expires in %(num_days)s days",n,"sharing").format({num_days:n}):M("link turns off in 1 day","link turns off in %(num_days)s days",n,"sharing",'comes after a phrase like: "Anyone with the link can view"').format({num_days:n})},S=function(e){return e.link_permissions.allow_download===!1?h(e):m(e)},m=function(e){return null!=e.expires?g(e):_(e)},h=function(e){return null!=e.expires?y(e):f(e)},_=function(e){return(function(){if(e.isFolder())switch(e.link_permissions.resolved_visibility){case"password":return C(u("<strong>Anyone</strong> with the link and password can <strong>view</strong> this folder"),{strong:v.strong()});case"public":return C(u("<strong>Anyone</strong> with the link can <strong>view</strong> this folder"),{strong:v.strong()});case"shared_folder_only":return C(u("<strong>Members of this folder</strong> with this link can <strong>view</strong> this folder"),{strong:v.strong()});case"team_and_password":return C(u("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder"),{strong:v.strong()});case"team_only":return C(u("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder"),{strong:v.strong()});case"only_you":return C(u("<strong>Only you</strong> can <strong>view</strong> via the link."),{strong:v.strong()});default:throw Error("Unknown visibility setting")
}else switch(e.link_permissions.resolved_visibility){case"password":return C(u("<strong>Anyone</strong> with the link and password can <strong>view</strong> this file"),{strong:v.strong()});case"public":return C(u("<strong>Anyone</strong> with the link can <strong>view</strong> this file"),{strong:v.strong()});case"shared_folder_only":return C(u("<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file"),{strong:v.strong()});case"team_and_password":return C(u("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file"),{strong:v.strong()});case"team_only":return C(u("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file"),{strong:v.strong()});case"only_you":return C(u("<strong>Only you</strong> can <strong>view</strong> via the link."),{strong:v.strong()});default:throw Error("Unknown visibility setting")}})()},f=function(e){return(function(){if(e.isFolder())switch(e.link_permissions.resolved_visibility){case"password":return C(u("<strong>Anyone</strong> with the link and password can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"public":return C(u("<strong>Anyone</strong> with the link can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"shared_folder_only":return C(u("<strong>Members of this folder</strong> with this link can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"team_and_password":return C(u("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"team_only":return C(u("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder. (Downloading is turned off.)"),{strong:v.strong()});case"only_you":return C(u("<strong>Only you</strong> can <strong>view</strong> via the link. (Downloading is turned off.)"),{strong:v.strong()});default:throw Error("Unknown visibility setting")}else switch(e.link_permissions.resolved_visibility){case"password":return C(u("<strong>Anyone</strong> with the link and password can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"public":return C(u("<strong>Anyone</strong> with the link can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"shared_folder_only":return C(u("<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"team_and_password":return C(u("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"team_only":return C(u("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file. (Downloading is turned off.)"),{strong:v.strong()});case"only_you":return C(u("<strong>Only you</strong> can <strong>view</strong> via the link. (Downloading is turned off.)"),{strong:v.strong()});default:throw Error("Unknown visibility setting")}})()},g=function(e){var t,n,s;return t=null!=e.expires?(n=e.expires-new Date,n<0&&(n=0),Math.floor(n/864e5)):null,null!=(s=e.teamInfo())?s.name:void 0,(function(){if(e.isFolder())switch(e.link_permissions.resolved_visibility){case"password":return C(M("<strong>Anyone</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Anyone </strong>with the link and the password can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"public":return C(M("<strong>Anyone</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Anyone</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"shared_folder_only":return C(M("<strong>Members of this folder</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Members of this folder</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"team_and_password":return C(M("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"team_only":return C(M("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>)","<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"only_you":return C(M("<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>a day</strong>)","<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});default:throw Error("Unknown visibility setting")}else switch(e.link_permissions.resolved_visibility){case"password":return C(M("<strong>Anyone</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Anyone</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"public":return C(M("<strong>Anyone</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Anyone</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"shared_folder_only":return C(M("<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"team_and_password":return C(M("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"team_only":return C(M("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>)","<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});case"only_you":return C(M("<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>a day</strong>)","<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>%(expires_days)s days</strong>)",t),{expires_days:t,strong:v.strong()});default:throw Error("Unknown visibility setting")}})()},y=function(e){var t,n,s,r;return s=864e5,t=null!=e.expires?(n=e.expires-new Date,n<0&&(n=0),Math.floor(n/s)):null,null!=(r=e.teamInfo())?r.name:void 0,(function(){if(e.isFolder())switch(e.link_permissions.resolved_visibility){case"password":return C(M("<strong>Anyone</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"public":return C(M("<strong>Anyone</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"shared_folder_only":return C(M("<strong>Members of this folder</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Members of this folder</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"team_and_password":return C(M("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"team_only":return C(M("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this folder (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"only_you":return C(M("<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});default:throw Error("Unknown visibility setting")}else switch(e.link_permissions.resolved_visibility){case"password":return C(M("<strong>Anyone</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"public":return C(M("<strong>Anyone</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"shared_folder_only":return C(M("<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Members of the containing shared folder</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"team_and_password":return C(M("<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone on your Dropbox team</strong> with the link and the password can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"team_only":return C(M("<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Anyone on your Dropbox team</strong> with the link can <strong>view</strong> this file (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});case"only_you":return C(M("<strong>Only you</strong> can <strong>view</strong> via the link. (expires in <strong>a day</strong>). (Downloading is turned off.)","<strong>Only you<strong> can <strong>view</strong> via the link. (expires in <strong>%(expires_days)s days</strong>). (Downloading is turned off.)",t),{expires_days:t,strong:v.strong()});default:throw Error("Unknown visibility setting")}})()},{formatLinkCommentingVisibility:b,formatLinkVisibilityOption:w,formatLinkDescription:S,formatSharedContentLinkDescription:I,formatSharedContentLinkExpiry:E}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/sharing/link_settings_modal",["external/classnames","external/immutable","external/react","external/underscore","modules/clean/api_v2/types","modules/clean/datetime","modules/clean/em_string","modules/clean/filepath","modules/clean/react/bubble_menu","modules/clean/react/calendar","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/delete_link_modal","modules/clean/sharing/link_description","modules/clean/sharing/ui_util","modules/clean/static_urls","modules/clean/user","modules/clean/previews/util","modules/constants/python","modules/core/i18n"],function(t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I,E){var C,N,M,T,A,P,k,x,F,L,R,D,O,U,B,q,H,V,G,W,K,Y,z,j,Q,Z,X,J,$;return z=o.formatTimestamp,V=i.daysAfterToday,j=i.format_date,Q=i.localized_date_format,W=l.file_extension,C=d.BubbleMenu,N=d.BubbleMenuItem,M=c.Calendar,P=u.Modal,F=h.ShareApiClient,T=_.LinkMetadata,A=_.LinkPolicy,k=_.RequestedVisibilityPolicy,x=_.ResolvedVisibilityPolicy,O=_.VisibilityDisallowedReason,G=g.deleteLinkWithConfirm,K=y.formatLinkCommentingVisibility,Y=y.formatLinkVisibilityOption,Z=v.sharingNotificationError,X=v.sharingNotificationSuccess,$=b.static_url,R=I.TRADEMARK_BUSINESS,D=I.TRADEMARK_PLUS,q=s.createElement,H=s.DOM,U=E.i18n_default_project("sharing")._,B=s.createClass({displayName:"SharedLinkSettingsModal",propTypes:{client:s.PropTypes.instanceOf(F).isRequired,isFile:s.PropTypes.bool.isRequired,linkMetadata:s.PropTypes.instanceOf(T).isRequired,onClose:s.PropTypes.func,onDeleteLink:s.PropTypes.func,onPolicySet:s.PropTypes.func,showUpgradeToBiz:s.PropTypes.bool.isRequired,isTeam:s.PropTypes.bool},getInitialState:function(){var e,t,n;return t=this.props.linkMetadata.link_permissions.requested_visibility,n=this.props.linkMetadata.link_permissions.resolved_visibility,t===k.public&&n===x.team_only&&(t=k.team_only),e=A({requested_visibility:t,link_password:t===k.password?null:"",expires:this.props.linkMetadata.expires,allow_download:this.props.linkMetadata.link_permissions.allow_download}),{existingPolicy:e,isSubmitting:!1,newPolicy:e}},render:function(){var e,t;return e=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(e){return e.disallowed_reason===O.user_account_type}),t=e.length>0,q(P,{autoClose:!1,className:"shared-link-settings-modal",buttonComponent:H.span(),onDismissCompleted:this._handleDismissed,title:U("Link permissions for “%(content_name)s”").format({content_name:this.props.linkMetadata.name})},q(L,{canSubmit:!this.state.existingPolicy.equals(this.state.newPolicy),isFile:this.props.isFile,isSubmitting:this.state.isSubmitting,linkMetadata:this.props.linkMetadata,onCancel:this._dismissModal,onSubmit:this._saveSettings,onPolicyUpdate:this._handlePolicyUpdate,onDeleteLink:this._deleteLink,renderedPolicy:this.state.newPolicy,showUpgradeToBiz:this.props.showUpgradeToBiz,showUpgradeMessage:t,isTeam:this.props.isTeam}))},_handlePolicyUpdate:function(e,t){return"expires"===e&&null!=t&&(t.setHours(23),t.setMinutes(59),t.setSeconds(59)),this.setState({newPolicy:this.state.newPolicy.set(e,t)})},_getModifiedSettings:function(){var e,t;if(t=this.state.newPolicy,t.requested_visibility===k.password){if(null==t.link_password)t=t.set("requested_visibility",null);else if(""===t.link_password)return Z(U("Password can’t be empty")),null}else t=t.set("link_password",null);return e=this.props.linkMetadata.link_permissions.resolved_visibility,e===x.shared_folder_only&&(t=t.set("requested_visibility",null)),null!=t.expires&&(t=this.props.linkMetadata.link_permissions.can_set_expiry?t.set("expires",z(t.expires)):t.set("expires",null)),t.allow_download===this.state.existingPolicy.allow_download&&(t=t.set("allow_download",void 0)),{url:this.props.linkMetadata.url,settings:t,remove_expiration:null!=this.props.linkMetadata.expires&&null==this.state.newPolicy.expires}},_saveSettings:function(){var e;if(e=this._getModifiedSettings(),null!=e)return this.setState({isSubmitting:!0}),this.props.client.modifySharedLinkSettings(e).catch((function(e){return function(){return e.setState({isSubmitting:!1}),Promise.reject()}})(this)).then((function(e){return function(t){var n;return X(U("Settings saved.")),"function"==typeof(n=e.props).onPolicySet&&n.onPolicySet(t),e._dismissModal()}})(this))},_dismissModal:function(){return P.close(),this._handleDismissed()},_handleDismissed:function(){var e;return"function"==typeof(e=this.props).onClose?e.onClose():void 0},_deleteLink:function(){var e,t;return t=(function(e){return function(){var t;return"function"==typeof(t=e.props).onDeleteLink?t.onDeleteLink():void 0}})(this),e=(function(e){return function(){return P.showInstance(q(B,e))}})(this.props),G({client:this.props.client,contentName:this.props.linkMetadata.name,onCancel:e,onDeleteLink:t,url:this.props.linkMetadata.url})}}),L=s.createClass({displayName:"SharedLinkSettingsModalContents",propTypes:{canSubmit:s.PropTypes.bool.isRequired,isFile:s.PropTypes.bool.isRequired,isSubmitting:s.PropTypes.bool.isRequired,linkMetadata:s.PropTypes.instanceOf(T).isRequired,onCancel:s.PropTypes.func,onSubmit:s.PropTypes.func,onPolicyUpdate:s.PropTypes.func,onDeleteLink:s.PropTypes.func,renderedPolicy:s.PropTypes.instanceOf(A).isRequired,showUpgradeToBiz:s.PropTypes.bool.isRequired,showUpgradeMessage:s.PropTypes.bool.isRequired,isTeam:s.PropTypes.bool},getInitialState:function(){return{selectedExpiry:null!=this.props.renderedPolicy.expires?this.props.linkMetadata.link_permissions.can_set_expiry?"custom":"read-only":"no-expiry"}},render:function(){return H.div({className:"shared-link-settings-modal__contents"},this._renderHeader(),this._renderPolicies(),this._renderButtons())},_renderHeader:function(){var e,t;return this.props.showUpgradeToBiz?H.div({className:"shared-link-settings-modal__upgrade-to-biz-banner"},H.div({className:"shared-link-settings-modal__upgrade-to-biz-banner-text"},U("Did you know %(trademark_business)s lets you add passwords and expiration dates to shared links?").format({trademark_business:R})),H.div({className:"shared-link-settings-modal__upgrade-to-biz-banner-cta"},H.a({className:"c-btn c-btn--secondary shared-link-settings-modal__upgrade-to-biz-banner-cta-button",href:"/business?tk=teams&camp=sharing_link_modal",target:"_blank"},U("Learn More")))):this.props.showUpgradeMessage?(this.props.isTeam?(e="/team/upgrade",t=U("Upgrade to %(trademark_business)s to enable permission settings").format({trademark_business:R})):(e="/upgrade?oqa=sfp",t=U("Upgrade to Dropbox %(trademark_plus)s to enable permission settings.").format({trademark_plus:D})),H.div({className:"shared-link-settings-modal__upgrade-to-pro-banner"},H.a({href:e,target:"_blank"},t))):void 0},_renderPolicies:function(){return H.div({},this._renderVisibilityPolicies(),this._renderExpiryPolicy(),this._renderDownloadPolicy(),this._renderCommentsPolicy())},_renderVisibilityPolicies:function(){var e,t;return t=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(e){return e.allowed||e.disallowed_reason===O.user_account_type}),e=this.props.linkMetadata.link_permissions.visibility_policies[0].disallowed_reason,this._renderFieldset(U("Who can view this link?"),e===O.permission_denied&&0===t.length?this._renderNonPermissionVisibility():t.length<2?this._renderRestrictedBySharedFolderVisibility():t.map(this._renderVisibilityOption))},_renderNonPermissionVisibility:function(){var e;return e=this.props.linkMetadata.link_permissions.resolved_visibility,H.span({},H.span({className:"shared-link-settings-modal__visibility-text"},e===x.shared_folder_only?U("Only invited members can view this link."):Y(e))," ",H.span({className:"shared-link-settings-modal__visibility-advice u-font-meta"},U("You don’t have permission to change the visibility.")))},_renderRestrictedBySharedFolderVisibility:function(){var e,t,n;return t=this.props.linkMetadata.link_permissions.resolved_visibility,e=this.props.linkMetadata.link_permissions.visibility_policies[0].disallowed_reason,H.span({},H.span({className:"shared-link-settings-modal__visibility-text"},function(){if(t===x.shared_folder_only)return n=this.props.linkMetadata.link_permissions.restricting_shared_folder_path,n=a.em_snippet(n,f.SNIPPET_SIZES.FILENAME),U("Only members of the shared folder “%(shared_folder_name)s” can view this link.").format({shared_folder_name:n});if(t===x.only_you)return U("Only you can view this link.");throw"Unexpected visibility "+t}.call(this))," ",H.span({className:"shared-link-settings-modal__visibility-advice u-font-meta"},(function(){if(e===O.restricted_by_shared_folder)return U("To change who can access the link, go to the shared folder options.");if(e===O.delete_and_recreate)return U("To change who can access the link, delete this link and create a new one.");throw"Unexpected disallowed reason "+e})()))},_renderVisibilityOption:function(e){var n,s;return n=e.disallowed_reason===O.user_account_type,[H.label({className:t({"u-font-meta":!e.allowed}),key:"visibility-label"},H.input({checked:e.policy===this.props.renderedPolicy.requested_visibility,className:t((s={"shared-link-settings-modal__audience":!0},s["shared-link-settings-modal__audience-"+e.policy]=!0,s)),disabled:n,name:k.policy_name,onChange:(function(e){return function(t){return e.props.onPolicyUpdate(t.target.name,t.target.value)}})(this),type:"radio",value:e.policy}),this._renderVisibilityLabelText(e)),e.policy===k.password&&this.props.renderedPolicy.requested_visibility===k.password?H.div({key:"password-input"},this._renderPasswordInput(n)):void 0]},_renderVisibilityLabelText:function(e){var n;return H.span({className:t((n={"shared-link-settings-modal__audience":!0},n["shared-link-settings-modal__audience-"+e.policy+"-label"]=!0,n))},Y(e.resolved_policy))},_renderPasswordInput:function(e){var t,n;return n=null==this.props.renderedPolicy.link_password,H.div({className:"shared-link-settings-modal__password-container u-mar-left-m u-mar-right-xl u-mar-top-xs"},H.input({className:"shared-link-settings-modal__password-input c-input",disabled:e||n,name:"link_password",onChange:(function(e){return function(t){return e.props.onPolicyUpdate(t.target.name,t.target.value)}})(this),placeholder:U("Set password"),value:null!=(t=this.props.renderedPolicy.link_password)?t:"123456",type:"password"}),n&&!e?H.button({className:"shared-link-settings-modal__password-change button-as-link",onClick:(function(e){return function(){return e.props.onPolicyUpdate("link_password","")}})(this)},U("Change",{comment:"A link to change the password for the shared link"})):void 0)},_renderExpiryPolicy:function(){return this._renderFieldset(U("Add an expiry date to this link?"),H.div({},H.label({className:t({"shared-link-settings-modal__expiry-label-yes":!0,"u-font-meta":!this.props.linkMetadata.link_permissions.can_set_expiry})},H.input({checked:"no-expiry"!==this.state.selectedExpiry,className:"shared-link-settings-modal__expiry-option-yes",disabled:!this.props.linkMetadata.link_permissions.can_set_expiry,onChange:(function(e){return function(){if("no-expiry"===e.state.selectedExpiry)return e._handleExpirySelectChange(30)}})(this),type:"radio"}),this._renderYesExpiryText()),"custom"===this.state.selectedExpiry?this._renderExpiryCustom():void 0,H.label({className:t({"u-font-meta":!this.props.linkMetadata.link_permissions.can_remove_expiry})},H.input({checked:null==this.props.renderedPolicy.expires,className:"shared-link-settings-modal__expiry-option-no",disabled:!this.props.linkMetadata.link_permissions.can_remove_expiry,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate&&t.onPolicyUpdate("expires",null),e.setState({selectedExpiry:"no-expiry"})}})(this),type:"radio"}),U("No"))))},_renderYesExpiryText:function(){var e,t;if(7===(e=this.state.selectedExpiry)||30===e)return H.span({className:"shared-link-settings-modal__expiry-text-yes"},U("Yes, expires in",{comment:'Label followed by a date range e.g. "Yes, expires in 7 days"'})," ",this._renderExpirySelect());if("custom"===(t=this.state.selectedExpiry)||"read-only"===t)return H.span({className:"shared-link-settings-modal__expiry-text-yes"},U("Yes, expires on",{comment:'Label followed by a date. e.g. "Yes, expires on 5/10/2017"'})," ","read-only"===this.state.selectedExpiry?j(this.props.linkMetadata.expires,Q):void 0);if("no-expiry"===this.state.selectedExpiry)return H.span({className:"shared-link-settings-modal__expiry-text-yes"},U("Yes"));throw"Expiry policy is in an unknown state"},_renderExpirySelect:function(){var e;return q(C,{position:C.POSITIONS.BOTTOM,targetFixed:!0,items:function(){var t,n,s,r;for(s=[7,30,"custom"],r=[],t=0,n=s.length;t<n;t++)e=s[t],r.push(q(N,{onClick:(function(e){return function(t){return function(){return e._handleExpirySelectChange(t)}}})(this)(e)},this._renderExpirySelectLabel(e)));return r}.call(this),targetButton:H.button({className:"shared-link-settings-modal__selected-expiry button-as-link"},this._renderExpirySelectLabel(this.state.selectedExpiry)," ",H.img({alt:"",className:"sprite sprite_web s_web_arrow-down-gray",src:$("/static/images/icons/icon_spacer-vflN3BYt2.gif")}))})},_renderExpirySelectLabel:function(e){if(7===e)return U("7 days",{comment:'as in "This link expires in 7 days"'});if(30===e)return U("30 days",{comment:'as in "This link expires in 30 days"'});if("custom"===e)return U("Custom date...",{comment:"Dropdown option for expiry date on a link. The user can choose 7 days, 30 days, or a custom expiry"});throw"Unknown selected expiry"},_handleExpirySelectChange:function(e){var t;return this.setState({selectedExpiry:e}),"custom"===e&&(e=30),"function"==typeof(t=this.props).onPolicyUpdate?t.onPolicyUpdate("expires",V(e)):void 0},_renderExpiryCustom:function(){var e;return H.span({className:"shared-link-settings-modal__calendar-input"},q(M,{alignAtLeft:!1,onDateChange:(function(e){return function(t){var n;return"function"==typeof(n=e.props).onPolicyUpdate?n.onPolicyUpdate("expires",t):void 0}})(this),initDate:null!=(e=this.props.linkMetadata.expires)?e:V(30),firstDay:V(1),lastDay:V(365)}))},_renderDownloadPolicy:function(){var e,n,s;if(s=this.props.linkMetadata.link_permissions.can_disallow_download,n=this.props.linkMetadata.link_permissions.can_allow_download,e=this.props.linkMetadata.link_permissions.allow_download,null!=s&&null!=n&&null!=e&&(s!==!1||e!==!0))return this._renderFieldset(U("Allow people to download this?"),H.div({},H.label({className:t({"u-font-meta":!n})},H.input({checked:this.props.renderedPolicy.allow_download,className:"shared-link-settings-modal__allow-download-yes",disabled:!n,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate?t.onPolicyUpdate("allow_download",!0):void 0}})(this),type:"radio"}),U("Yes")),H.label({className:t({"u-font-meta":!s})},H.input({checked:!this.props.renderedPolicy.allow_download,className:"shared-link-settings-modal__allow-download-no",disabled:!s,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate?t.onPolicyUpdate("allow_download",!1):void 0}})(this),type:"radio"}),U("No"))),this._renderNoPreviewFileWarning())},_renderNoPreviewFileWarning:function(){var t,n,s,r;if(this.props.isFile&&(t=W(this.props.linkMetadata.name),n=t.toUpperCase(),!(null!=(null!=(r=this.props.linkMetadata)?r.preview_type:void 0)&&(s=this.props.linkMetadata.preview_type,e.call(w.VALID_PREVIEW_TYPES,s)>=0))))return this.props.renderedPolicy.allow_download===!1?H.div({className:"shared-link-settings-modal__preview-warning c-banner c-banner--warning"},H.div({className:"o-flag"},H.div({className:"o-flag-fix"},q(m,{alt:"",group:"web",name:"page_white_32"})),H.div({className:"o-flag__flex u-pad-left-xs"},U("People can’t view this %(file_extension)s file if they can’t download it.",{comment:'as in "People can’t view this .PDF file'}).format({file_extension:"."+n})))):void 0},_renderCommentsPolicy:function(){if(!this.props.linkMetadata.link_permissions.team_restricts_comments)return this._renderFieldset(U("Who can comment?"),H.div({},H.div({className:"shared-link-settings-modal__commenting-policy"},K(this.props.linkMetadata.link_permissions.allow_comments,this._getResolvedVisibility(this.props.renderedPolicy.requested_visibility),this.props.linkMetadata.link_permissions.restricting_shared_folder_path)),H.div({className:"shared-link-settings-modal__commenting-advice"},this.props.linkMetadata.link_permissions.allow_comments?H.a({href:"/help/9016#comments",target:"_blank"},U("Learn how to disable comments")):H.a({href:"/help/9016#comments",target:"_blank"},U("Learn how to enable comments")))))},_getResolvedVisibility:function(e){var t;if(t=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(t){return t.policy===e}),1!==t.length)throw"Logic error: "+t.length+" should be 1.";return t[0].resolved_policy},_renderFieldset:function(e,t,n){return null==n&&(n=null),H.fieldset({className:"settings-form-entry"},H.legend({className:"settings-form-entry__explanation u-trim-margin"},e),H.div({className:"settings-form-entry__options"},t),H.div({className:"u-mar-top-m"},n))},_renderButtons:function(){return H.div({className:"u-mar-top-m clearfix"},this.props.linkMetadata.link_permissions.can_revoke?H.div({className:"u-l-fl"},H.button({className:"button-as-link delete-link",onClick:this.props.onDeleteLink,style:{lineHeight:"32px"},type:"button"},U("Delete link"))):void 0,H.div({className:"u-l-fr"},H.button({className:"c-btn c-btn--primary confirm-button",disabled:this.props.isSubmitting||!this.props.canSubmit,onClick:this.props.onSubmit},U(this.props.isSubmitting?"Saving...":"Save settings")),H.button({className:"c-btn c-btn--secondary u-mar-left-xs cancel-button",onClick:this.props.onCancel},U("Cancel"))))}}),J=function(e){return f.SHARING_EXPERIMENTS.SHOW_UPGRADE_TO_BIZ_BANNER[e]},{SharedLinkSettingsModal:p(B,["/static/css/sharing/share_modal-vflqUEM1t.css"]),SharedLinkSettingsModalContents:L,showUpgradeToBizBanner:J}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1}
;define("modules/clean/sharing/member_avatars",["external/react","modules/clean/avatar/avatar_with_default","modules/clean/avatar/inherited_count_avatar","modules/clean/avatar/initials_avatar","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/photo_avatar","modules/clean/avatar/shared_link_avatar","modules/clean/avatar/viewer_avatar","modules/clean/avatar/list","modules/clean/components/title_bubble","modules/clean/datetime","modules/clean/em_string","modules/clean/sharing/constants","modules/clean/sharing/link_description","modules/clean/viewer","modules/core/i18n","modules/clean/static_urls"],function(t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g){var y,v,b,S,w,I,E,C,N;return E=p.nice_date_with_month_name,y=m.SHMODEL_LINK_TOKEN_VISIBILITY,v=m.SNIPPET_SIZES,I=h.formatSharedContentLinkDescription,b=f._,N=f.ungettext,C=g.static_url,S=t.createElement,w=t.DOM,{getInitialState:function(){return{paired_users_in_sf:!1}},componentWillMount:function(){var e;return e=this.arePairedUsersInSf(this.props.joinedMembers),this.setState({paired_users_in_sf:e,paired_users_in_sf:e})},componentWillReceiveProps:function(e){var t;return t=this.arePairedUsersInSf(e.joinedMembers),this.setState({paired_users_in_sf:t,paired_users_in_sf:t})},_wrap_with_avatar_type_and_data:function(e,t,n){return function(s){return e(t,n),s.stopPropagation()}},arePairedUsersInSf:function(t){var n,s,r,o,i,a;return!!t&&(a=_.get_viewer(),!!(a.is_paired&&(i=a.get_user_ids(!0),n=(function(){var e,n,r;for(r=[],e=0,n=t.length;e<n;e++)s=t[e],r.push(s.user_id);return r})(),r=i[0],e.call(n,r)>=0&&(o=i[1],e.call(n,o)>=0))))},findOwnerAndMeInJoinedMembers:function(e){var t,n,s,r,o,i;for(i=null,r=null,t=n=0,s=e.length;n<s&&(o=e[t],"owner"===o.access_type&&(i=o),o.user_id===this.props.user.id&&(r=o),null==i||null==r);t=++n);return[i,r]},addGroupsMembersInvitations:function(t,n,s,r,o){var i,a,l,d,c,p,u,m,h,_,f;for(null==o&&(o=[]),l=0,p=n.length;l<p;l++)i=n[l],t.push(this.renderGroup(i));for(d=0,u=s.length;d<u;d++)h=s[d],_=h.user_id,e.call(o,_)<0&&t.push(this.renderJoinedMember(h));for(f=[],c=0,m=r.length;c<m;c++)a=r[c],f.push(t.push(this.renderInvitedPerson(a)));return f},renderAvatarList:function(e,t){var n;return null==t&&(t=""),n=(function(e){return function(t){var n,s,o;return n=99,o=N("%(count)s more member","%(count)s more members",t).format({count:t}),s=t>=n?n+"+":""+t,S(c,{key:"overflow_count",text:o,direction:e.props.titleButtonDirection},S(r,{alt:o,dimension:e.props.avatarDimension,initials:s,color:"#7B8994",shape:"CIRCLE",onClick:e.props.onOverflowCountClick}))}})(this),S(d,{avatars:e,avatarDimension:this.props.avatarDimension,maxVisible:this.props.maxVisibleAvatars,undisplayableCount:this.props.numUndisplayableUsersAndInvites||0,onOverflowCountClick:this.props.onOverflowCountClick,overflowCountRenderer:n,animation:this.props.animation,inheritedCountAvatar:this.renderInheritedCount(e.length),className:t,reverseAvatars:!this.props.isMaestroDesign})},renderJoinedMember:function(t){var s,r,i,a,d,p,m,h,f,g,y;return g=_.get_viewer(),f=t.user_id,p=e.call(g.get_user_ids(!0),f)>=0,a=null,p&&this.state.paired_users_in_sf?(d=t.user_id,h=g.get_user_by_role("personal",!0),y=g.get_user_by_role("work",!0),d===h.id?a="Personal":d===y.id&&null!=g.team_name&&(a=g.team_name)):a=t.display_name,this.props.isInAudienceBox&&(a=u.em_snippet(a,v.DISPLAY_NAME)),s=this.individualAccessTypeString(a,t.access_type,p,this.state.paired_users_in_sf),m=this._wrap_with_avatar_type_and_data(this.props.onAvatarClick,"member",t),i={alt:s,dimension:this.props.avatarDimension,onPhotoClick:m,photoUrl:t.photo_url,defaultAvatar:S(o,{alt:s,dimension:this.props.avatarDimension,name:t.display_name,initials:this.props.isInAudienceBox?t.initials.toUpperCase():t.initials,shape:"CIRCLE",onClick:m})},r=p?S(l,i):S(n,i),S(c,{key:"user:"+t.user_id+":"+t.photo_url,text:s,direction:this.props.titleButtonDirection},r)},renderGroup:function(e){var t,n,s;return n=this._wrap_with_avatar_type_and_data(this.props.onAvatarClick,"group",e),e.is_automatic?(s=this.teamAccessTypeString(e.name,e.access_type),t=S(i,{alt:s,dimension:this.props.avatarDimension,photoUrl:C("/static/images/icons/team_32-vflk8mBzO.png"),shape:"SQUARE",onClick:n})):(s=this.groupAccessTypeString(e.name,e.access_type,e.num_users),t=S(o,{alt:s,dimension:this.props.avatarDimension,name:e.name,shape:"SQUARE",initials:this.getInitials(e.name),onClick:n})),S(c,{key:"group:"+e.gid+":"+e.name,text:s,direction:this.props.titleButtonDirection},t)},renderInvitedPerson:function(e){var t,n;return n=this._wrap_with_avatar_type_and_data(this.props.onAvatarClick,"invited",e),t=this.individualAccessTypeString(e.email_or_fbname,"pending",!1),S(c,{key:"invitation:"+e.invitation_id,text:t,direction:this.props.titleButtonDirection},S(r,{alt:t,dimension:this.props.avatarDimension,color:"#aaa",initials:this.getInitials(e.email_or_fbname),shape:"CIRCLE",onClick:n}))},renderInheritedCount:function(e){var t;if(this.props.numInheritedMembers>0)return t=N("%(inherited_count)s member from %(parent_folder)s folder","%(inherited_count)s members from %(parent_folder)s folder",this.props.numInheritedMembers).format({inherited_count:this.props.numInheritedMembers,parent_folder:this.props.parentFolderName}),w.div({},S(c,{text:t,direction:"south"},S(s,{inheritedMemberCount:this.props.numInheritedMembers,key:"count",onClick:this.props.onAvatarClick})),e>0?w.span({className:"members-column__plus-sign u-pad-left-xxs"},"+"):void 0)},getInitials:function(e){var t,n,s;return null!=e&&e.length>0?(s=e.split(" "),t=(function(){var e,t,r;for(r=[],e=0,t=s.length;e<t;e++)n=s[e],r.push(n.charAt(0).toLowerCase());return r})(),t.length>2&&(t=t.splice(0,2)),t.join("")):""},teamAccessTypeString:function(e,t){var n;return n=b("editor"===t?"%(team_group_name)s can edit":"%(team_group_name)s can view"),n.format({team_group_name:u.em_snippet(e,v.DISPLAY_NAME)})},groupAccessTypeString:function(e,t,n){var s;return s="editor"===t?N("%(num_users)s person in %(group_name)s can edit","%(num_users)s people in %(group_name)s can edit",n):N("%(num_users)s person in %(group_name)s can view","%(num_users)s people in %(group_name)s can view",n),s.format({group_name:u.em_snippet(e,v.DISPLAY_NAME),num_users:n})},individualAccessTypeString:function(e,t,n,s){var r,o,i,a;return null==s&&(s=!1),r={viewer:b("You can view"),editor:b("You can edit"),owner:b("You’re the owner"),team:b("You’re a member of this team folder"),default:b("You")},a={viewer:b("%(name)s can view"),editor:b("%(name)s can edit"),owner:b("%(name)s is the owner"),pending:b("%(name)s hasn’t added this to their Dropbox yet"),team:b("%(name)s is a member of this team folder"),default:b("%(name)s"),"no access":b("No access")},o={viewer:b("You (%(name)s) can view"),editor:b("You (%(name)s) can edit"),owner:b("You (%(name)s) are the owner")},i=n?s&&null!=e?o:r:a,i.hasOwnProperty(t)?i[t].format({name:u.em_snippet(e,v.DISPLAY_NAME)}):""},renderSharedLink:function(e,t){var n,s,r,o;return n=this.getDescriptionForSharedLinkInfo(e,t),s=S(a,{alt:n,dimension:this.props.avatarDimension,isMaestroDesign:this.props.isMaestroDesign,onClick:(function(t){return function(n){return t.props.onSharedLinkClick(e),n.stopPropagation()}})(this)}),(null!=e?e.allow_download:void 0)===!1?(r="sharing-icon-bubble-title u-font-center",o=!0):o=!1,S(c,{key:"shared_link",text:n,direction:"south",className:r,respectLineBreaks:o},s)},getDescriptionForSharedLinkInfo:function(e,t){var n,s,r,o,i,a,l,d,c,p,u,m;if(t)return I(t);if(m=e.visibility_type,o=e.expires_posix,p=e.shared_folder_link_policy,r="",o){if(d=(new Date).getTime()/1e3,c=o-d,s=Math.floor(c/86400),c<0)return b("Link Disabled");n=new Date(1e3*o),u=!1,a=!0,i=s>180,n=E(n,i,u,a)}if(e.allow_download===!1&&(r=". "+b("(Downloading is turned off.)",{comment:'This follows a description of link visibility. For example: "Anyone with the link can view this file. (Downloading is turned off.)"'})),l="MEMBERS_ONLY"===p,n){if(l)return b("Folder members with the link can view until %(date)s").format({date:n})+r;if(m===y.PUBLIC)return b("People with the link can view until %(date)s").format({date:n})+r;if(m===y.PASSWORD)return b("People with the password can view until %(date)s").format({date:n})+r;if(m===y.TEAM_ONLY)return b("People at %(team_name)s can view until %(date)s").format({team_name:_.get_viewer().team_name,date:n})+r;if(m===y.ONLY_YOU)return b("Only you can view until %(date)s").format({date:n})+r}else{if(l)return b("Folder members with the link can view")+r;if(m===y.PUBLIC)return b("People with the link can view")+r;if(m===y.PASSWORD)return b("People with the password can view")+r;if(m===y.TEAM_ONLY)return b("People at %(team_name)s with the link can view").format({team_name:_.get_viewer().team_name})+r;if(m===y.ONLY_YOU)return b("Only you can view")+r}}}})}.call(this),function(){define("modules/clean/sharing/parent_folder_access_modal",["external/classnames","external/react","modules/clean/em_string","modules/clean/react/flag","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d){var c,p,u,m,h,_,f,g,y,v,b;return m=r.Modal,u=i.MemberAccessLevelResult,c=a.ACCESS_LEVEL,_=a.SNIPPET_SIZES,p=l.ContentInfo,g=t.createElement,y=t.DOM,v=d.i18n_default_project("sharing"),f=v._,b=v.ungettext,h=t.createClass({displayName:"ParentFolderAccessModal",propTypes:{contentInfo:t.PropTypes.instanceOf(p).isRequired,memberAccessLevelResult:t.PropTypes.instanceOf(u).isRequired,memberDisplayName:t.PropTypes.string.isRequired,originalAction:t.PropTypes.oneOf(["remove","update"]).isRequired,isInContentManager:t.PropTypes.bool,onClose:t.PropTypes.func,onParentFolderClicked:t.PropTypes.func},_dismissModal:function(){return m.close(),this._handleDismissed()},_handleDismissed:function(){var e;return"function"==typeof(e=this.props).onClose?e.onClose():void 0},_handleNavigateToParentFolder:function(e){var t;return m.close(),"function"==typeof(t=this.props).onParentFolderClicked?t.onParentFolderClicked(e.path,this._arePermissionsAllowed(e.permissions)):void 0},_arePermissionsAllowed:function(e){return e.some(function(e){return null!=e?e.allow:void 0})},_memberCanEdit:function(){var e;return(e=this.props.memberAccessLevelResult.access_level)===c.OWNER||e===c.WRITER},_renderParentFolderContent:function(){var e;return e="remove"===this.props.originalAction?this.props.contentInfo.isFolder()?b("As a member of the parent folder listed below, %(member_name)s can still access the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):b("As a member of the parent folder listed below, %(member_name)s can still access “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):"update"===this.props.originalAction?this.props.contentInfo.isFolder()?this._memberCanEdit()?b("As a member of the parent folder listed below, %(member_name)s can still edit the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):b("As a member of the parent folder listed below, %(member_name)s can still view the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):this._memberCanEdit()?b("As a member of the parent folder listed below, %(member_name)s can still edit “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):b("As a member of the parent folder listed below, %(member_name)s can still view “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):void 0,y.div({},e.format({member_name:n.em_snippet(this.props.memberDisplayName,_.DISPLAY_NAME),content_name:n.em_snippet(this.props.contentInfo.name(),_.FILENAME)}),y.div({className:"parent-folder-access-modal__folder-list u-mar-top-s"},y.ul({className:"o-list-ui o-list-ui--dividers"},this.props.memberAccessLevelResult.parentFolders.map(this._renderParentFolder))))},_renderParentFolder:function(e){var t;return t=g(o,{group:"web",name:"folder_user_32",className:"u-pad-right-xs",alt:""}),y.li({},y.div({className:"parent-folder-access-modal__parent-folder u-pad-vertical-xs u-pad-horizontal-s",onClick:this._handleNavigateToParentFolder.bind(null,e)},g(s.Flag,{leftAttachment:t,rightAttachment:this._renderFolderLink(e)},y.span({className:"parent-folder-access-modal__folder-name"},n.em_snippet(e.name,_.FILENAME)))))},_renderFolderLink:function(e){return y.button({className:"button-as-link",onClick:this._handleNavigateToParentFolder.bind(null,e),type:"button"},f(this._arePermissionsAllowed(e.permissions)?"Manage membership":"View folder"))},_renderSimpleContent:function(){return y.div({},y.span({className:"parent-folder-access-modal__warning"},this.props.memberAccessLevelResult.warning),y.div({className:"u-mar-top-m clearfix"},y.div({className:"u-l-fr"},y.button({className:"c-btn c-btn--primary confirm-button",onClick:this._dismissModal},f("OK")))))},render:function(){var e;return e="remove"===this.props.originalAction?f(this.props.contentInfo.isFolder()?"%(member_name)s can still access this folder":"%(member_name)s can still access this file"):"update"===this.props.originalAction?f(this.props.contentInfo.isFolder()?this._memberCanEdit()?"%(member_name)s can still edit this folder":"%(member_name)s can still view this folder":this._memberCanEdit()?"%(member_name)s can still edit this file":"%(member_name)s can still view this file"):void 0,g(m,{autoClose:!1,className:"parent-folder-access-modal",buttonComponent:y.span(),onDismissCompleted:this._handleDismissed,title:e.format({member_name:n.em_snippet(this.props.memberDisplayName,_.DISPLAY_NAME)})},y.div({className:"parent-folder-access-modal__contents"},null==this.props.memberAccessLevelResult.parentFolders||this.props.isInContentManager?this._renderSimpleContent():this._renderParentFolderContent()))}}),{ParentFolderAccessModal:h}})}.call(this),function(){var e=function(e,n){function s(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return s.prototype=n.prototype,e.prototype=new s,e.__super__=n.prototype,e},t={}.hasOwnProperty;define("modules/clean/sharing/role_selector_modal",["jquery","modules/clean/dbmodal","modules/clean/multiaccount_login","modules/clean/viewer"],function(t,n,s,r){var o;return o=n.DBModal,(function(n){function o(e){this.onSelectRole=e,o.__super__.constructor.call(this,{element_id:"select-role-modal-sync"})}return e(o,n),o.prototype.on_show=function(){return t(".role-options li").click((function(e){return function(n){var o;return o=t(n.target).closest("li").data("role"),e.hide(),r.get_viewer().is_role_signed_in(o)?e.onSelectRole(o):s.show_modal({role:o,on_success:function(){return e.onSelectRole(o)}})}})(this))},o})(o)})}.call(this),define("modules/clean/sharing/settings_modal/views/link_settings_tab",["require","exports","modules/clean/em_string","modules/core/i18n","modules/constants/python","external/react","modules/clean/sharing/api/types/metadata","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/gating_util"],function(e,t,n,s,r,o,i,a,l){"use strict";function d(){return p("Link settings")}function c(e){return l.isUserNoCommentEnabled(e)?[a.AUDIENCE_POLICY,a.ACCESS_LEVEL_POLICY,a.EXPIRY_POLICY,a.PASSWORD_POLICY]:[a.AUDIENCE_POLICY,a.EXPIRY_POLICY,a.PASSWORD_POLICY]}Object.defineProperty(t,"__esModule",{value:!0});var p=s.i18n_default_project("sharing")._;t.TabName=d,t.Description=function(e){var t;return t="owner"===e.aclUpdatePolicy?p(e.isTeamFolderTree?"Only team admins can change these settings":e.userIsOwner?"Only you (the owner) can change these settings":"Only the owner can change these settings"):null!=e.ownerTeam?p("Members of %(team_name)s with edit access can change these settings").format({team_name:n.em_snippet(e.ownerTeam.name,12)}):p("Anyone with edit access can change these settings"),o.createElement("span",null,t)},t.Banner=function(e){var t,n=e.linkMetadata.link_permissions&&e.linkMetadata.link_permissions.some(function(e){return!(!e||!e.allow)}),s=null!=e.linkMetadata.link_permissions.set_password&&e.linkMetadata.link_permissions.set_password.reason===i.VisibilityDisallowedReason.user_account_type;if(n){if(!s)return o.createElement("div",null);t=e.user.is_team?o.createElement("a",{href:"/team/upgrade",target:"_blank",rel:"noopener noreferrer"},p("Upgrade to %(trademark_business)s to enable expiration and password settings").format({trademark_business:r.TRADEMARK_BUSINESS})):o.createElement("a",{href:"/upgrade?oqa=sfp",target:"_blank",rel:"noopener noreferrer"},p("Upgrade to Dropbox %(trademark_plus)s to enable expiration and password settings.").format({trademark_plus:r.TRADEMARK_PLUS}))}else t=o.createElement("span",null,p("You don’t have permission to modify these link settings"));return o.createElement("div",{className:"sharing-settings-modal__banner u-font-center"},t)},t.getPolicies=c}),function(){define("modules/clean/sharing/settings_modal_components",["external/classnames","external/spectrum/button","external/react","modules/clean/react/css","modules/core/i18n"],function(e,t,n,s,r){var o,i,a,l,d,c;return o=t.Button,c=n.DOM,l=r.i18n_default_project("sharing")._,i=n.createClass({displayName:"SettingsModalButtons",propTypes:{disableSave:n.PropTypes.bool,isAccepting:n.PropTypes.bool,onAccept:n.PropTypes.func,onDismiss:n.PropTypes.func},render:function(){return c.div({className:"u-l-fr"},n.createElement(o,{className:"cancel-button",variant:"secondary",onClick:this.props.onDismiss},l("Cancel")),n.createElement(o,{className:"confirm-button u-mar-left-s",variant:"primary",disabled:this.props.disableSave||this.props.isAccepting,onClick:this.props.onAccept},l(this.props.isAccepting?"Saving...":"Save")))}}),d=n.createClass({displayName:"SinglePolicyControl",propTypes:{canChange:n.PropTypes.bool,denyReason:n.PropTypes.string,currentValue:n.PropTypes.string,handleOptionChange:n.PropTypes.func,options:n.PropTypes.array,policyDescription:n.PropTypes.string,policyName:n.PropTypes.string},getDefaultProps:function(){return{canChange:!0}},render:function(){var t;return c.fieldset({className:e({"settings-form-entry":!0,"settings-form-entry--no-permissions":!this.props.canChange})},this.props.canChange||void 0===this.props.denyReason?void 0:c.div({className:"u-pad-xs u-font-center u-mar-bottom-s shared-folder-settings-form__no-permissions-banner"},this.props.denyReason),c.legend({className:"settings-form-entry__explanation u-trim-margin"},this.props.policyDescription),c.div({className:"settings-form-entry__options"},function(){var e,n,s,r;for(s=this.props.options,r=[],e=0,n=s.length;e<n;e++)t=s[e],r.push(c.label({key:t.value},c.input({checked:t.value===this.props.currentValue,className:"settings-form-entry-option-"+this.props.policyName+"__"+t.value,disabled:!this.props.canChange,name:this.props.policyName,onChange:(function(e){return function(t){var n;return"function"==typeof(n=e.props).handleOptionChange?n.handleOptionChange(t.target.name,t.target.value):void 0}})(this),type:"radio",value:t.value}),t.label));return r}.call(this)))}}),a=s(d,["/static/css/sharing/share_modal-vflqUEM1t.css"]),{SettingsModalButtons:i,SinglePolicyControl:a}})}.call(this),define("modules/clean/sharing/share_modal",["require","exports","tslib","external/immutable","external/react","modules/clean/flux/dispatcher","modules/clean/flux/store_listener","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/react/pass/utils","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/api/util/types","modules/clean/sharing/file_settings_modal","modules/clean/sharing/folder_settings_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/ui_util","modules/clean/sharing/views/inherited_members","modules/clean/sharing/views/modal_content","modules/clean/viewer","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=r.createElement,C=w.i18n_default_project("sharing")._,N=function(e){var t=c.AnonymousViewerUtils.getAnonymousUserIds(e),n=C("Guest");return t.map(function(e){return new p.UserMembershipInfo({access_type:u.ACCESS_LEVEL.READER,account:new p.BasicAccount({account_id:e,display_name:n,familiar_name:n,given_name:n,surname:""}),account_id:e,initials:I.getInitials(n),is_inherited:!1,permissions:new p.MemberPermissions({make_editor:new p.PermissionSetting({allow:!1}),make_viewer:new p.PermissionSetting({allow:!1}),make_owner:new p.PermissionSetting({allow:!1}),remove:new p.PermissionSetting({allow:!1})}),same_team:!1,time_last_seen:null})})},M=function(e){var t=e.actionHandler.getSharingInfo(),r=e.actionHandler.getPassInfo(),o=r[0],i=r[1],a=r[2],l={actionHandler:e.actionHandler,areMembersFullyLoaded:t.areMembersFullyLoaded(),areSharingPrefsLoaded:t.areSharingPrefsLoaded(),banner:t.banner(),canChangeOptions:t.canChangeOptions(),canInviteEditor:t.canInviteEditor(),canInviteViewer:t.canInviteViewer(),canInviteViewerNoComment:t.canInviteViewerNoComment(),canMakeViewerNoComment:t.canMakeViewerNoComment(),canRelinquishMembership:t.canRelinquishMembership(),canShareLink:t.canShareLink(),canUnshareFile:t.canUnshareFile(),canUnshareFolder:t.canUnshareFolder(),canUpdateConfidentiality:t.canUpdateConfidentiality(),contactsError:t.contactsError(),contentInfo:t.contentInfo(),contentNameMessage:t.contentNameMessage(),contentNameMessageLevel:t.contentNameMessageLevel(),filePolicy:t.filePolicy(),folderPolicy:t.folderPolicy(),guestMembers:N(i),groupSeenStateInfo:o,hasDisplayableMembers:t.hasDisplayableMembers(),hasNonOwnerMembers:t.hasNonOwnerMembers(),hasParentSharedFolder:t.hasParentSharedFolder(),icon:t.icon(),initialRecipientRawInput:t.initialRecipientRawInput(),initialRecipientTokens:t.initialRecipientTokens(),isAddMessageAsCommentChecked:t.isAddMessageAsCommentChecked(),isAddMessageAsCommentHelpShown:t.isAddMessageAsCommentHelpShown(),isConfidentialFolder:t.isConfidentialFolder(),isContentNameFocused:t.isContentNameFocused(),isFolderInsideTeamFolderTree:t.isFolderInsideTeamFolderTree(),isLinkMetadataLoaded:t.isLinkMetadataLoaded(),isMetadataLoaded:t.isMetadataLoaded(),isNoCommentEnabledForFolders:t.isNoCommentEnabledForFolders(),isNoCommentEnabledForLinks:t.isNoCommentEnabledForLinks(),isOwner:t.isOwner(),isTeamPolicyLoaded:t.isTeamPolicyLoaded(),isTeamSharedFolder:t.isTeamSharedFolder(),isTokenizerEmpty:t.isTokenizerEmpty(),isUserOnOwnerTeam:t.isUserOnOwnerTeam(),linkMetadata:t.linkMetadata(),linkOnlyReason:t.linkOnlyReason(),memberCounts:t.memberCounts(),memberCountWithRecipients:t.memberCountWithRecipients(),members:t.members(),metadata:t.metadata(),ownerTeam:t.ownerTeam(),passFetchingStatus:a,pendingMemberAction:t.pendingMemberAction(),permissions:t.permissions(),presentAccountIds:s.Set(i),recipientAccess:t.recipientAccess(),recipientMessage:t.recipientMessage(),recipientTokens:t.recipientTokens(),shareFolderPromise:t.shareFolderPromise(),shouldBlockMemberListOnPassLoad:t.shouldBlockMemberListOnPassLoad(),teamPolicy:t.teamPolicy(),uiMode:t.uiMode(),expSubgrowthBizTeamsManageAccessInvite:t.expSubgrowthBizTeamsManageAccessInvite(),expSubgrowthProOverquotaCreateSharedLink:t.expSubgrowthProOverquotaCreateSharedLink()};return n.__assign({},t.getInitialProps(),l)},T=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleSettingsClick=function(){n.props.contentInfo.isFolder()?n.handleFolderSettingsClick():n.handleFileSettingsClick()},n.handleSetConfidentialClick=function(){var e=function(e){e&&(n.props.actionHandler.handleGetMetadataSuccess(e),n.props.actionHandler.listMembers(e.shared_folder_id)),n.props.actionHandler.openShareModal()};l.Modal.showInstance(r.createElement(v.SetInheritedMembersUIConfidentialModal,{actionHandler:n.props.actionHandler,initialIsConfidentialFolder:n.props.isConfidentialFolder,contentInfo:n.props.contentInfo,teamName:n.props.ownerTeam.name,onCancel:e,onUpdateConfidentiality:e}))},n.client=n.props.client,n}return n.__extends(t,e),t.prototype.componentWillUnmount=function(){var e=this.getTokenizer();this.props.actionHandler.onShareModalUnmount(e)},t.prototype.render=function(){var e=d.getPassPermissions(this.props.contentInfo.id),t=e&&e.canShowPresence,s=!!(this.props.contentInfo.isFile()?this.props.filePolicy&&this.props.filePolicy.viewer_info_policy:this.props.folderPolicy&&this.props.folderPolicy.viewer_info_policy),o={headerId:"unified-share-modal-title",areCheckboxSettingsLoaded:this.props.areSharingPrefsLoaded,isLimitedTeam:this.props.viewer.team_is_limited,isPassEnabled:t,isInContentManager:this.props.isInContentManager,onSettingsClick:this.handleSettingsClick,onSetConfidentialClick:this.handleSetConfidentialClick,mode:this.props.uiMode,ref:"content",showContentManagerBridge:this.shouldRenderContentManagerBridge(),showPassFileSettings:s,suppressLinkUI:this.shouldSuppressLinkUI()};return o=n.__assign({},this.props,o),r.createElement(l.Modal,{style:"bare",acceptButtonText:null,dismissButtonText:null,headerId:"unified-share-modal-title",ref:"modal"},E(b.ShareModalContent,o))},t.prototype.shouldSuppressLinkUI=function(){return this.props.isInContentManager&&!u.TRUELINK.TRUELINK_UI[this.props.user.id]},t.prototype.refreshSharedWithColumnLinkData=function(){o.dispatch({type:a.SharedWithActionTypes.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.props.contentInfo.displayPath()]}})},t.prototype.handleFolderPolicySuccess=function(e,t){o.dispatch({type:f.SharePageActionTypes.FETCH_FOLDER_POLICY_SUCCESS,user:this.props.user,metadata:t,folderPolicy:e})},t.prototype.getTokenizer=function(){return this.refs.content&&this.refs.content.getWrappedComponent()&&this.refs.content.getWrappedComponent().refs.tokenizer},t.prototype.handleFileSettingsClick=function(){var e=this,t=u.TRUELINK.TRUELINK_UI[this.props.user.id]?m.getCombinedPolicy(this.props.filePolicy,this.props.linkMetadata):this.props.filePolicy,n=function(n){null!=n&&e.props.actionHandler.handleUpdateFilePolicy(n,t),e.props.actionHandler.openShareModal()};l.Modal.showInstance(r.createElement(h.FileSettingsModal,{fileName:this.props.contentInfo.name(),contentId:this.props.contentInfo.id,canChangeOptions:this.props.canChangeOptions,canUnshareFile:this.props.canUnshareFile,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,initialPolicy:t,linkMetadata:this.props.linkMetadata,onCancel:n,onPolicySet:n,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,user:this.props.user})),y.logTiburonEvent(this.props.contentInfo,this.props.user.id,"OPEN_FILE_SETTINGS_MODAL")},t.prototype.handleFolderSettingsClick=function(){var e=this,t=u.TRUELINK.TRUELINK_UI[this.props.user.id]?m.getCombinedPolicy(this.props.folderPolicy,this.props.linkMetadata):this.props.folderPolicy,n=function(t,n){null!=n&&(e.props.actionHandler.handleUpdateSharingSettings(n),e.handleFolderPolicySuccess(t,n),e.props.onSuccessSharing&&e.props.onSuccessSharing(),n.policy.shared_link_policy!==e.props.folderPolicy.shared_link_policy&&(e.props.actionHandler.fetchLinkMetadata(),e.refreshSharedWithColumnLinkData())),e.props.actionHandler.openShareModal()},s=null,o=null;this.props.contentInfo.extras&&this.props.contentInfo.extras.nsId&&(s=this.props.contentInfo.extras.nsId,o=this.props.contentInfo.extras.nsPath),l.Modal.showInstance(r.createElement(_.SharedFolderSettingsModal,{actionHandler:this.props.actionHandler,folderName:this.props.contentInfo.name(),folderId:this.props.metadata.shared_folder_id,folderPath:this.props.contentInfo.displayPath(),nsId:s,nsPath:o,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,hasParentSharedFolder:this.props.hasParentSharedFolder,initialHasParentSharedFolder:this.props.hasParentSharedFolder,initialMetadata:this.props.metadata,initialOwnerTeam:this.props.ownerTeam,initialPermissions:this.props.permissions,initialPolicy:t,isInContentManager:this.props.isInContentManager,isSharedFolder:this.props.contentInfo.isSharedFolder(),initialIsTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isLimitedTeam:this.props.viewer.team_is_limited,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onCancel:n,onPolicySet:n,showContentManagerBridge:this.shouldRenderContentManagerBridge(!0),showViewerInfoSettings:u.PASS_CONTROL_AVAILABILITY.SHOW_FOLDER_SETTINGS,teamPolicy:this.props.teamPolicy,updateLinkSettings:this.props.actionHandler.updateLinkSettings,user:this.props.user}))},t.prototype.shouldRenderContentManagerBridge=function(e){return void 0===e&&(e=!1),!this.props.isInContentManager&&(!!y.GoldenGate.hasContentManagerAndSuperAdmin(this.props.user.id)&&(!!this.props.isTeamSharedFolder||!(!this.props.isFolderInsideTeamFolderTree||!this.props.isUserOnOwnerTeam)&&(e||!this.props.canInviteEditor)))},t})(r.Component);T.displayName="ShareModal",T.defaultProps={viewer:S.get_viewer()},t.ShareModal=i.listenToStores(T,{sharingInfoStore:g.sharingInfoStore,passStore:d},M)}),function(){define("modules/clean/sharing/share_modal_util",["external/react","external/underscore","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/filetypes","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/modal","modules/clean/react/teams/modals/limited_team_folder_settings_modal","modules/clean/react/teams/modals/limited_team_share_folder_modal","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api","modules/clean/sharing/api/client","modules/clean/sharing/content_info","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/sharing/ui_util","modules/clean/user","modules/clean/viewer","modules/core/uri"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w){var I,E,C,N,M,T,A,P,k,x,F,L,R,D,O,U,B,q,H,V,G,W,K,Y;return N=n.EmailVerification,E=r.Contact,A=i.FileTypes,I=l.BrowseContext,M=l.File,d.Modal,x=u.ShareModalActionHandler,F=m.SharingApi,T=h.FileShareApiClient,P=h.FolderShareApiClient,C=_.ContentInfo,q=f.makePublicFolderLink,W=f.showPublicFolderLinkModal,k=g.ShareModal,D=v.getNewFolderPathFromContentName,B=v.logTiburonEvent,e.createElement,R=function(){return Math.random()},U=function(e,n,s){var r,o,i;null==s&&(s={}),e.id||(e=S.get_viewer().get_user_by_id(e)),null==s.userHomeNs&&(s.userHomeNs=e.home_ns_id),i=O(n),t.extend(i,s),i.modalSessionId||(i.modalSessionId=R()),a.logViewShareModel({uid:e.id,modal_session_id:i.modalSessionId});try{o=C.createFromParams(i)}catch(e){o=null}return r=n instanceof I?n:i.browseContext,{browseContext:r,contentInfo:o,shareModalInfo:i,user:e}},K=function(e,t,n){var r,o,i,a,l,d,c,p,u,m,h,_;return null==n&&(n={}),m=U(e,t,n),o=m.browseContext,a=m.contentInfo,_=m.shareModalInfo,e=m.user,null!=a&&(B(a,e.id,"BEGIN_SHARE_FLOW"),!!H(e,_,o)||(!_.skipPublicFolderCheck&&a&&o&&(p=q(e.id,o.config,a.displayPath(),a.isFolder()))?(W(p),
!0):(c=(null!=o?o.isNonUserRelativeContext:void 0)||_.isNonUserRelativeContext,u=void 0,"PREVIEW_PAGE"===_.origin&&(u=s.SHARE_FILEVIEWER),c||N.get_for_user(e).verified_or_show(u)?(h=a.isFolder()?P:T,i=new h({userId:e.id,isNonUserRelativeContext:c}),r=new x(i,e,k),l=_.inLinksPage,d=_.prefillContacts,r.initializeShareModal({contentInfo:a,initialRecipientTokens:d,inLinksPage:l},{client:i,user:e,onDeleteLink:_.onDeleteLink,teamGroupInfo:a.teamGroupInfo(),isInContentManager:c,onSuccessSharing:_.onSuccessSharing,shareAsConfidential:_.shareAsConfidential,initialContentName:_.initialContentName,experiments:t.experiments}),r.openShareModal()):B(a,e.id,"SHARE_MODAL_EMAIL_UNVERIFIED"),!0)))},H=function(e,t,n){var s;if(t.isTeamSharedFolder&&S.get_viewer().team_is_limited)return!e.is_team_admin||"BROWSE_SHARED_FOLDER_BANNER"!==(s=t.origin)&&"BROWSE_GLOBAL_ACTIONS"!==s?p.showModalInstance({fqPath:t.fqPath}):c.showWithProps({folderId:t.targetNsId.toString(),folderName:n.getNameOfTargetFolder(),user:e}),!0},O=function(e){var t,n;return e instanceof M?(t=(n=e.type)===A.FILE||n===A.PACKAGE,{beaconContext:e.beacon_context,exists:!e.isDeleted,fileId:e.file_id,fqPath:e.fq_path,isFolder:!t,isTeamSharedFolder:e.type===A.TEAM_SHARED_FOLDER,sjid:e.sjid,nsId:e.ns_id,nsPath:e.ns_path,targetNsId:e.target_ns}):e instanceof I?L(e):e},L=function(e){return e.isInsideDeletedFolder||e.isInsideDeletedSharedFolder?null:e.isInFolderMode?e.isInsideSharedFolder?e.currentNSPath?{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentMountPoint,isFolder:!0,nsId:null,nsPath:e.currentMountPoint,targetNsId:e.currentNSID}:{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentFQPath,isFolder:!1,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}},V=function(e,t,n,s,r,o){var i;return null==t&&(t=null),null==n&&(n=null),null==s&&(s=null),null==r&&(r=!1),null==o&&(o=!1),t||(t=R()),i=function(){var e,t,s;for(e="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=1;t<=100;++t)e+=s.charAt(Math.floor(Math.random()*s.length));return D(e,n)},K(e,{fqPath:i(),isFolder:!0,exists:!1,origin:"WIZARD",modalSessionId:t,initialContentName:s,shareAsConfidential:r,isNonUserRelativeContext:o})},Y=function(e,t){var n,s;return n=new F(e),s=function(e){var n;return n=JSON.parse(e.responseText),y.showSharedContentSyncModal(n,t)},n.get_sync_vars_for_ns_id(t.ns_id,t.ns_path,s)},G=function(e){var t,n,s,r,i;return i=e.user,r=e.sharePrefillEmail,t=e.content,r?(n="GRANT_ACCESS",s=[new E({type:o.EMAIL,email:r})]):(n="DESKTOP_CLIENT",s=[]),K(i,t,{origin:n,prefillContacts:s})},{generateModalSessionId:R,getShareModalInfo:O,getSharingInfo:U,showFastrakShareModalIfAllowed:H,showNewFolderShareModal:V,showSharedContentLinkSyncModal:Y,showShareModal:K,showPrefilledShareModal:G}})}.call(this),function(){define("modules/clean/sharing/shared_content_link_sync_modal",["external/classnames","external/react","modules/clean/ajax","modules/clean/avatar/triple_avatars","modules/clean/analytics","modules/clean/avatar/avatar_with_default","modules/clean/avatar/faceholder","modules/clean/avatar/size","modules/clean/em_string","modules/clean/filepath","modules/clean/history","modules/clean/loggers/growth_features_events_logger","modules/clean/react/button","modules/clean/react/browse/models","modules/clean/react/image","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react_format","modules/clean/sharing/constants","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/teams","modules/constants/python","modules/constants/payments","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","require"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I,E,C,N,M,T,A,P){var k,x,F,L,R,D,O,U,B,q,H;return R=s.TripleAvatars,L=r.ShareTibEventLogger,k=a.AVATAR_DIMENSION_BY_SIZE,O=u.button,x=m.File,F=_.Modal,q=g.reactFormat,H=b.static_url,E.TRADEMARK_BUSINESS,D=M.i18n_default_project("sharing")._,B=t.DOM,U=t.createElement,t.createClass({statics:{showInstance:function(e){return F.showInstance(e)}},displayName:"SharedContentLinkSyncModal",ASK:"ask",ASKING:"asking",propTypes:{accessLevel:t.PropTypes.string.isRequired,folderName:t.PropTypes.string.isRequired,folderSize:t.PropTypes.string.isRequired,onMountSharedFolder:t.PropTypes.func.isRequired,canRequestToJoin:t.PropTypes.bool,magnetControlLogging:t.PropTypes.bool,previewCallback:t.PropTypes.func,previewUrl:t.PropTypes.string,outOfQuotaQP:t.PropTypes.string,ownerName:t.PropTypes.string,senderName:t.PropTypes.string,usageRemaining:t.PropTypes.string,usageNeeded:t.PropTypes.string,targetFile:t.PropTypes.instanceOf(x),syncNSId:t.PropTypes.string,expProSharingOverquotaModal:t.PropTypes.string,ownerProfilePhotoUrl:t.PropTypes.string},getDefaultProps:function(){return{canRequestToJoin:!1,magnetControlLogging:!1}},getInitialState:function(){return{state:this.ASK,ownerTeam:null}},componentWillMount:function(){var e,t,n,s;return s=w.start_time(),e=(new Date).getTime(),this.user=S.get_viewer().get_users()[0],this.userId=this.user.id,n=y.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL,t=this.props.targetFile?"UNMOUNTED_SEARCH_MODAL_RENDER":"SYNC_MODAL_RENDER",L.log(this.userId,t,n,{timing:e-s,ns_id:this.props.syncNSId})},_closeSyncModal:function(){var e,t,n;return this.props.outOfQuotaQP&&(this.props.canRequestToJoin?(e={is_limited:null!=(t=this.state.ownerTeam)?t.is_limited:void 0,ns_id:this.props.syncNSId,requested_team_id:null!=(n=this.state.ownerTeam)?n.id:void 0},p.logMagnetEvent("request_modal_OQ_dismissed",e)):this.props.magnetControlLogging&&(e={ns_id:this.props.syncNSId},p.logMagnetEvent("modal_OQ_dismissed"))),c.remove_query_param("sm"),this.refs.modal.close()},_renderTopPanelIcon:function(){return this.props.targetFile?U(f,{alt:"",group:"web",name:this.props.targetFile.icon}):U(f,{alt:"",group:"web",name:"folder_user_32"})},_renderTopPanelTitle:function(){return this.props.targetFile?l.em_snippet(d.filename(this.props.targetFile.fq_path,15)):l.em_snippet(this.props.folderName,15)},_renderTopPanelSubtitle:function(){return this.props.targetFile?null!=this.props.ownerName?D("Owned by %(name)s").format({name:this.props.ownerName}):D("Not currently owned"):this.props.folderSize},_renderAccessText:function(){return this.props.outOfQuotaQP?this.props.canRequestToJoin?this.state.ownerTeam?B.div({},B.div({className:"content-link-sync-modal__access-text u-mar-top-m"},U(R,{contacts:this.state.ownerTeam.contacts,count:this.state.ownerTeam.count})),B.div({className:"content-link-sync-modal__access-text"},D("Your Dropbox is full—join the %(team_name)s Dropbox?").format({team_name:this.state.ownerTeam.name}))):B.div({}):B.div({className:"content-link-sync-modal__access-text"},D("Not enough space")):B.div({className:"content-link-sync-modal__access-text"},null!=this.props.senderName?"can_view"===this.props.accessLevel?D("%(name)s gave you access to view this folder").format({name:this.props.senderName}):D("%(name)s gave you access to edit this folder").format({name:this.props.senderName}):D("can_view"===this.props.accessLevel?"You have access to view this folder":"You have access to edit this folder"))},_renderSharedFolderInfo:function(){var e;return B.div({className:"content-link-sync-modal__shared-folder-info"},B.div({className:"content-link-sync-modal__shared-folder-text"},D((null!=(e=this.props.targetFile)?e.is_dir:void 0)?"This folder is part of a shared folder:":"This file is part of a shared folder:")),B.div({},U(f,{alt:"",group:"web",name:"folder_user_32"})),B.p({className:"u-font-meta"},this.props.folderName,B.br({}),this.props.folderSize))},_renderTipBody:function(){return this.props.outOfQuotaQP?this.props.canRequestToJoin?this.state.ownerTeam?this.state.ownerTeam.contacts.length>0?D("Join %(name)s and your coworkers and get more space to work together.").format({name:this.state.ownerTeam.contacts[0].display_name}):void 0:B.img({className:"content-link-sync-modal__loader",src:H("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:D("Loading")}):this.props.usageRemaining?D("To add this folder, you’ll need %(needed)s of space in your Dropbox. You currently have %(remaining)s of space left.").format({remaining:this.props.usageRemaining,needed:this.props.usageNeeded}):D("To add this folder, you’ll need %(needed)s of space in your Dropbox. You currently have no space left.").format({needed:this.props.usageNeeded}):this.state.state===this.ASKING?B.img({src:H("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:D("Loading")}):D("can_view"===this.props.accessLevel?this.props.targetFile?"For easy access to this file in the future, add the folder to your Dropbox.":"For easy access to this folder in the future, add it to your Dropbox.":this.props.targetFile?"To start working on this file, you need to add the folder to your Dropbox first.":"To start working on this folder, you need to add it to your Dropbox first.")},_renderPreviewLink:function(){if("can_view"===this.props.accessLevel)return B.div({},B.span({className:"content-link-sync-modal__or"},D("Or")),B.button({className:"content-link-sync-modal__not-now-label button-as-link",onClick:this.onPreviewButtonClicked},D(!this.props.targetFile||this.props.targetFile.is_dir?"preview this folder":"preview this file")))},render:function(){var t,n,s,r,o;return s="V1"===(r=this.props.expProSharingOverquotaModal)||"V2"===r||"V3"===r,n=e({"content-link-sync-modal":!0,"can-request-to-join-team":this.props.canRequestToJoin,"content-link-sync-modal--pro-variant":s}),this.props.outOfQuotaQP&&s?(o=this.renderVariant(),t=this.renderButtonsVariant()):(o=this.renderControl(),t=this.renderButtons()),U(F,{autoClose:!1,buttonComponent:t,className:n,clickOutToClose:!1,ref:"modal",showX:!1,title:""},o)},renderControl:function(){return B.div({className:"content-link-sync-modal__content u-mar-bottom-xs"},B.div({className:"content-link-sync-modal__top-panel u-pad-s"},B.div({className:"content-link-sync-modal__icon u-pad-top-xs"},this._renderTopPanelIcon()),B.div({className:"content-link-sync-modal__name-size u-l-ib u-pad-left-xs u-pad-top-xs o-flag__flex"},B.h3({className:"u-font-strong"},this._renderTopPanelTitle()),B.h4({className:"u-trim-margin u-font-meta"},this._renderTopPanelSubtitle())),B.div({className:"content-link-sync-modal__close u-pad-xs o-flag__fix"},U(v,{onClick:(function(e){return function(){return e._closeSyncModal()}})(this)}))),B.div({className:"content-link-sync-modal__tip-panel"},this.props.targetFile?this._renderSharedFolderInfo():this._renderAccessText(),B.div({className:"content-link-sync-modal__tip-body"},this._renderTipBody())))},renderVariant:function(){var e,t,n;return n=this.props.usageRemaining>0?q(D("To add this folder, you’ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have <span>%(remaining)s</span> of space left."),{strong:B.strong(),span:B.span({className:"content-link-sync-modal__alert"}),remaining:this.props.usageRemaining,needed:this.props.usageNeeded}):q(D("To add this folder, you’ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have no space left."),{strong:B.strong(),needed:this.props.usageNeeded}),t=null!=this.props.ownerName,B.div({className:"content-link-sync-modal--pro-variant__content u-mar-bottom-xs"},B.div({className:"content-link-sync-modal--pro-variant__close u-pad-xs u-font-right"},U(v,{onClick:(function(e){return function(){return e._closeSyncModal()}})(this)})),B.div({className:"content-link-sync-modal--pro-variant__container"},B.div({className:"content-link-sync-modal--pro-variant__left-container"},"V1"===this.props.expProSharingOverquotaModal?U(h,{src:H("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}):"V2"===this.props.expProSharingOverquotaModal?B.div({className:"content-link-sync-modal--pro-variant__folder-container"},U(h,{src:H("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}),t?B.div({className:"avatar-img"},U(o,{dimension:k.MEDIUM,photoUrl:this.props.ownerProfilePhotoUrl,shape:"CIRCLE",defaultAvatar:U(i,{dimension:k.MEDIUM})})):void 0):"V3"===this.props.expProSharingOverquotaModal?U(h,{src:H("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")}):"V4"===this.props.expProSharingOverquotaModal?U(h,{src:H("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}):void 0,B.div({className:"content-link-sync-modal--pro-variant__content"},B.div({className:"content-link-sync-modal--pro-variant__folder-name"},l.em_snippet(this.props.folderName,y.OUT_OF_QUOTA_FOLDER_NAME)),"V1"!==(e=this.props.expProSharingOverquotaModal)&&"V2"!==e&&"V3"!==e||!t?void 0:B.div({className:"content-link-sync-modal--pro-variant__owner-name"},l.em_snippet(this.props.ownerName,y.DISPLAY_NAME)))),B.div({className:"content-link-sync-modal--pro-variant__right-container"},B.div({className:"content-link-sync-modal--pro-variant__tip-title"},D("Not enough space")),B.div({className:"content-link-sync-modal--pro-variant__tip-body"},n))))},renderButtons:function(){return this.props.canRequestToJoin&&this.props.outOfQuotaQP?this.state.ownerTeam?B.div({className:"content-link-sync-modal__buttons u-mar-bottom-s"},this.props.outOfQuotaQP?B.div({},this.state.ownerTeam.is_limited?void 0:U(O,{importance:"primary",className:"content-link-sync-modal__request-to-join-button",disabled:this.state.state===this.ASKING,onClick:this.onRequestButtonClicked},D("Request to join")),U(O,{importance:this.state.ownerTeam.is_limited?"primary":"tertiary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked},D("Upgrade to add folder")),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0):void 0):B.div({}):B.div({className:"content-link-sync-modal__buttons u-mar-bottom-s"},U(O,{importance:"primary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked},D(this.props.outOfQuotaQP?"Upgrade to add folder":this.props.targetFile?this.user.is_cdm_member?"Add folder to member folder":"Add folder to Dropbox":this.user.is_cdm_member?"Add to member folder":"Add to Dropbox")),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0)},renderButtonsVariant:function(){return B.div({className:"content-link-sync-modal--pro-variant__buttons"},U(O,{importance:"primary",className:"content-link-sync-modal--pro-variant__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onUpgradeButtonClicked},D("Upgrade to add folder")))},requestCallback:function(){var e,t,n,s;return this.props.outOfQuotaQP?(this.props.canRequestToJoin?(e={is_limited:null!=(n=this.state.ownerTeam)?n.is_limited:void 0,ns_id:this.props.syncNSId,requested_team_id:null!=(s=this.state.ownerTeam)?s.id:void 0},p.logMagnetEvent("request_modal_OQ_click_upgrade",e)):this.props.magnetControlLogging&&(e={ns_id:this.props.syncNSId},p.logMagnetEvent("modal_OQ_CTA_click",e)),t=C.BUY_URL,N.redirect(A({path:t}).updateQuery({oqa:this.props.outOfQuotaQP}))):(this.props.targetFile&&L.log(this.userId,"UNMOUNTED_SEARCH_SYNC","SYNC_MODAL",{ns_id:this.props.syncNSId}),this.props.onMountSharedFolder(),this.setState({state:this.ASK}))},onSyncButtonClicked:function(){return this.setState({state:this.ASKING}),this.props.canRequestToJoin&&!this.props.outOfQuotaQP?this.activateRequestModal():this.requestCallback()},onPreviewButtonClicked:function(){var e;return null!=this.props.previewCallback?(L.log(this.userId,"UNMOUNTED_SEARCH_PREVIEW","SYNC_MODAL",{ns_id:this.props.syncNSId}),this.props.previewCallback()):(e=null!=this.props.previewUrl?A.parse(this.props.previewUrl):N.get_uri().removeQuery("sm"),e.updateQuery({from_sync_modal:!0}),N.redirect(e))},onRequestButtonClicked:function(){var e,t,n,s,r;return this.setState({state:this.ASKING}),P(["modules/clean/teams/membership_discovery_util"],(function(e){return function(t){return t.sendTeamRequest(e.state.ownerTeam.id,function(){return F.close()})}})(this)),t=(null!=(n=S.get_viewer().personal_user)?n.paid:void 0)?"plus":"basic",e={folder_size:this.props.usageNeeded,is_limited:null!=(s=this.state.ownerTeam)?s.is_limited:void 0,ns_id:this.props.syncNSId,receiver_plan_type:t,receiver_quota_remaining:this.props.usageRemaining,requested_team_id:null!=(r=this.state.ownerTeam)?r.id:void 0},p.logMagnetEvent("request_modal_OQ_CTA_click",e)},activateRequestModal:function(){if(this.props.canRequestToJoin)return P(["modules/clean/teams/membership_request_modal"],(function(e){return function(t){var n;return n=t.MembershipRequestModal,F.showInstance(U(n,{folderName:l.em_snippet(e.props.folderName,15),nsId:e.props.syncNSId,overQuotaQP:null!=e.props.outOfQuotaQP,quotaNeeded:e.props.usageNeeded,quotaRemaining:e.props.usageRemaining,requestCallback:e.requestCallback,senderName:e.props.senderName,team:e.state.ownerTeam}))}})(this))},componentDidMount:function(){var e,t,n,s,r;if(w.mark_time_to_interactive(),t=(null!=(n=S.get_viewer().personal_user)?n.paid:void 0)?"plus":"basic",this.props.canRequestToJoin&&(P(["modules/clean/teams/membership_discovery_util"],(function(e){return function(t){var n;return n=t.getDiscoverableTeamForFolder,e.setState({state:e.ASKING}),n(e.props.syncNSId,function(t){return e.setState({state:e.ASK,ownerTeam:t})})}})(this)),this.props.outOfQuotaQP&&(e={folder_size:this.props.usageNeeded,is_limited:null!=(s=this.state.ownerTeam)?s.is_limited:void 0,ns_id:this.props.syncNSId,receiver_plan_type:t,receiver_quota_remaining:this.props.usageRemaining,requested_team_id:null!=(r=this.state.ownerTeam)?r.id:void 0},p.logMagnetEvent("request_modal_OQ_open",e))),this.props.magnetControlLogging&&this.props.outOfQuotaQP)return e={folder_size:this.props.usageNeeded,ns_id:this.props.syncNSId,receiver_plan_type:t,receiver_quota_remaining:this.props.usageRemaining},p.logMagnetEvent("modal_OQ_open",e)}})})}.call(this),function(){define("modules/clean/sharing/shared_content_link_sync_utils",["external/react","modules/clean/ajax","modules/clean/api_v2/root_aware_client","modules/clean/browse_interface","modules/clean/multiaccount_login","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/clean/sharing/role_selector_modal","modules/clean/sharing/shared_content_link_sync_modal","modules/clean/sharing/ui_util","modules/clean/viewer","modules/core/browser","modules/core/exception","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m){var h,_,f,g,y,v,assert,b,S;return y=t.WebRequest,_=n.ApiV2RootAwareClient,f=o.FolderShareApiClient,h=i.ACCESS_LEVEL,b=d.sharingNotificationError,S=d.sharingNotificationSuccess,assert=u.assert,v=m.i18n_default_project("sharing")._,g={mountSharedFolder:function(e,t,n,o,i,l){var d,u,m,h,_,w;if(null==o&&(o=!1),null==i&&(i=null),null==l&&(l=!1),t){if(!c.get_viewer().is_role_signed_in(t))return void r.show_modal({role:t,on_success:function(){return g.mountSharedFolder(e,t,n)}})}else if(c.get_viewer().is_paired)return u=function(t){return n="PREVIEW_PAGE",g.mountSharedFolder(e,t,n)},void new a(u).show();return w=c.get_viewer(),t?_=w.get_uid_by_role(t):(assert(!w.is_paired,"role can not be unspecified for paired viewer"),_=w.get_user_ids()[0]),m=v("Adding to your Dropbox..."),w.is_paired&&(w.get_user_by_id(_).is_team?(m=v("Adding to your %(team_name)s Dropbox..."),m=m.format({team_name:w.team_name})):m=v("Adding to your personal Dropbox...")),S(m),h=function(e){var t,n,r;return n=e,null!=i&&(n+=i.ns_path),t=c.get_viewer().get_user_by_id(_),r=s.browse_uri_for_fq_path(t,n),r.updateQuery({from_scl_sync_modal:o}),p.redirect(r)},l?y({url:"/share_action/rejoin",subject_user:_,data:{ns_id:e},success:h,error:function(){return b(v("We were unable to complete your request."))}}):(d=new f({userId:_}),d.mount({contentId:e,origin:n}).then(function(e){return h(e.path_lower)}).catch(function(e){return b(e&&e.error&&"insufficient_quota"===e.error[".tag"]?v("Can’t add folder. Your Dropbox account is full."):v("We were unable to complete your request."))}))},showSharedContentSyncModal:function(t,n){var s,r,o;if(null!=t?t.sync_ns_id:void 0)return r="SYNC_MODAL",o=t.sync_owner_name||t.ownerName,s=g.mountSharedFolder.bind(null,t.sync_ns_id,t.sync_role,r,!0,n),l.showInstance(e.createElement(l,{accessLevel:t.access_level,canRequestToJoin:t.can_request_to_join,folderName:t.sync_folder_name,folderSize:t.sync_folder_size,magnetControlLogging:t.magnet_control,outOfQuotaQP:t.sync_out_of_quota_qp,usageRemaining:t.sync_usage_remaining,usageNeeded:t.sync_usage_needed,senderName:t.sync_sender_name,ownerName:o,targetFile:n,previewCallback:null!=n?p.redirect.bind(p,t.sync_preview_url):void 0,previewUrl:t.sync_preview_url,onMountSharedFolder:s,syncNSId:t.sync_ns_id,expProSharingOverquotaModal:t.expProSharingOverquotaModal,ownerProfilePhotoUrl:t.ownerProfilePhotoUrl}))},proSharingOverquotaModalExperiment:function(e,t,n,s){var r,o;return t.expProSharingOverquotaModal=s,"V1"===s||"V2"===s||"V3"===s?(r=new f({userId:n,client:new _}),o=t.nsId||t.sync_ns_id,r.listMembers({contentId:o}).then(function(e){var n,s,r,o,i;if(s=e.users.filter(function(e){return e.access_type===h.OWNER}),1===(null!=s?s.size:void 0))return r=s.entries().next().value,r[0],n=r[1],t.ownerName=null!=n&&null!=(o=n.account)?o.display_name:void 0,t.ownerProfilePhotoUrl=null!=n&&null!=(i=n.account)?i.profile_photo_url:void 0}).finally(function(){return e(t)})):e(t)}}})}.call(this),define("modules/clean/sharing/sharing_settings_constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MEMBER_POLICY="member_policy",t.DOWNLOAD_POLICY="download_policy",t.VIEWER_INFO_POLICY="viewer_info_policy",t.AUDIENCE_POLICY="audience",t.ACCESS_LEVEL_POLICY="access_level",t.FOLDER_LINK_AUDIENCE_POLICY="shared_link_policy",t.PASSWORD_POLICY="password",t.EXPIRY_POLICY="expiry",t.ACL_UPDATE_POLICY="acl_update_policy",t.DROPDOWN="dropdown",t.TOGGLE="toggle",t.PASSWORD_INPUT="password_input",t.EXPIRY_INPUT="expiry_input",t.FILE_SETTINGS="file_settings",t.FOLDER_SETTINGS="folder_settings",t.LINK_SETTINGS="link_settings"}),define("modules/clean/sharing/sharing_settings_dropdown",["require","exports","external/spectrum/dropdown_button","external/react","modules/clean/react/bubble_menu","modules/clean/react/sprite"],function(e,t,n,s,r,o){"use strict";function i(e){var t=e.customButton||s.createElement(n.DropdownButton,{className:"sharing-settings-dropdown__button"},s.createElement("span",{className:"sharing-settings-dropdown__button-label"},e.optionsDict[e.currentValue].label)),i=e.valuesList.map(function(t){var n=s.createElement("span",null);return t===e.currentValue&&(n=s.createElement(o,{alt:"",group:"web",name:"check_gray"})),s.createElement(r.BubbleMenuItem,{checked:t===e.currentValue,key:t,onClick:function(){return e.onValueSelected(t)}},s.createElement("div",{className:"sharing-settings-dropdown-item"},s.createElement("div",{className:"sharing-settings-dropdown-item__left-margin"},n),s.createElement("div",{className:"sharing-settings-dropdown-item__label"},s.createElement("div",{className:"sharing-settings-dropdown-item__title"},e.optionsDict[t].label),s.createElement("div",{className:"sharing-settings-dropdown-item__description u-font-meta"},e.optionsDict[t].description))))});return s.createElement(r.BubbleMenu,{targetButton:t,targetFixed:!0,position:e.openUp?r.BubbleMenu.POSITIONS.TOP_ALIGN_RIGHT:r.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,className:"sharing-settings-dropdown",items:i,shouldShowArrow:!1})}Object.defineProperty(t,"__esModule",{value:!0}),t.SettingDropdown=i}),define("modules/clean/sharing/sharing_settings_modal",["require","exports","tslib","external/classnames","external/react","external/underscore","modules/clean/datetime","modules/clean/em_string","modules/clean/filepath","modules/clean/previews/util","modules/clean/react/calendar","modules/clean/react_format","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/react/tabs/tab_nav","modules/clean/react/tabs/tab_util","modules/clean/sharing/components/button_group","modules/clean/sharing/constants","modules/clean/sharing/settings_modal_components","modules/clean/sharing/ui_util","modules/core/i18n","modules/clean/sharing/api/types/metadata","modules/clean/sharing/settings_modal/views/link_settings_tab","modules/clean/sharing/sharing_settings_dropdown","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/sharing_settings_util"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I,E,C,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M=S.i18n_default_project("sharing")._,T=r.createElement,A=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleTogglePasswordPolicy=function(e){n.props.onOptionChange(C.PASSWORD_POLICY,{status:e}),n.setState({passwordInputDisabled:"on"===n.props.currentPolicy.get(C.PASSWORD_POLICY).status})},n.handleChangePasswordClick=function(){n.setState({passwordInputDisabled:!1}),n.props.onOptionChange(C.PASSWORD_POLICY,{status:"on",value:""})},n.state={passwordInputDisabled:!0},n}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=o.extend({},this.props);return t=o.extend(t,{currentTab:this.state.currentTab,onChangePasswordClick:this.handleChangePasswordClick,onTabSelected:function(t){e.setState({currentTab:t})},onTogglePasswordPolicy:this.handleTogglePasswordPolicy,passwordInputDisabled:this.state.passwordInputDisabled}),T(k,t)},t})(r.Component);t.SharingSettingsModal=A;var P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDefaultProps=function(){return{hasDisplayableMembers:!1,hasNonOwnerMembers:!1}},t.prototype.componentDidUpdate=function(e){!this.props.passwordInputDisabled&&e.passwordInputDisabled&&this.refs.passwordInputRef&&this.refs.passwordInputRef.focus()},t.prototype.render=function(){var e;return e=this.props.isLoading?r.createElement("div",{className:"sharing-settings-modal__loading-text"},M("Loading...")):r.createElement("div",{className:"sharing-settings-modal"},this.renderHeader(),this.renderTabs(),this.renderTabContent(),r.createElement("div",{className:"sharing-settings-modal__footer"},this.renderButtons())),r.createElement(m.Modal,{altAction:this.props.altAction,style:"bare"},e)},t.prototype.renderHeader=function(){var e,t={folder_name:a.em_snippet(this.props.folderName,y.SNIPPET_SIZES.FILENAME)};return e=M("Settings for “%(folder_name)s”").format(t),r.createElement("div",{className:"sharing-settings-modal__header"},r.createElement("div",{className:"sharing-settings-modal__title-row"},r.createElement("div",{className:"u-l-b"},e)))},t.prototype.renderTabs=function(){return r.createElement(_,{tabs:this.getTabs(),onChange:this.props.onTabSelected,defaultSelectedIndex:0,variant:f.variants.UNDERLINE})},t.prototype.getTabs=function(){var e=this,t={value:C.FILE_SETTINGS,label:M("File settings")},n={value:C.FOLDER_SETTINGS,label:M("Folder settings")},s={value:C.LINK_SETTINGS,label:M("Link settings")},r=this.props.isFolder?[n]:[t];return!this.props.isTeamSharedFolder&&this.props.linkMetadata&&r.push(s),r.filter(function(t){return e.getTabInfo(t.value).policies.length>0})},t.prototype.getCurrentTab=function(){return this.props.currentTab||this.getTabs()[0].value},t.prototype.renderTabContent=function(){var e=this,t=this.getTabInfo(this.getCurrentTab());return r.createElement("div",null,t.banner,r.createElement("div",{className:"sharing-settings-modal__tab-content"},r.createElement("div",{className:"tab-content-header"},r.createElement("div",{className:"tab-content-header__description u-font-meta"},t.description)),r.createElement("div",null,t.policies.map(function(t){var n=e.getPolicyDict(t);return e.renderPolicy(t,n)}))))},t.prototype.getFolderSettingsBanner=function(){if(!this.props.shouldHideHeader&&this.props.isFolder){var e,t=M("These settings will apply to all folders inside “%(folder_name)s”.").format({folder_name:this.props.folderName});if(this.props.isInContentManager)e=t;else if(this.props.showContentManagerBridge){var n=l.parent_dir(this.props.folderPath),s=b.genContentManagerBridgeUri({containingFolder:n,isLimitedTeam:this.props.isLimitedTeam,filenameToSelect:this.props.folderName,isCDM:void 0});e=r.createElement("div",null,t,r.createElement("div",null,M("You can change these settings in the Admin Console.")+" ",r.createElement("a",{href:s.toString(),target:"_blank"},M("Open in new tab."))))}else if(this.isTeamFolderTree())e=r.createElement("div",null,t,r.createElement("div",null,r.createElement("a",{href:"/team",target:"_blank"},M("To edit, ask your admin."))));else{if(this.props.permissions.change_options.allow)return;e=M("You don’t have permission to change the settings on this folder.")}return r.createElement("div",{className:"sharing-settings-modal__banner u-font-center"},e)}},t.prototype.isTeamFolderTree=function(){return this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree},t.prototype.getMemberPolicyQuestion=function(){return M(this.isTeamFolderTree()?"Who can be added to folders?":"Who can be invited to this folder?")},t.prototype.getAclUpdatePolicyQuestion=function(){return M(this.isTeamFolderTree()?"Who can invite new members and create a link to folders?":"Who can invite new members and create a link to this folder?")},t.prototype.getDownloadsPolicyDescription=function(){return M(this.isTeamFolderTree()?"Lets people download the folders. People with edit access can always download.":this.props.isFolder?"Lets people download this folder. People with edit access can always download.":"Lets people download this file. People with edit access can always download.")},t.prototype.getViewerInfoPolicyDescription=function(){if(d.is_pass_enabled(this.props.user)||!this.props.ownerTeam)return M(this.props.isFolder?"Shows who viewed the files.":"Shows who viewed the file.");var e=void 0;return e=M(this.props.isFolder?"Shows who viewed the files. Only members of %(team_name)s and people who can edit can see this info.":"Shows who viewed the file. Only members of %(team_name)s and people who can edit can see this info."),e.format({team_name:this.props.ownerTeam.name})},t.prototype.getFolderSettingPolicies=function(){var e=[];return Boolean(this.props.ownerTeam)&&(e.push(C.FOLDER_LINK_AUDIENCE_POLICY),e.push(C.MEMBER_POLICY)),e.push(C.ACL_UPDATE_POLICY),this.canChangePolicy(C.DOWNLOAD_POLICY)&&e.push(C.DOWNLOAD_POLICY),y.PASS_CONTROL_AVAILABILITY.SHOW_FOLDER_SETTINGS&&e.push(C.VIEWER_INFO_POLICY),e},t.prototype.getFileSettingPolicies=function(){var e=[];this.canChangePolicy(C.DOWNLOAD_POLICY)&&e.push(C.DOWNLOAD_POLICY);var t=h.getPassPermissions(this.props.contentId),n=d.is_pass_ga_receive_enabled(this.props.user)&&null!=t&&h.getPassPermissions(this.props.contentId).canReadPresence;return(d.is_pass_enabled(this.props.user)||n)&&e.push(C.VIEWER_INFO_POLICY),e},t.prototype.canChangePolicy=function(e){return this.props.getEffectivePolicyValue(e,this.props.policyUpdate)[1]},t.prototype.getMemberPolicyTeamLabel=function(){return M("Only members of %(team_name)s").format({team_name:a.em_snippet(this.props.ownerTeam.name,3,1)})},t.prototype.getAclUpdatePolicyEditorsLabel=function(){return this.props.ownerTeam?M("Members on %(team_name)s with edit access").format({team_name:a.em_snippet(this.props.ownerTeam.name,12)}):M("Members with edit access")},t.prototype.getAclUpdatePolicyEditorsDescription=function(){return this.props.ownerTeam?M("Any member of %(team_name)s with edit access to this folder.").format({team_name:a.em_snippet(this.props.ownerTeam.name,12)}):M("Anyone with edit access to this folder.")},t.prototype.getPolicyDict=function(e){var t=this;switch(e){case C.MEMBER_POLICY:return{title:M("Membership"),description:this.getMemberPolicyQuestion(),optionsDict:{team:{label:this.getMemberPolicyTeamLabel()},anyone:{label:M("Anyone")}},
optionsList:["anyone","team"],type:C.DROPDOWN};case C.ACL_UPDATE_POLICY:return{title:M("Management"),description:this.getAclUpdatePolicyQuestion(),optionsDict:{owner:{label:M(this.isTeamFolderTree()?"Only Team Admins":"Only the owner"),description:M(this.isTeamFolderTree()?"Only Team Admins.":"Only the owner of this folder.")},editors:{label:this.getAclUpdatePolicyEditorsLabel(),description:this.getAclUpdatePolicyEditorsDescription()}},optionsList:["editors","owner"],type:C.DROPDOWN};case C.DOWNLOAD_POLICY:return{title:M("Downloads"),description:this.getDownloadsPolicyDescription(),optionsDict:{allow:{label:M("On")},disallow:{label:M("Off")}},optionsList:["allow","disallow"],type:C.TOGGLE};case C.VIEWER_INFO_POLICY:return{title:M("Viewer info"),description:this.getViewerInfoPolicyDescription(),optionsDict:{enabled:{label:M("On")},disabled:{label:M("Off")}},optionsList:["enabled","disabled"],type:C.TOGGLE};case C.AUDIENCE_POLICY:return{title:M("Link access"),description:M("Who can open the shared link?"),optionsDict:N.getAudienceOptionsDict(this.props.isFolder,this.props.ownerTeam&&this.props.ownerTeam.name,this.props.hasNonOwnerMembers,this.props.hasDisplayableMembers),optionsList:this.props.linkMetadata.audience_options.valueSeq().toArray(),type:C.DROPDOWN,extras:function(e){return t.renderAudiencePolicyExtras(e)}};case C.ACCESS_LEVEL_POLICY:return{title:M("Link permission"),description:M("What can users with links do?"),optionsDict:{viewer:{label:M("Can comment"),description:M("Lets them view and comment, but not edit.")},viewer_no_comment:{label:M("Can view"),description:M("Lets them view only. They can’t see comments.")}},optionsList:["viewer","viewer_no_comment"],type:C.DROPDOWN};case C.FOLDER_LINK_AUDIENCE_POLICY:if(!this.props.ownerTeam)throw new Error("Policy only valid for teams");return{title:M("Link restrictions"),description:M("Limits who can access this folder via a link."),optionsDict:{anyone:{label:M("No restrictions"),description:M("Show all access options for links.")},team:{label:M("Team and invite-only"),description:M("Show “Only people at %(team_name)s” and “Only                               invited members.”").format({team_name:a.em_snippet(this.props.ownerTeam.name,12)})},members:{label:M("Invite-only"),description:M("Show “Only invited members” only.")}},optionsList:["anyone","team","members"],type:C.DROPDOWN};case C.PASSWORD_POLICY:return{title:M("Password protection"),description:M("Add a password to the shared link"),optionsDict:{on:{label:M("On")},off:{label:M("Off")}},optionsList:["on","off"],type:C.PASSWORD_INPUT};case C.EXPIRY_POLICY:return{title:M("Expiration"),description:M("Disables the shared link on a specific date"),optionsDict:{on:{label:M("On")},off:{label:M("Off")}},optionsList:["on","off"],type:C.EXPIRY_INPUT};default:throw new Error("Policy name not found")}},t.prototype.getFolderSettingsDescription=function(){return M(this.isTeamFolderTree()?"Only team admins can change these settings":this.canChangePolicy(C.ACL_UPDATE_POLICY)?"Only you (the owner) can change these settings.":"Only the owner can change these settings.")},t.prototype.getTabInfo=function(e){switch(e){case C.FILE_SETTINGS:return{title:M("File settings"),banner:void 0,description:"",policies:this.getFileSettingPolicies()};case C.FOLDER_SETTINGS:return{title:M("Folder settings"),banner:this.getFolderSettingsBanner(),description:this.getFolderSettingsDescription(),policies:this.getFolderSettingPolicies()};case C.LINK_SETTINGS:var t="owner"===this.props.currentPolicy.get(C.ACL_UPDATE_POLICY)&&this.canChangePolicy(C.AUDIENCE_POLICY);return{title:I.TabName(),banner:r.createElement(I.Banner,{linkMetadata:this.props.linkMetadata,user:this.props.user}),description:r.createElement(I.Description,{aclUpdatePolicy:this.props.currentPolicy.get(C.ACL_UPDATE_POLICY),isTeamFolderTree:this.isTeamFolderTree(),ownerTeam:this.props.ownerTeam,userIsOwner:t}),policies:I.getPolicies(this.props.user)};default:throw new Error("tabName not found")}},t.prototype.renderPolicy=function(e,t){var n,o,i=this,a=t.title,l=t.description,d=t.optionsDict,c=t.optionsList,p=t.type,u=t.extras,m=void 0===u?null:u;f=this.props.getEffectivePolicyValue(e,this.props.policyUpdate),n=f[0],o=f[1];var h;if(p===C.DROPDOWN)h=r.createElement(E.SettingDropdown,{currentValue:n,valuesList:c,optionsDict:d,onValueSelected:function(t){return i.props.onOptionChange(e,t)}});else if(p===C.TOGGLE)h=r.createElement(g.ButtonGroup,{options:this.getButtonGroupOptions(c,d),value:n,onSelectValue:function(t){return i.props.onOptionChange(e,t)}});else if(p===C.PASSWORD_INPUT)h=this.renderPasswordInput(e,n,d,c);else{if(p!==C.EXPIRY_INPUT)throw new Error("Selector type not found");h=this.renderExpiryInput(e,n,d,c)}var _=r.createElement("div",null);return m&&(_=m(n)),r.createElement("div",{className:s({policy:!0,"policy--no-permissions":!o})},r.createElement("div",{className:"policy__left"},r.createElement("div",{className:"policy__title"},a),r.createElement("div",{className:"policy__description u-font-meta"},l)),r.createElement("div",{className:"policy__selector"},h),r.createElement("div",{className:"policy__extras"},_));var f},t.prototype.renderAudiencePolicyExtras=function(e){var t=this.props.linkMetadata,n=r.createElement("div",null);if(t.audience_restricting_shared_folder&&t.audience_restricting_shared_folder.audience===e){var s=void 0,o=t.audience_restricting_shared_folder.name;s=1===t.audience_options.size?p.reactFormat(M("This setting is applied via a parent folder.              To change access, go to <strong>%(folder_name)s</strong> link settings."),{folder_name:o,strong:r.createElement("strong",null)}):p.reactFormat(M("This setting is limited via a parent folder.              To see more options, go to <strong>%(folder_name)s</strong> link settings."),{folder_name:o,strong:r.createElement("strong",null)}),n=r.createElement("div",{className:"policy__graybox"},s)}else this.props.isFolder&&e!==w.LinkAudience.members&&(n=r.createElement("div",{className:"policy__audience-extras"},M("Applies to all items in this folder")));return n},t.prototype.renderPasswordInput=function(e,t,n,s){var o=this,i=t,a=r.createElement("div",null);if("on"===i.status){var l=r.createElement("div",null);this.props.passwordInputDisabled&&this.props.linkMetadata.link_permissions.set_password.allow&&(l=r.createElement("button",{className:"password-input__change-button button-as-link",onClick:this.props.onChangePasswordClick},"Change")),a=r.createElement("div",{className:"password-input u-pad-top-s"},r.createElement("label",{htmlFor:"password-input"},"Password:"),r.createElement("br",null),r.createElement("input",{autoFocus:!0,className:"c-input password-input__input",disabled:this.props.passwordInputDisabled,id:"password-input",onChange:function(t){o.props.onOptionChange(e,{status:"on",value:t.target.value})},placeholder:M("Enter a new password"),ref:"passwordInputRef",type:"password",value:this.props.passwordInputDisabled?123456:i.value||""}),l)}return r.createElement("div",null,r.createElement(g.ButtonGroup,{options:this.getButtonGroupOptions(s,n),value:i.status,onSelectValue:this.props.onTogglePasswordPolicy}),a)},t.prototype.renderExpiryInput=function(e,t,n,s){var o=this,a=t,l=r.createElement("div",null),d=i.daysAfterToday(30);return"on"===a.status&&(l=r.createElement("div",{className:"u-pad-top-s"},r.createElement("div",null,M("Link deactivates on:")),r.createElement(c.Calendar,{alignAtLeft:!1,disabled:!this.props.linkMetadata.link_permissions.set_expiry.allow,firstDay:i.daysAfterToday(1),initDate:a.value?new Date(a.value):d,lastDay:i.daysAfterToday(365),onDateChange:function(t){return o.props.onOptionChange(e,{status:"on",value:t})}}))),r.createElement("div",null,r.createElement(g.ButtonGroup,{options:this.getButtonGroupOptions(s,n),value:a.status,onSelectValue:function(t){o.props.onOptionChange(e,{status:t,value:a.value||d})}}),l)},t.prototype.getButtonGroupOptions=function(e,t){return e.map(function(e){return{value:e,label:t[e].label}})},t.prototype.allowSaveSettings=function(){return!(!this.props.policyUpdate||0===o.keys(this.props.policyUpdate).length)&&!(this.props.policyUpdate.password&&"on"===this.props.policyUpdate.password.status&&!this.props.passwordInputDisabled&&(!this.props.policyUpdate.password.value||""===this.props.policyUpdate.password.value))},t.prototype.renderButtons=function(){var e;if(this.props.permissions.unshare.allow&&(this.props.isSharedFolder||!this.props.isFolder)){var t=void 0;t=M(this.props.isFolder?this.props.isFolderInsideTeamFolderTree?"Reset membership":"Unshare folder":"Unshare file"),e=r.createElement("div",{className:"u-l-fl"},r.createElement("button",{className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.onUnshare},t))}return r.createElement("div",{className:"clearfix sharing-settings-modal__buttons"},e,r.createElement(v.SettingsModalButtons,{disableSave:!this.allowSaveSettings(),isAccepting:this.props.isSubmitting,onAccept:this.props.onSaveSettings,onDismiss:this.props.onDismiss}))},t})(r.Component);t.SharingSettingsModalContentsView=P;var k=u(P,["/static/css/sharing/share_modal-vflqUEM1t.css"])}),define("modules/clean/sharing/sharing_settings_util",["require","exports","external/react","modules/clean/em_string","modules/clean/react_format","modules/clean/sharing/sharing_settings_constants","modules/core/i18n"],function(e,t,n,s,r,o,i){"use strict";function a(e,t,n,s,r,i){switch(e){case o.AUDIENCE_POLICY:return s&&s.link_permissions.change_audience.allow&&s.audience_options.size>1;case o.PASSWORD_POLICY:return s&&"members"!==n.get(o.AUDIENCE_POLICY)&&(s.link_permissions.set_password.allow||s.link_permissions.remove_password.allow&&"off"!==t.get(o.PASSWORD_POLICY).status);case o.EXPIRY_POLICY:return s&&"members"!==n.get(o.AUDIENCE_POLICY)&&(s.link_permissions.set_expiry.allow||s.link_permissions.remove_expiry.allow&&"off"!==t.get(o.EXPIRY_POLICY).status);case o.DOWNLOAD_POLICY:return!(!r||i)&&("allow"===t.get(o.DOWNLOAD_POLICY)?r.set_download_policy&&r.set_download_policy.allow:r.remove_download_policy&&r.remove_download_policy.allow);case o.VIEWER_INFO_POLICY:return!(!r||i)&&("enabled"===t.get(o.VIEWER_INFO_POLICY)?r.disable_viewer_info&&r.disable_viewer_info.allow:r.enable_viewer_info&&r.enable_viewer_info.allow);default:throw new Error("Link policy not found")}}function l(e){switch(e){case"restricted_by_parent_folder":return u("This setting is turned off for all files in this folder.");case"restricted_by_team":return u("Your admin has disabled this setting.");default:return}}function d(e,t){return"enabled"===e.get(o.VIEWER_INFO_POLICY)?t.disable_viewer_info?l(t.disable_viewer_info.reason):void 0:t.enable_viewer_info?l(t.enable_viewer_info.reason):void 0}function c(e){return[o.AUDIENCE_POLICY,o.DOWNLOAD_POLICY,o.EXPIRY_POLICY,o.VIEWER_INFO_POLICY,o.PASSWORD_POLICY].indexOf(e)!==-1}function p(e,t,o,i){var a,l,d=i&&!o;return d?(a=u("Only you"),l=u(e?"Only you can access this folder.":"Only you can access this file.")):(a=u("Invited members"),l=e?r.reactFormat(u("<strong>Most secure.</strong> Only those specifically invited can access this folder."),{strong:n.DOM.strong()}):r.reactFormat(u("<strong>Most secure.</strong> Only those specifically invited can access this file."),{strong:n.DOM.strong()})),{public:{label:u("Anyone with the link"),description:u(e?"Anyone who has the link can access this folder.":"Anyone who has the link can access this file.")},team:{label:u("Members of %(team_name)s").format({team_name:s.em_snippet(t||"",6,1)}),description:e?u("Only members of %(team_name)s and invited members can access this folder.").format({team_name:t}):u("Only members of %(team_name)s and invited members can access this file.").format({team_name:t})},members:{label:a,description:l}}}Object.defineProperty(t,"__esModule",{value:!0});var u=i.i18n_default_project("sharing")._;t.canChangePolicy=a,t.denyReasonToDenyString=l,t.getPassDenyReason=d,t.isCommonSharingSettingsPolicy=c,t.getAudienceOptionsDict=p}),function(){define("modules/clean/sharing/strings",["modules/clean/sharing/constants","modules/core/i18n"],function(e,t){var n,s,r,o,i,a,l,d,c,p,u,m,h,_,f;return n=e.ACCESS_LEVEL,o=e.MEMBER_ACTION,c=t.i18n_default_project("sharing")._,p={},p[""+n.OWNER]=c("Owner"),p[""+n.WRITER]=c("Can edit"),p[""+n.READER]=c("Can view"),p[""+n.READER_NO_COMMENT]=c("View-only"),s=p,u={},u[""+n.OWNER]=c("Owner"),u[""+n.WRITER]=c("Can edit"),u[""+n.READER]=c("Can comment"),u[""+n.READER_NO_COMMENT]=c("Can view"),r=u,m={},m[""+o.MAKE_EDITOR]=c("People can edit, delete, comment, and add the file to their Dropbox"),m[""+o.MAKE_VIEWER]=c("People can view, download, and comment"),m[""+o.MAKE_VIEWER_NO_COMMENT]=c("People can only view and download the files"),l=m,h={},h[""+o.MAKE_EDITOR]=c("People can edit, delete, comment, and add the files to their Dropbox"),h[""+o.MAKE_VIEWER]=c("People can view, download, and comment"),h[""+o.MAKE_VIEWER_NO_COMMENT]=c("People can only view and download the file"),i=h,_={},_[""+o.MAKE_EDITOR]=c("Lets them view, comment, and edit."),_[""+o.MAKE_VIEWER]=c("Lets them view and comment, but not edit."),_[""+o.MAKE_VIEWER_NO_COMMENT]=c("Lets them view only. They can’t see comments."),d=_,f={},f[""+o.MAKE_EDITOR]=c("Lets them view, comment, and edit."),f[""+o.MAKE_VIEWER]=c("Lets them view and comment, but not edit."),f[""+o.MAKE_VIEWER_NO_COMMENT]=c("Lets them view only. They can’t see comments."),a=f,{ACCESS_NAME:s,ACCESS_NAME_NO_COMMENT:r,MEMBER_ACTION_FOLDER:l,MEMBER_ACTION_FILE:i,MEMBER_ACTION_FOLDER_NO_COMMENT:d,MEMBER_ACTION_FILE_NO_COMMENT:a}})}.call(this),function(){define("modules/clean/sharing/views/comments_help",["external/classnames","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s,r,o,i){var a,l,d,c,p;return p=o.static_url,l=i._,d=t.createElement,c=t.DOM,a=t.createClass({displayName:"ShareModalCommentsHelp",mixins:[t.addons.PureRenderMixin],propTypes:{onClose:t.PropTypes.func.isRequired,onButtonClick:t.PropTypes.func.isRequired,isFeedbackRequest:t.PropTypes.bool},renderText:function(){return this.props.isFeedbackRequest?[c.h1({key:"heading"},l("Get feedback on your work")),c.p({key:"content"},l("This will ask recipients to leave comments on your file and post your message as a comment."))]:c.p({},l("New! You can now post your message as a comment on the file. Anyone who views this file can see this comment."))},render:function(){return c.div({className:e(["bubble-dropdown","right-bottom","u-font-center","u-pad-m","u-l-b","comments-help-dialog"])},c.div({className:"close-button u-font-right"},d(r,{onClick:this.props.onClose})),d(s,{src:p("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:p("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),this.renderText(),c.button({className:"c-btn c-btn--primary",onClick:this.props.onButtonClick},l("Try it out")),c.div({className:"bubble-arrow-border"}),c.div({className:"bubble-arrow"}))}}),a=n(a,["/static/css/legacy_packages/components-vflfWNhxV.css"])})}.call(this),define("modules/clean/sharing/views/exp_share_link_upsell",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/core/i18n","modules/clean/react_format","modules/clean/static_urls","modules/constants/python","modules/constants/payments"],function(e,t,n,s,r,o,i,a,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=c.OUT_OF_SPACE_URL+"?oqa=sf_sloq";return s.createElement("div",{className:"share-link-upgrade__content"},s.createElement(o,{className:"unified-share-modal__illo",src:l.static_url("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:l.static_url("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),s.createElement("div",{className:"share-link-upgrade__footer"},s.createElement("div",{className:"share-link-upgrade__footer-content"},s.createElement("p",{className:"u-mar-top-s share-link-upgrade__copy"},a.reactFormat(i._("Get %(trademark_plus)s to add more shared content to your Dropbox."),{trademark_plus:d.TRADEMARK_PLUS})),s.createElement("a",{className:"c-btn c-btn--primary subgrowth_pro_overquota_create_shared_link",href:e},i._("Upgrade")))))},t})(s.Component);t.ExpShareLinkUpsellV1=r(p,["/static/css/sharing/exp_oq_shared_link_upsellV1-vflBUzAf2.css"]),t.ExpShareLinkUpsellV2=r(p,["/static/css/sharing/exp_oq_shared_link_upsellV2-vflI1ituq.css"])}),define("modules/clean/sharing/views/inherited_members",["require","exports","tslib","external/classnames","external/react","modules/clean/em_string","modules/clean/filepath","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react_format","modules/clean/sharing/constants","modules/clean/undo","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=r.createElement,h=(function(e){function t(t){var n=e.call(this,t)||this;return n.onToggleShowMemberList=function(){0!==n.props.members.length&&n.setState({areMembersExpanded:!n.state.areMembersExpanded})},n.state={areMembersExpanded:!1},n}return n.__extends(t,e),t.prototype.renderMembersList=function(){return this.state.areMembersExpanded?r.createElement("div",null,r.createElement("div",{className:"u-mar-top-xs u-mar-horizontal-xs u-pad-top-xs inherited-member-list__divider"}),r.createElement("div",null,r.createElement("ul",{className:"u-pad-horizontal-s u-pad-vertical-xs inherited-member-list__member"},this.props.children))):void 0},t.prototype.renderRemoveButton=function(){return this.props.canUpdateConfidentiality?r.createElement("button",{className:"inherited-member-list__remove-button button-as-link",onClick:this.props.onSetConfidentialClick},u._("Remove",{comment:"Shown on button that can be clicked to remove access to subfolder"})):void 0},t.prototype.renderTriangle=function(){return 0===this.props.members.length?r.createElement("div",{className:"u-pad-horizontal-xs"}):r.createElement("a",{href:"#",className:"u-pad-horizontal-xxs o-flag__fix inherited-member-list__triangle",onClick:this.onToggleShowMemberList},m(l,{alt:u._("Toggle whether inherited members are displayed or hidden"),group:"web",name:this.state.areMembersExpanded?"triangle_open_1x":"triangle_closed_1x"}))},t.prototype.render=function(){var e,t=i.parent_dir(this.props.contentInfo.displayPath());if("/"===t)e=u._("Members of %(team_name)s shared workspace").format({team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME)});else{var n=i.filename(t);e=u._("Members of “%(folder_name)s” folder").format({folder_name:o.em_snippet(n,c.SNIPPET_SIZES.FILENAME)})}var a=this.props.members.length,d=u.ungettext("%(members_count)s member","%(members_count)s members",a).format({members_count:a}),p=s([{"u-mar-bottom-xs":!0,"inherited-member-list__outer-expanded":this.state.areMembersExpanded,"inherited-member-list__outer-closed":!this.state.areMembersExpanded}]),h=s([{"inherited-member-list__inner":!this.state.areMembersExpanded}]);return r.createElement("div",{className:p},r.createElement("div",{className:h},r.createElement("div",{className:"o-flag inherited-member-list__toggle-show-member",onClick:this.onToggleShowMemberList},this.renderTriangle(),r.createElement("div",{className:"o-flag__flex u-pad-vertical-xs u-pad-right-s"},r.createElement("div",{className:"o-flag"},r.createElement("div",{className:"o-flag__fix"},m(l,{alt:"",className:"unified-share-modal__title-icon",group:"web",name:"folder_user_32"})),r.createElement("div",{className:"o-flag__flex u-pad-left-s"},r.createElement("div",{className:"inherited-member-list__member-str u-font-strong"},e),r.createElement("div",{className:"inherited-member-list__member-count-str u-font-meta"},d)),r.createElement("div",{className:"o-flag__fix u-pad-right-xxs"},this.renderRemoveButton())))),r.createElement("div",null,this.renderMembersList())))},t})(r.Component);t.InheritedMembers=h;var _=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={isAccepting:!1},n}return n.__extends(t,e),t.prototype.renderContent=function(e,t,n){var s;return s=this.props.initialIsConfidentialFolder?e?d.reactFormat(u._("<strong>%(folder_name)s</strong> won’t be shared privately any more.\n             Everyone at %(team_name)s will have access to this folder.").format({team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME),folder_name:o.em_snippet(n,15)}),{strong:r.createElement("strong",{style:{fontWeight:500}})}):d.reactFormat(u._("Everyone who can access <strong>%(parent_folder_name)s</strong> will be able to access this folder.").format({parent_folder_name:o.em_snippet(t,15)}),{strong:r.createElement("strong",{style:{fontWeight:500}})}):e?d.reactFormat(u._("Members of %(team_name)s won’t be able to access <strong>%(folder_name)s</strong>.").format({team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME),folder_name:o.em_snippet(n,15)}),{strong:r.createElement("strong",{style:{fontWeight:500}})}):d.reactFormat(u._("Members of <strong>%(parent_folder_name)s</strong> folder won’t be able to access\n             <strong>%(folder_name)s</strong>.").format({parent_folder_name:o.em_snippet(t,15),folder_name:o.em_snippet(n,15)}),{strong:r.createElement("strong",{style:{fontWeight:500}})}),r.createElement("div",null,r.createElement("div",{className:"confirmation-modal__content"},s),r.createElement("br",null))},t.prototype.renderButtons=function(e,t,n){var s=this,i=o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME),a=e?u._("Share with %(team_name)s").format({team_name:i}):u._("Share"),l=this.props.initialIsConfidentialFolder?a:u._("Remove");return r.createElement("div",{className:"u-l-fr"},r.createElement("button",{className:"c-btn c-btn--primary confirmation-modal__action",disabled:this.state.isAccepting,onClick:function(){return s.onToggleConfidentialFolder(!0,e,t,n)}},l),r.createElement("button",{className:"c-btn c-btn--secondary u-mar-left-xs confirmation-modal__cancel",onClick:this.props.onCancel},u._("Cancel")))},t.prototype.onToggleConfidentialFolder=function(e,t,n,s){var r=this;e?(this.setState({isAccepting:!0}),this.props.actionHandler.handleSetConfidential(!this.props.initialIsConfidentialFolder).then(function(e){r.props.onUpdateConfidentiality(e);var i;i=r.props.initialIsConfidentialFolder?t?u._("“%(folder_name)s” shared with %(team_name)s.").format({folder_name:o.em_snippet(s,15),team_name:o.em_snippet(r.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME)}):u._("“%(folder_name)s” shared with members of “%(parent_folder_name)s”.").format({folder_name:o.em_snippet(s,15),parent_folder_name:o.em_snippet(n,15)}):t?u._("Members of %(team_name)s removed from “%(folder_name)s”.").format({team_name:o.em_snippet(r.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME),folder_name:o.em_snippet(s,15)}):u._("Members of “%(parent_folder_name)s” folder removed from “%(folder_name)s”.").format({parent_folder_name:o.em_snippet(n,15),folder_name:o.em_snippet(s,15)}),p.notifyWithUndo(i,{confidential:r.props.initialIsConfidentialFolder},function(){return r.onToggleConfidentialFolder(!1)},10,u._("Undo"))})):this.props.actionHandler.handleSetConfidential(this.props.initialIsConfidentialFolder).then(function(e){return r.props.onUpdateConfidentiality(e)})},t.prototype.render=function(){var e,t,n,s=this.props.contentInfo.displayPath(),l=i.parent_dir(s),d=i.filename(s);return"/"===l?t=!0:(t=!1,n=i.filename(l)),e=this.props.initialIsConfidentialFolder?t?u._("Share “%(folder_name)s” with everyone at %(team_name)s?").format({folder_name:o.em_snippet(d,15),team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME)}):u._("Share “%(folder_name)s” with everyone who can access “%(parent_folder_name)s”?").format({folder_name:o.em_snippet(d,15),parent_folder_name:o.em_snippet(n,15)}):t?u._("Remove members of %(team_name)s?").format({team_name:o.em_snippet(this.props.teamName,c.SNIPPET_SIZES.DISPLAY_NAME)}):u._("Remove members of “%(folder_name)s” folder?").format({folder_name:o.em_snippet(n,15)}),r.createElement(a.Modal,{autoClose:!1,buttonComponent:r.createElement("span",null),onDismissCompleted:this.props.onCancel,title:e},this.renderContent(t,n,d),this.renderButtons(t,n,d))},t})(r.Component);t.SetInheritedMembersUIConfidentialModal=_}),define("modules/clean/sharing/views/member_list",["require","exports","tslib","external/immutable","external/react","modules/clean/sharing/api/types/metadata","modules/clean/sharing/views/inherited_members","modules/clean/sharing/views/member_list_item","modules/clean/sharing/views/viewer_info","modules/clean/sharing/ui_util","modules/clean/viewer","modules/core/i18n","modules/clean/sharing/views/wrapped_group_viewers_maker","modules/clean/react/pass/store"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=p.i18n_default_project("sharing")._,_=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderMembersListItem=function(e){var n=e.memberKey(),s=t.props.groupSeenStateInfo[e.memberId()]?t.renderWrappedGroupViewersElement(e):void 0;return r.createElement(a.SharingMemberListItem,{actionHandler:t.props.actionHandler,canInviteMembers:t.props.canInviteMembers,canMakeViewerNoComment:t.props.canMakeViewerNoComment,canRelinquishMembership:t.props.canRelinquishMembership,contentInfo:t.props.contentInfo,disabled:t.props.disabled,wrappedGroupViewersElement:s,isMemberActionPending:t.props.pendingMemberAction.has(n),isPresent:t.props.shouldShowPassUI&&t.isMemberCurrentlyViewing(e),key:n,member:e,user:t.props.user})},t}return n.__extends(t,e),t.prototype.render=function(){var e=d.makeMemberSortCmp(this.props.user,this.props.presentAccountIds||s.Set(),this.shouldSortUsingPassRules()),t=this.membersByInheritance(),n=t.get(!1);n&&(n=n.sort(e));var o=t.get(!0);o&&(o=o.sort(e));var i=null;return this.props.areMembersFullyLoaded||(i=r.createElement("div",{className:"sharing-member-list__loading c-loader u-mar-horizontal-auto u-l-b"},h("Loading more members..."))),r.createElement("div",{className:"sharing-member-list"},this.renderInheritedUI(n,o),i)},t.prototype.shouldSortUsingPassRules=function(){var e=m.getPassPermissions(this.props.contentInfo.id);return null!=e&&(e.canReadPresence||e.canReadSeenState)},t.prototype.renderInheritedUI=function(e,t){var n=null;this.props.user.is_cdm_member&&!this.props.isConfidentialFolder&&this.props.isFolderInsideTeamFolderTree&&(n=r.createElement(i.InheritedMembers,{canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,members:t?t.toArray():[],onSetConfidentialClick:this.props.onSetConfidentialClick,teamName:this.props.teamName},t?t.map(this.renderMembersListItem):null));var s=null;return e&&e.count()>0&&(s=r.createElement("div",{className:"u-pad-horizontal-s"},e.map(this.renderMembersListItem).toArray())),r.createElement("ul",{className:"o-list-ui u-trim-margin u-pad-horizontal-xs"},n,s)},t.prototype.isMemberCurrentlyViewing=function(e){return!this.memberIsAssumed(e)&&(e instanceof o.UserMembershipInfo&&this.props.presentAccountIds&&this.props.presentAccountIds.has(e.account_id))},t.prototype.memberIsAssumed=function(e){return e instanceof o.UserMembershipInfo&&e.account_id===this.props.user.account_id&&c.get_viewer().is_assume_user_session},t.prototype.membersByInheritance=function(){var e=this,t=function(t){return e.shouldSortByInherited()&&t.is_inherited};return this.props.membership?this.props.membership.groups.valueSeq().concat(this.props.membership.invitees.valueSeq(),this.props.membership.users.valueSeq(),this.props.guestMembers).groupBy(t):this.props.guestMembers.length>0?s.List(this.props.guestMembers).groupBy(t):s.Map()},t.prototype.shouldSortByInherited=function(){return this.props.user.is_cdm_member&&!!this.props.isFolderInsideTeamFolderTree},t.prototype.extractGroupSeenStateAndViewers=function(e){var t=this,n=this.props.groupSeenStateInfo[e.memberId()],s=[];return this.props.presentAccountIds&&(s=n.map(function(e){return new l.ViewerInfo(e)}).filter(function(e){return null!=e.time_last_seen||t.props.presentAccountIds.has(e.account_id)})),{singleGroupSeenStateInfo:n,viewers:s}},t.prototype.renderWrappedGroupViewersElement=function(e){var t=this.extractGroupSeenStateAndViewers(e).viewers;return t.length?u.WrappedGroupViewersMaker.make(t,this.props.presentAccountIds):{element:null,elementText:""}},t})(r.Component);_.displayName="SharingMemberList",_.defaultProps={disabled:!1,groupSeenStateInfo:{}},t.SharingMemberList=_}),define("modules/clean/sharing/views/member_list_item",["require","exports","tslib","external/classnames","external/react","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size","modules/clean/datetime","modules/clean/em_string","modules/clean/react/title_bubble","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/views/sharing_bubble_menu","modules/clean/sharing/views/viewer_info","modules/clean/static_urls","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=f.i18n_default_project("sharing"),v=y._,b=y.ungettext,S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.shouldLinkToGroup=function(){return this.props.member instanceof p.GroupMembershipInfo&&(!!this.props.member.same_team&&(!!this.props.user.is_team_admin||!!this.props.member.is_member&&this.props.member.group_management_type!==p.GroupManagementType.system_managed))},t.prototype.linkToGroup=function(e,t){var n="/team#groups/%(id)s".format({id:e.group_id});return r.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"sharing-member-info__group-name-link sharing-member-info__display-name-title",title:e.group_name},t)},t.prototype.renderAvatar=function(e,t){var n,s=this.props.member.displayName()||"";this.props.member instanceof h.ViewerInfo||(n=this.props.member.initials),n=n||g.getInitials(s);var l=t?"SQUARE":"CIRCLE";return r.createElement("div",{className:"o-flag__fix"},r.createElement(o,{dimension:a.AVATAR_DIMENSION_BY_SIZE.MEDIUM,photoUrl:e,shape:l,defaultAvatar:r.createElement(i,{dimension:a.AVATAR_DIMENSION_BY_SIZE.MEDIUM,shape:l,initials:n,name:s})}))},t.prototype.renderNameTitleAndText=function(e,t,n){return e?this.shouldLinkToGroup()&&!this.shouldRenderGroupCount()?this.linkToGroup(this.props.member,n):r.createElement("span",{className:"sharing-member-info__display-name-title",title:t},n):null},t.prototype.renderDisabledMessage=function(e){return e?[r.createElement("span",{className:"u-font-meta dot"},"·"),r.createElement("span",{className:"u-font-danger"}," ",e)]:null},t.prototype.renderSeenState=function(e){if(e){var t=s({"u-font-meta":!0,"sharing-member-info__last-seen-text":!0,"sharing-member-info__last-seen-text--not-present":!this.props.isPresent});return[r.createElement("span",{className:"u-font-meta dot"},"·"),r.createElement("span",{className:t},e)]}return null},t.prototype.renderOffTeamMessage=function(e){return e?[r.createElement("span",{className:"u-font-meta dot"},"·"),r.createElement("span",{className:"u-font-meta"},e)]:null},t.prototype.renderDisplayName=function(e,t){var n=this.props.member.displayName(),o="",i=null;if(this.props.wrappedGroupViewersElement)o=this.props.wrappedGroupViewersElement.elementText,i=this.props.wrappedGroupViewersElement.element;else if(this.props.isPresent)o=i=v("Viewing now");else if(t){o=v("Viewed %(time_str)s").format({time_str:l.ago(t,!1,!0,!0)});var a=t.toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"}),p=t.toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"});i=r.createElement(c,{
content:r.createElement("div",null,a,r.createElement("br",null),p),className:"timestamp-tooltip",children:r.createElement("span",null,o),position:c.POSITIONS.BOTTOM,isTargetPositionFixed:!0})}var m="";e&&e.disabled&&(m=v("Deleted"));var h="";m||o||!this.props.user.is_team||this.props.member.same_team||(h=v("Outside of your Dropbox team"));var _=0,f=0,g=0;if(n){o&&(_=new d("  ·  %s".format(o)).length),m&&(f=new d("  ·  %s".format(m)).length),h&&(g=new d("  ·  %s".format(h)).length);var y=u.SNIPPET_SIZES.DISPLAY_NAME-_-f-g,b=d.em_snippet(n,y),S="";b!==n&&(S=n);var w=s({"u-font-meta":this.props.isMemberActionPending,"u-font-strong":!0,"u-ellip":!0,"sharing-member-info__display-name":!0});return r.createElement("div",{className:w},this.renderNameTitleAndText(n,S,b),this.renderDisabledMessage(m),this.renderSeenState(i),this.renderOffTeamMessage(h))}},t.prototype.renderMemberDetails=function(e,t){var n;return e?n=this.shouldLinkToGroup()?this.linkToGroup(this.props.member,e):e:t&&t.email&&t.email_verified&&(n=d.em_snippet(t.email,u.SNIPPET_SIZES.EMAIL)),r.createElement("div",{className:"u-font-meta u-ellip sharing-member-info__details"},n)},t.prototype.renderSharingBubbleMenu=function(){var e,t=this;if(this.props.isMemberActionPending)e=r.createElement("img",{src:_.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:v("Changing access")});else if(this.props.isViewOnly||this.props.member instanceof h.ViewerInfo)e=r.createElement("span",null);else{var n=this.props.member.permissions.get("make_viewer_no_comment"),s=n&&n.allow&&this.props.canMakeViewerNoComment,o=this.props.member.permissions.set("make_viewer_no_comment",new p.PermissionSetting({allow:s})),i=this.props.member.memberId()===this.props.user.account_id&&this.props.canRelinquishMembership,a=function(e){if(!(t.props.member instanceof h.ViewerInfo))return t.props.actionHandler&&t.props.actionHandler.handleMemberAccessChange(t.props.member,e)};e=r.createElement(m.SharingBubbleMenu,{allowRelinquishMembership:i,canInviteMembers:this.props.canInviteMembers,canMakeViewerNoComment:s,contentInfo:this.props.contentInfo,currentAccess:this.props.member.access_type,disabled:this.props.disabled,isInherited:this.props.member.is_inherited,memberPermissions:o,onAccessChange:a,pendingAccessChange:this.props.pendingAccessChange})}return r.createElement("div",{className:"o-flag__fix"},e)},t.prototype.shouldRenderGroupCount=function(){return this.props.member instanceof p.GroupMembershipInfo&&this.props.member.member_count},t.prototype.render=function(){var e,t=void 0,n=!1,o=null,i=void 0,a=this.props.member;if(a instanceof p.UserMembershipInfo){if(t=a.account,!t)return null;o=t.profile_photo_url||null,e=a.time_last_seen}else a instanceof p.GroupMembershipInfo?(n=!0,"team"===a.group_type&&(o=_.static_url("/static/images/icons/team_24@2x-vflR8kGKs.png")),this.shouldRenderGroupCount()&&(i=b("%(member_num)s member","%(member_num)s members",a.member_count).format({member_num:a.member_count}))):a instanceof h.ViewerInfo&&(t={email:a.email,email_verified:!!a.email},o=a.photo_circle_url,e=a.time_last_seen);var l=s({"sharing-member-info":!0,"o-flag":!0,"u-pad-right-m":!this.props.isViewOnly});return r.createElement("li",{className:"sharing-member-list__item o-flag"},r.createElement("div",{className:"o-flag__flex"},r.createElement("div",{className:l},this.renderAvatar(o,n),r.createElement("div",{className:"sharing-member-info__contact o-flag__flex"},this.renderDisplayName(t,e),this.renderMemberDetails(i,t)))),this.renderSharingBubbleMenu())},t})(r.Component);S.displayName="SharingMemberListItem",S.defaultProps={canInviteMembers:!1,canMakeViewerNoComment:!1,canRelinquishMembership:!1,disabled:!1,isPresent:!1,isViewOnly:!1,wrappedGroupViewersElement:void 0},t.SharingMemberListItem=S}),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/sharing/views/modal_content",["external/classnames","external/immutable","external/react","external/react-dom","external/underscore","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/contacts/util","modules/clean/em_string","modules/clean/filepath","modules/clean/react/bubble_dropdown_v2","modules/clean/react/css","modules/clean/react/image","modules/clean/react/pass/constants","modules/clean/react/snackbar","modules/clean/react/sprite","modules/clean/react/bubble","modules/clean/react/tooltip","modules/clean/react_format","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/clean/sharing/views/comments_help","modules/clean/sharing/views/exp_share_link_upsell","modules/clean/sharing/views/hover_close_button","modules/clean/sharing/views/member_list","modules/clean/sharing/views/modal_link_info","modules/clean/sharing/views/sharing_bubble_menu","modules/clean/web_timing_logger","modules/clean/static_urls","modules/clean/user","modules/constants/rebrand","modules/core/i18n"],function(t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v,b,S,w,I,E,C,N,M,T,A,P,k,x,F,L,R,D){var O,U,B,q,H,V,G,W,K,Y,z,j,Q,Z,X,J,$,ee,te,ne,se,re,oe,ie,ae,le,de,ce,pe,ue,me,he,_e,fe,ge,ye,ve,be,Se,we,Ie,Ee,Ce,Ne,Me,Te;return W=i.ContactsTokenizer,h.PASS_FETCHING_STATUS,Se=h.fetchingStatusIsSuccessful,be=h.fetchingStatusIsComplete,ue=_.Snackbar,he=y.Tooltip,_e=y.TooltipPosition,Ie=v.reactFormat,ie=b.ShareModalActionHandler,j=S.FolderPolicy,X=S.LinkMetadata,ee=S.MemberCounts,te=S.MemberPermissions,se=S.PermissionSetting,le=S.SharedContentLinkMetadata,pe=S.SharingMembership,O=w.ACCESS_VALUES,w.COMMENTING,oe=w.SNIPPET_SIZES,me=w.TRUELINK,K=I.ContentInfo,q=E.CONTACT_ERROR_LEVEL,H=E.CONTACT_ERROR_MESSAGES,we=E.genContentManagerBridgeUri,Q=E.GoldenGate,Ce=E.shouldEnforceMemberLimits,Te=E.validateContact,J=C.MODES,$=C.MODE_VALUES,U=C.BANNERS,B=C.BANNER_VALUES,V=C.CONTENT_NAME_MESSAGE_LEVELS,G=C.CONTENT_NAME_MESSAGE_LEVEL_VALUES,Z=C.LINK_ONLY_REASON,Y=M.ExpShareLinkUpsellV1,z=M.ExpShareLinkUpsellV2,ce=A.SharingMemberList,ne=P.ModalLinkInfo,de=k.SharingBubbleMenu,Ne=F.static_url,re=R.REBRAND_M1_IS_ON,ye=s.createElement,ve=s.DOM,Ee=D.i18n_default_project("sharing"),fe=Ee._,Me=Ee.ungettext,ge=s.createClass({displayName:"ShareModalContent",statics:{MODES:J},propTypes:{actionHandler:s.PropTypes.instanceOf(ie).isRequired,areMembersFullyLoaded:s.PropTypes.bool,banner:s.PropTypes.oneOf(B),canInviteEditor:s.PropTypes.bool.isRequired,canInviteViewer:s.PropTypes.bool.isRequired,canInviteViewerNoComment:s.PropTypes.bool.isRequired,canMakeViewerNoComment:s.PropTypes.bool.isRequired,canRelinquishMembership:s.PropTypes.bool,canShareLink:s.PropTypes.bool.isRequired,canUpdateConfidentiality:s.PropTypes.bool,contactsError:s.PropTypes.shape({level:s.PropTypes.string,message:s.PropTypes.oneOfType([s.PropTypes.string,s.PropTypes.array])}),contentInfo:s.PropTypes.instanceOf(K).isRequired,contentNameMessage:s.PropTypes.string,contentNameMessageLevel:s.PropTypes.oneOf(G),displayContentNameTooltip:s.PropTypes.bool,displayContentNameBanner:s.PropTypes.bool,folderPolicy:s.PropTypes.instanceOf(j),guestMembers:s.PropTypes.array.isRequired,groupSeenStateInfo:s.PropTypes.object,hasDisplayableMembers:s.PropTypes.bool.isRequired,hasNonOwnerMembers:s.PropTypes.bool.isRequired,headerId:s.PropTypes.string,icon:s.PropTypes.string,initialContentName:s.PropTypes.string,initialRecipientRawInput:s.PropTypes.string,initialRecipientTokens:s.PropTypes.array,isAddMessageAsCommentChecked:s.PropTypes.bool,isAddMessageAsCommentHelpShown:s.PropTypes.bool,isConfidentialFolder:s.PropTypes.bool,isContentNameFocused:s.PropTypes.bool,isFolderInsideTeamFolderTree:s.PropTypes.bool,isInContentManager:s.PropTypes.bool,isLimitedTeam:s.PropTypes.bool,isLinkMetadataLoaded:s.PropTypes.bool.isRequired,isMetadataLoaded:s.PropTypes.bool.isRequired,isPassEnabled:s.PropTypes.bool,isTeamSharedFolder:s.PropTypes.bool,isTokenizerEmpty:s.PropTypes.bool.isRequired,linkMetadata:s.PropTypes.oneOfType([s.PropTypes.instanceOf(X),s.PropTypes.instanceOf(le)]),linkOnlyReason:s.PropTypes.oneOf(o.values(Z)),memberCounts:s.PropTypes.instanceOf(ee),memberCountWithRecipients:s.PropTypes.number,members:s.PropTypes.instanceOf(pe),mode:s.PropTypes.oneOf($),name:s.PropTypes.string,onSettingsClick:s.PropTypes.func,onSetConfidentialClick:s.PropTypes.func,ownerTeam:s.PropTypes.shape({id:s.PropTypes.string.isRequired,name:s.PropTypes.string.isRequired}),passFetchingStatus:s.PropTypes.number,pendingMemberAction:s.PropTypes.instanceOf(n.Set).isRequired,presentAccountIds:s.PropTypes.instanceOf(n.Set),recipientAccess:s.PropTypes.oneOf(O).isRequired,recipientMessage:s.PropTypes.string.isRequired,recipientTokens:s.PropTypes.array,shareFolderPromise:s.PropTypes.instanceOf(Promise),shouldBlockMemberListOnPassLoad:s.PropTypes.bool,showContentManagerBridge:s.PropTypes.bool,showPassFileSettings:s.PropTypes.bool,suppressLinkUI:s.PropTypes.bool,teamGroupInfo:s.PropTypes.shape({id:s.PropTypes.string,name:s.PropTypes.string}),user:s.PropTypes.instanceOf(L).isRequired,expSubgrowthBizTeamsManageAccessInvite:s.PropTypes.string,expSubgrowthProOverquotaCreateSharedLink:s.PropTypes.string},getDefaultProps:function(){return{contactsError:{level:null,message:null},headerId:"unified-share-modal-title",linkMetadata:null,members:null,initialRecipientRawInput:"",initialRecipientTokens:[],isTeamSharedFolder:!1,mode:J.MEMBERSHIP,onFolderSettingsClick:null}},componentDidMount:function(){if(this.logTTI(),this.refs.contentNameInput)return r.findDOMNode(this.refs.contentNameInput).focus()},componentDidUpdate:function(e,t){return this.logTTI()},logTTI:function(){return"GRANT_ACCESS"===this.props.contentInfo.extras.origin&&this.props.isMetadataLoaded&&x.mark_time_to_interactive(),this.props.mode===J.LINK_ONLY&&this.props.isLinkMetadataLoaded?this.props.actionHandler.logIfHaventBefore("VIEW_LINK_ONLY_MODAL"):this.props.isMetadataLoaded&&(this.props.actionHandler.logIfHaventBefore("VIEW_SHARE_MODAL"),!this._shouldRenderMainLoading())?this.props.actionHandler.logIfHaventBefore("MEMBER_LIST_LOADED",{member_count:this._getMemberNum()}):void 0},render:function(){return ve.div({className:"unified-share-modal unified-share-modal--"+this.props.mode},this._renderHeaderSection(),this._renderToSection(),this._renderErrorMessageSection(),this._renderConfidentialFolderSection(),this._renderMainSection(),this._renderFooterSection())},_renderHeaderSection:function(){var e,n,s,r,o;return n=this._getMemberNum(),s=this.props.user.is_team&&(null!=(r=this.props.memberCounts)?r.users_outside_team:void 0)>0&&null!=this.props.ownerTeam?Me("%(outside_team_count)s outside your Dropbox team","%(outside_team_count)s outside your Dropbox team",this.props.memberCounts.users_outside_team).format({outside_team_count:this.props.memberCounts.users_outside_team}):void 0,e=n?s?Me("%(member_num)s member (%(outside_team_string)s)","%(member_num)s members (%(outside_team_string)s)",n,{comment:'Description of the count of total folder members and count of outside-of-team folder members, like "10 members (3 outside of your Dropbox team)"'}):Me("%(member_num)s member","%(member_num)s members",n):"",e=e.format({member_num:n+((null!=(o=this.props.memberCounts)?o.exceeds_count:void 0)?"+":""),outside_team_string:s}),ve.div({className:"unified-share-modal__section unified-share-modal__section--header"},ve.div({className:""},ye(f,{alt:"",className:"unified-share-modal__title-icon",group:"web",name:this.props.icon})),ve.div({className:t("unified-share-modal__title",n?"unified-share-modal__title--member-count":void 0)},this.props.contentInfo.pathExists()?ve.h3({className:"u-font-strong",id:this.props.headerId},d.em_snippet(this.props.contentInfo.name(),oe.FILENAME)):this._renderContentNameInput(),n?ve.h4({className:"u-trim-margin u-font-meta"},e):void 0),me.TRUELINK_UI[this.props.user.id]?this._renderContentSettings():void 0,ve.div({className:"unified-share-modal__close"},ye(T,{className:"u-mar-left-s",onClick:(function(e){return function(){return e.props.actionHandler.onClickX(e.refs.tokenizer)}})(this)})))},_renderContentNameInput:function(){return ve.div({className:"unified-share-modal__content-name"},null==this.props.contentNameMessage||!this.props.isContentNameFocused&&this.props.contentNameMessageLevel!==V.ERROR?void 0:ye(g,{arrow:g.ARROW.TOP,className:t({"unified-share-modal__content-name__tooltip":!0,"unified-share-modal__content-name__tooltip-error":this.props.contentNameMessageLevel===V.ERROR,"u-font-strong":!0})},ve.div({className:t(["u-pad-top-xxs","u-pad-bottom-xxs","u-pad-left-xs","u-pad-right-xs"])},this.props.contentNameMessage)),ve.input({className:t(["u-trim-padding","u-trim-margin","u-l-ib","u-font-strong"]),id:this.props.headerId,ref:"contentNameInput",onChange:(function(e){return function(t){return e.props.actionHandler.handleContentNameChange(t.target.value)}})(this),onFocus:(function(e){return function(){return e.props.actionHandler.handleContentNameFocusChange(!0)}})(this),onBlur:(function(e){return function(){return e.props.actionHandler.handleContentNameFocusChange(!1)}})(this),onKeyUp:(function(e){return function(t){var n,s;if((null!=(n=e.refs.tokenizer)&&null!=(s=n.refs.tokenizer)?s.refs.input:void 0)&&13===t.keyCode)return r.findDOMNode(e.refs.tokenizer.refs.tokenizer.refs.input).focus()}})(this),placeholder:this.props.isContentNameFocused?void 0:fe("Folder name"),defaultValue:this.props.initialContentName}))},_renderToSection:function(){var e,n;return this.props.linkOnlyReason===Z.LINKS_PAGE?null:this.props.mode===J.LINK_ONLY?this._renderNoPermissionSection():this.props.isMetadataLoaded?this.props.showContentManagerBridge?this._renderContentManagerBridge():this.props.canInviteEditor||this.props.canInviteViewer?Ce(this.props.user,this.props.isTeamSharedFolder,this.props.isFolderInsideTeamFolderTree)&&(null!=(e=this.props.memberCounts)?e.total_unique_users:void 0)>=Q.SHARING_TOTAL_LIMIT?this._renderOverLimitSection():(n=this.props.contentInfo.isFile()&&!this.props.canInviteEditor&&!this.props.canInviteViewerNoComment,ve.div({className:"unified-share-modal__section unified-share-modal__section--to"},ve.div({className:"o-flag"},ve.label({className:"o-flag__fix u-font-strong",htmlFor:"unified-share-modal-contacts-tokenizer"},this.props.isTeamSharedFolder?fe("Add groups:",{comment:"Label for with whom to share"}):fe("To:",{comment:"Label for with whom to share"})),ve.div({className:"unified-share-modal__to-input-box o-flag__flex"},ye(W,{ref:"tokenizer",context:"tiburon",excludeDomainContacts:!1,customContactFilter:this.props.isTeamSharedFolder?function(e){return e.type!==a.FB&&e.group_id}:this.props.isInContentManager?function(e){return e.type!==a.FB}:(function(e){return function(t){return t.type!==a.FB&&t.email!==e.props.user.email}})(this),focusOnMount:this.props.contentInfo.pathExists(),id:"unified-share-modal-contacts-tokenizer",onContentsChange:this.props.actionHandler.recipientsChange,populatedInputData:{tokens:this.props.initialRecipientTokens,value:this.props.initialRecipientRawInput},customContactValidator:(function(e){return function(t){return Te(t,e.props.user,e.props.ownerTeam,e.props.folderPolicy,e.props.isTeamSharedFolder,e.props.isFolderInsideTeamFolderTree,e.props.memberCountWithRecipients)}})(this),placeholder:fe(this.props.isTeamSharedFolder?"Group names":this.props.user.is_team?"Email, name, or group":"Email or name"),shouldLogContactSearch:!0,showContactImport:!this.props.isTeamSharedFolder,teamGroupInfo:this.props.isTeamSharedFolder?this.props.teamGroupInfo:null,user:this.props.user})),ve.div({className:t({"o-flag__fix":!0})},n?ye(he,{position:_e.BOTTOM,tooltip_contents:fe("Only folders can be shared with edit access"),tooltip_classname:"sharing-access-menu__tooltip"},ve.span({className:"ax-visually-hidden"},fe("Only folders can be shared with edit access")),this._renderToSectionAccessDropdown()):this._renderToSectionAccessDropdown())))):this._renderNoPermissionSection():ve.div({className:"unified-share-modal__section unified-share-modal__section--to"},ve.div({className:"unified-share-modal__to-placeholder"}," "))},_renderToSectionAccessDropdown:function(){return ye(de,{asButton:!0,canMakeViewerNoComment:this.props.canMakeViewerNoComment,contentInfo:this.props.contentInfo,currentAccess:this.props.recipientAccess,disabled:this.props.showContentManagerBridge,memberPermissions:new te({make_editor:new se({allow:this.props.canInviteEditor}),make_viewer:new se({allow:this.props.canInviteViewer}),make_viewer_no_comment:new se({allow:this.props.canInviteViewerNoComment})}),onAccessChange:this.props.actionHandler.changeRecipientAccess})},_shouldRenderContentSettingsShareButton:function(){var e;return this.props.isMetadataLoaded&&this.props.mode!==J.LINK_ONLY&&(this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings||(e=this.props.mode)===J.SHARE||e===J.SHARE_SENDING)},_shouldRenderFooterSection:function(){return this._renderLinkRowInFooter()?this._shouldRenderLinkRow():this._shouldRenderContentSettingsShareButton()},_renderFooterSection:function(){if(this._shouldRenderFooterSection())return ve.div({className:"unified-share-modal__section unified-share-modal__section--footer clearfix"},this._renderLinkRowInFooter()?this._renderLinkRowContent():this._renderContentSettingsShareButton())},_renderContentSettingsShareButton:function(){if(this._shouldRenderContentSettingsShareButton())return ve.div({className:t([{"exp-subgrowth-biz-teams-manage-access-invite":"V1"===this.props.expSubgrowthBizTeamsManageAccessInvite}])},me.TRUELINK_UI[this.props.user.id]?void 0:ve.div({className:"u-l-fl"},this._renderContentSettings()),ve.div({className:"u-l-fr"},function(){switch(this.props.mode){case J.SHARE:case J.SHARE_SENDING:return ve.button({className:"unified-share-modal__share-send c-btn c-btn--primary",disabled:this.props.mode===J.SHARE_SENDING||this.props.isTokenizerEmpty||this.props.contactsError.level===q.ERROR||null!=this.props.contentNameMessage,onClick:(function(e){return function(){return e.props.actionHandler.handleShareClick(e.refs.tokenizer,e.refs.contentNameInput)}})(this)},fe(this.props.mode===J.SHARE_SENDING?this.props.isTeamSharedFolder?"Adding...":"Sharing...":this.props.isTeamSharedFolder?"Add":"Share"));default:return this.props.isTeamSharedFolder&&this.props.contactsError.message!==H.SINGLE_TOO_MANY_MEMBERS&&this.props.contactsError.message!==H.GENERAL_TOO_MANY_MEMBERS&&this._teamIsInTeamFolderMembership()?(this.props.actionHandler.logBizTeamsManageAccessInviteVariant(this.props.expSubgrowthBizTeamsManageAccessInvite),"V1"===this.props.expSubgrowthBizTeamsManageAccessInvite?ve.div({className:"manage-access-invite"},fe("Need to give team folder access to people who aren’t on your team yet? "),ve.a({className:"unified-share-modal__invite-cta-link",href:"/team/admin/members?show_invite_members",target:"_blank"},fe("Invite them to your team."))):null):null}}.call(this)))},_teamIsInTeamFolderMembership:function(){var t,n;return!!(this.props.members&&this.props.members.groups&&this.props.teamGroupInfo)&&(t=this.props.members.groups.toArray().map(function(e){return e.memberId()}),n=this.props.teamGroupInfo.id,e.call(t,n)>=0)},_renderContentSettings:function(){var e;if(this.props.isMetadataLoaded)return this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings?ve.button({"aria-label":fe("Settings"),className:"unified-share-modal__settings u-font-meta c-borderless-button",disabled:this.props.mode===J.SHARE_SENDING,onClick:(function(e){return function(){return e.props.onSettingsClick()}})(this)},ye(f,{alt:"",className:"u-mar-right-xs u-l-ib u-l-ib--m",group:"web",name:"settings"}),me.TRUELINK_UI[this.props.user.id]?void 0:fe(this.props.contentInfo.isFile()?"File settings":"Folder settings")):!this.props.contentInfo.isFolder()&&(this._canSendFeedbackRequest()||(null!=(e=this.props.recipientMessage)?e.length:void 0)>0)?this._renderFeedbackCheckbox():void 0},_renderErrorMessageSection:function(){return this.props.contactsError.message?ve.div({className:t(["unified-share-modal__section","unified-share-modal__error-message","u-font-center",this.props.contactsError.level===q.WARN?"unified-share-modal__warn":void 0,this.props.contactsError.level===q.ERROR?"unified-share-modal__error":void 0])},this.props.contactsError.message):null},_shouldRenderMainLoading:function(){var e,t,n,s;return n=this.props.isMetadataLoaded,t=this.props.hasNonOwnerMembers||this.props.areMembersFullyLoaded,s=!this.props.isPassEnabled||this._isPassInfoLoaded(),e=this.props.shouldBlockMemberListOnPassLoad&&!s,!n||!t||e},_renderMainSection:function(){if(this.props.mode===J.LINK_ONLY)return this._renderMainLinkOnly();if(this._shouldRenderMainLoading())return this._renderMainLoading();switch(this.props.mode){case J.MEMBERSHIP:return this._renderMainMembership();case J.SHARE:case J.SHARE_SENDING:return this._renderMainShare();default:return null}},_renderNoPermissionSection:function(){var e;return ve.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},this.props.mode===J.LINK_ONLY?this.props.contentInfo.isOSXPackage()?fe(me.TRUELINK_UI[this.props.user.id]?"Package files can’t be shared.":"This package file can only be shared as a link."):this.props.linkOnlyReason===Z.INSIDE_SHARED_FOLDER?me.TRUELINK_UI[this.props.user.id]?fe("You don’t have permission to share this folder."):ve.span({},fe("This folder can only be shared as a link because it’s in a shared folder.")+" ",ve.a({href:"/help/1931",target:"_blank"},fe("Learn more"))):me.TRUELINK_UI[this.props.user.id]?fe("This folder can’t be shared"):this.props.linkOnlyReason===Z.CONTAINS_SHARED_FOLDER?ve.span({},fe("This folder can only be shared as a link because it contains a shared folder.")+" ",ve.a({href:"/help/1931",target:"_blank"},fe("Learn more"))):fe("This folder can only be shared as a link."):this.props.isTeamSharedFolder&&this._shouldRenderTeamFolderNoPermissionMessage(this.props.members)?fe("This folder is automatically shared with all members of %(team_name)s").format({team_name:this.props.ownerTeam.name}):this.props.isTeamSharedFolder?Ie(fe("Only <admin_link>admins</admin_link> and <group_link>group managers</group_link> can change team folder membership."),{admin_link:ve.a({href:"/team?_tk=left_nav_team",target:"_blank"}),group_link:ve.a({href:"/help/7232#transfer",target:"_blank"})}):fe(this.props.contentInfo.isFolder()?me.TRUELINK_UI[this.props.user.id]&&(null!=(e=this.props.permissions)?e.change_options.allow:void 0)?"To add new members, you’ll need to add them to the parent folder.":"You don’t have permission to manage membership of this folder":"You don’t have permission to manage membership of this file"))},_renderConfidentialFolderSection:function(){if(this.props.isConfidentialFolder&&this.props.canUpdateConfidentiality)return ve.div({className:"unified-share-modal__section unified-share-modal__confidential-folder u-font-center"},ve.span({},Ie(fe("<b>Invite only.</b> Members of parent folders can’t access."),{b:ve.b()}),this.props.contentInfo.pathExists()?[" ",ve.a({onClick:this.props.onSetConfidentialClick},fe("Restore access"))]:void 0))},_renderContentManagerBridge:function(){var e,t,n;return e=c.parent_dir(this.props.contentInfo.displayPath()),t=this.props.contentInfo.name(),n=we({containingFolder:e,filenameToSelect:t,isLimitedTeam:this.props.isLimitedTeam}),ve.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},ve.span({},fe("You can manage folder membership in the Admin Console. "),ve.a({href:n.toString(),target:"_blank"},fe("Open in new tab."))))},_renderOverLimitSection:function(){return ve.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},ve.div({},fe("This folder is over its %(member_limit)s-member limit.",{comment:"member limit is a number greater than 200"}).format({member_limit:Q.SHARING_TOTAL_LIMIT})),ve.div({},fe("Please remove some members.")," ",ve.a({href:"/help/9292",target:"_blank"},fe("Learn more."))))},_shouldRenderTeamFolderNoPermissionMessage:function(e){return null!=e&&null!=e.groups&&e.groups.some(function(e,t){var n,s;return"team"===e.group_type&&(null!=(n=e.permissions.make_editor)?n.allow:void 0)&&(null!=(s=e.permissions.make_viewer)?s.allow:void 0)})},_isOwnerOfAtLeastOneGroup:function(e){return null!=e&&null!=e.groups&&e.groups.some(function(e,t){return e.is_owner})},_renderMainLoading:function(){return ve.div({className:t(["unified-share-modal__main","unified-share-modal__section",this._shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer"])},this._renderLinkRow(),ve.div({className:"u-font-center u-font-meta u-pad-top-xl"},ve.div({className:"c-loader"},fe("Loading..."))))},_renderMainLinkOnly:function(){return me.TRUELINK_UI[this.props.user.id]&&this.props.linkOnlyReason!==Z.LINKS_PAGE?null:ve.div({className:t(["unified-share-modal__main","unified-share-modal__main--link-only","unified-share-modal__section",this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0])},this._renderLinkRow())},_renderMainMembership:function(){var e,n,s;return ve.div({className:t(["unified-share-modal__main","unified-share-modal__section",this._shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer",this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0])},this._renderLinkRow(),s=this.props.user.is_cdm_member&&(this.props.members.users.size>0&&this.props.isFolderInsideTeamFolderTree||!this.props.isConfidentialFolder),this.props.hasNonOwnerMembers||s||this.props.guestMembers.length>0?ye(ce,{actionHandler:this.props.actionHandler,areMembersFullyLoaded:this.props.areMembersFullyLoaded,canInviteMembers:this.props.canInviteEditor||this.props.canInviteViewer,canMakeViewerNoComment:this.props.canMakeViewerNoComment,canRelinquishMembership:this.props.canRelinquishMembership,canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,disabled:this.props.showContentManagerBridge,guestMembers:this.props.guestMembers,groupSeenStateInfo:this.props.groupSeenStateInfo,isConfidentialFolder:this.props.isConfidentialFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,membership:this.props.members,onSetConfidentialClick:this.props.onSetConfidentialClick,pendingMemberAction:this.props.pendingMemberAction,presentAccountIds:this.props.presentAccountIds,shouldShowPassUI:this.props.isPassEnabled&&Se(this.props.passFetchingStatus),teamName:null!=(n=this.props.ownerTeam)?n.name:void 0,user:this.props.user,viewer:this.props.viewer}):this.props.banner===U.INPUT_CONTENT_NAME?ve.div({className:t(["unified-share-modal__input-content-name-banner","u-font-center","u-font-meta","u-mar-top-xs"])},ye(m,{src:Ne("/static/images/sharing/illo-name-folder-vfl38PzAv.png"),srcHiRes:Ne("/static/images/sharing/illo-name-folder@2x-vflzK0uJv.png")}),ve.h3({className:t(["u-font-strong","u-mar-top-xs"])},fe("Name your shared folder")),ve.p({className:t(["u-pad-left-xxl","u-pad-right-xxl"])},fe("Shared folders are for collaborting on projects, client works, and organizing departments"))):ve.div({className:t(["unified-share-modal__no-members-banner","u-font-center","u-font-meta","u-font-center","u-font-meta"])},this.props.isTeamSharedFolder?null!=this.props.teamGroupInfo?[ve.p({className:"u-mar-top-xxl"},ve.a({onClick:this._addEveryoneGroup},fe("Add everyone at %(team_name)s").format({team_name:this.props.ownerTeam.name}))),ve.p({},fe("Or, add groups to this team folder.")+" ",ve.a({href:"/team#groups/newgroup"},fe("Create a group")))]:ve.p({className:"u-mar-top-xxl"},fe("Add groups to this team folder.")+" ",ve.a({href:"/team#groups/newgroup"},fe("Create a group"))):(e=me.TRUELINK_UI[this.props.user.id],e||"V1"!==this.props.expSubgrowthProOverquotaCreateSharedLink?e||"V2"!==this.props.expSubgrowthProOverquotaCreateSharedLink?re&&!e?ve.div({}):ve.div({},ye(m,{className:"unified-share-modal__illo",src:Ne("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:Ne("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),ve.p({className:"u-mar-top-s"},fe("Add people you want to share with"))):ye(z):ye(Y))))},_renderMainShare:function(){return ve.div({className:"unified-share-modal__main unified-share-modal__section u-pad-horizontal-m"},this.props.isTeamSharedFolder?void 0:ve.textarea({placeholder:fe("Add a message (optional)"),onChange:(function(e){return function(t){return e.props.actionHandler.changeRecipientMessage(t.target.value)}})(this),value:this.props.recipientMessage}))},_renderLinkRow:function(){if(!this._renderLinkRowInFooter())return this._renderLinkRowContent()},_renderLinkRowContent:function(){var e,t;if(this._shouldRenderLinkRow())return t=!this.props.contentInfo.isMounted()&&this.props.isPassEnabled&&this._isPassInfoLoaded()&&this.props.isMetadataLoaded,t||this.props.isLinkMetadataLoaded&&(this.props.isMetadataLoaded||this.props.mode===J.LINK_ONLY)?ve.div({className:"unified-share-modal__link-info"},ye(ne,{actionHandler:this.props.actionHandler,canShareLink:this.props.canShareLink||this.props.mode===J.LINK_ONLY,contentInfo:this.props.contentInfo,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,isLimitedTeam:this.props.isLimitedTeam,linkMetadata:this.props.linkMetadata,mode:this.props.mode,shareFolderPromise:this.props.shareFolderPromise,teamName:null!=(e=this.props.ownerTeam)?e.name:void 0,presentAccountIds:this.props.presentAccountIds,user:this.props.user})):this.props.mode===J.LINK_ONLY?ve.div({className:"unified-share-modal__link-info--loading"},ve.div({className:"c-loader c-loader--spinner--blue u-l-b u-mar-horizontal-auto"},fe("Loading…"))):this.props.contentInfo.isTeamSharedFolder()?void 0:ve.div({className:"unified-share-modal__link-info--filler"})},_renderFeedbackCheckbox:function(){var e,t;return t=this._canSendFeedbackRequest(),e=fe(t?"I want feedback on this file":"Post this message as a comment"),ve.div({className:"u-pad-top-xs"},ve.div({className:"unified-share-modal__add-message-as-comment-checkbox-container"},ve.input({type:"checkbox",id:"add_message_as_comment",name:"add_message_as_comment",checked:this.props.isAddMessageAsCommentChecked,onChange:this._handleAddMessageAsCommentChange}),this.props.isAddMessageAsCommentHelpShown?ye(N,{onClose:this._commentsHelpClosed,onButtonClick:this._commentsHelpButtonClicked,isFeedbackRequest:t}):void 0),ve.label({htmlFor:"add_message_as_comment"},e))},_getMemberNum:function(){var e;return null!=this.props.memberCounts?this.props.memberCounts.total_unique_users:null!=(e=this.props.members)?e.getMemberCount():void 0},_isPassInfoLoaded:function(){return be(this.props.passFetchingStatus)},_handleAddMessageAsCommentChange:function(e){return this.props.actionHandler.setAddMessageAsCommentChecked(e.target.checked)},_commentsHelpClosed:function(){return this.props.actionHandler.setAddMessageAsCommentHelpClosed()},_commentsHelpButtonClicked:function(){return this.props.actionHandler.setAddMessageAsCommentHelpClosed(),this.props.actionHandler.setAddMessageAsCommentChecked(!0)},_canSendFeedbackRequest:function(){return!this._renderLinkRowInFooter()},_addEveryoneGroup:function(){var e;return null!=(e=this.refs.tokenizer)?e.addExternalContacts([l.teamGroupInfoToContact(this.props.teamGroupInfo)]):void 0},_renderLinkRowInFooter:function(){return this.props.mode!==J.LINK_ONLY&&(this.props.mode!==J.SHARE&&this.props.mode!==J.SHARE_SENDING&&(!!this.props.isMetadataLoaded&&me.TRUELINK_UI[this.props.user.id]))},_shouldRenderLinkRow:function(){return!(me.TRUELINK_UI[this.props.user.id]&&this.props.isLinkMetadataLoaded&&!this.props.linkMetadata)&&(!this.props.suppressLinkUI&&this.props.canShareLink)}}),
ae=u(ge,["/static/css/react/contacts_tokenizer-vflaf7P-F.css","/static/css/scooter/scooter-scoped-vfl8iXN08.css","/static/css/sharing/share_modal-vflqUEM1t.css"],[p,ue]),{ShareModalContent:ae,MODES:J}})}.call(this),define("modules/clean/sharing/views/modal_link_info",["require","exports","tslib","jquery","external/classnames","external/react","modules/clean/clipboard_v2","modules/clean/em_string","modules/clean/react_format","modules/clean/react/snackbar","modules/clean/react/sprite","modules/clean/react/util","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/link_description","modules/clean/sharing/sharing_settings_dropdown","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m,h,_,f,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=v.i18n_default_project("sharing")._,S=(function(e){function t(t,n){var s=e.call(this,t,n)||this;return s.handleCreateLinkClicked=function(){if(s.isSharedContentLink())throw Error("Should not display this for shared content link");if(s.props.actionHandler)return s.props.actionHandler.createSharedLink()},s.handleCopyLinkClicked=function(){if(!s.state.showingUrl){var e={};s.props.linkMetadata instanceof u.SharedContentLinkMetadata?(e.type="scl",e.password_protected=s.props.linkMetadata.password_protected,e.audience=s.props.linkMetadata.current_audience,e.expiration=s.props.linkMetadata.expiry):s.props.linkMetadata instanceof u.LinkMetadata?(e.type="shmodel",e.visibility=s.props.linkMetadata.link_permissions.resolved_visibility,e.expiration=s.props.linkMetadata.expires):s.isSharedContentLink()&&(e.type="scl"),s.props.contentInfo&&g.logTiburonEvent(s.props.contentInfo,s.props.user.id,"CLICK_TIB_COPY_LINK",e),s.props.actionHandler&&s.props.actionHandler.turnLinkOnIfQualified()}return p.setStatePromise(s,{showingUrl:!s.state.showingUrl}).then(function(){if(s.urlField){var e=s.urlField;e.focus(),e.select(),s.clipboard.do_copy()}})},s.state={showingUrl:!1},s.clipboard=null,s}return n.__extends(t,e),t.prototype.componentWillMount=function(){this.clipboard=new i(this.props.linkMetadata&&this.props.linkMetadata.url,function(){return g.sharingNotificationSuccess(b("Link copied to clipboard"))},function(){g.sharingNotificationError(b("Unable to copy the link, please copy manually"))},this.handleCopyLinkClicked)},t.prototype.componentDidMount=function(){this.setupCopy()},t.prototype.componentDidUpdate=function(){this.setupCopy()},t.prototype.setupCopy=function(){var e=s(".copy-link-button");e.length&&this.clipboard.setupCopy(e,s(".copy-link-container"))},t.prototype.render=function(){return this.props.linkMetadata||this.isSharedContentLink()?this.renderLink():this.props.canShareLink?this.renderNoLink():null},t.prototype.renderLink=function(){var e=this;if(!this.props.linkMetadata)return null;var t=null;this.props.linkMetadata instanceof u.SharedContentLinkMetadata&&(t=this.renderSharedContentLinkInfo());var n;if(this.state.showingUrl)n=o.createElement("span",null,t,o.createElement("span",null,o.createElement("label",{className:"ax-visually-hidden",htmlFor:"unified-share-modal-link-url",key:"link-label"},b("Shared link URL")),o.createElement("input",{className:"unified-share-modal-link-info__url",id:"unified-share-modal-link-url",key:"link-url-input",onClick:this.handleUrlClick,readOnly:!0,ref:function(t){return e.urlField=t},type:"text",value:this.props.linkMetadata.url})));else{var s=null;this.props.linkMetadata instanceof u.LinkMetadata?s=h.formatLinkDescription(this.props.linkMetadata):this.props.linkMetadata instanceof u.SharedContentLinkMetadata&&(s=this.renderSharedContentLinkInfo());var i=null;null!==s&&(i=o.createElement("span",{className:r({"unified-share-modal-link-info__description":!0,"unified-share-modal-link-info__description--content-link":this.isSharedContentLink()})},s)),n=o.createElement("span",null,i)}var a=null;return this.isSharedContentLink()?this.props.linkMetadata&&this.props.linkMetadata.url?a=this.renderCopyLink():this.isSharingFolder()||(a=this.renderGetLink()):a=o.createElement("span",null,this.renderLinkSettings(),this.renderDivider(),this.renderCopyLink()),o.createElement("div",{className:"unified-share-modal-link-info o-flag"},o.createElement("div",{className:"o-flag__fix"},this.renderLinkIcon()),o.createElement("div",{className:this.detailsClassName()},n),o.createElement("ul",{className:"unified-share-modal-link-info__actions o-flag__fix"},a))},t.prototype.renderLinkSettings=function(){return!this.state.showingUrl&&this.props.actionHandler?o.createElement("li",{className:"u-l-ib"},o.createElement("button",{className:"button-as-link",onClick:this.props.actionHandler.handleLinkSettingsClick},b("Link settings"))):null},t.prototype.renderDivider=function(){return this.state.showingUrl?null:o.createElement("span",{className:"u-l-ib u-mar-left-xs u-mar-right-xs"},"•")},t.prototype.renderCopyLink=function(){var e;return e=this.state.showingUrl?b("Hide link"):i.is_supported()?o.createElement("span",{className:"copy-link-button"},b("Copy link")):b("Show link"),o.createElement("li",{className:"u-l-ib"},o.createElement("button",{className:"button-as-link copy-link-container",onClick:this.handleCopyLinkClicked},e))},t.prototype.renderGetLink=function(){var e=this,t=function(){if(e.props.actionHandler){var t=Date.now();e.props.actionHandler.turnLinkOnIfQualified().then(function(){if(e.props.actionHandler){var n=void 0;n=e.props.contentInfo?l.reactFormat(b("Creating shared link for <st>%(folder_name)s</st>..."),{st:o.createElement("strong",null),folder_name:e.props.contentInfo.name()}):b("Creating shared link..."),e.props.actionHandler.shareIfFileFolder(n).then(function(){if(m.SHARING_UNSHARING.SNACKBAR_MESSAGES){var t=void 0;t=e.props.contentInfo?l.reactFormat(b("Created shared link for <st>%(folder_name)s</st>."),{st:o.createElement("strong",null),folder_name:e.props.contentInfo.name()}):b("Created shared link."),d.Snackbar.complete(t)}}).catch(function(n){m.SHARING_UNSHARING.SNACKBAR_MESSAGES&&e.props.actionHandler&&e.props.actionHandler.reportShareFailure(n,t)})}})}};return o.createElement("li",{className:"u-l-ib"},o.createElement("button",{className:"button-as-link",onClick:t},b("Get link")))},t.prototype.detailsClassName=function(){return"unified-share-modal-link-info__details o-flag__flex"},t.prototype.renderNoLink=function(){return o.createElement("div",{className:"unified-share-modal-link-info unified-share-modal-link-info--no-link o-flag"},o.createElement("div",{className:"o-flag__fix"},o.createElement("div",{className:"unified-share-modal-link-info__icon"},o.createElement(c,{alt:"",group:"web",name:"shared_link_gray"}))),o.createElement("div",{className:this.detailsClassName()},b("No link created yet")),o.createElement("div",{className:"unified-share-modal-link-info__actions o-flag__fix"},o.createElement("button",{className:"button-as-link",onClick:this.handleCreateLinkClicked},b("Create a link"))))},t.prototype.handleUrlClick=function(e){e.target.select()},t.prototype.isSharedContentLink=function(){return m.TRUELINK.TRUELINK_UI[this.props.user.id]},t.prototype.renderLinkIcon=function(){return o.createElement("div",{className:"unified-share-modal-link-info__icon"},o.createElement(c,{alt:"",group:"web",name:"shared_link_white"}))},t.prototype.isSharingFolder=function(){return Boolean(this.props.shareFolderPromise)},t.prototype.renderSharedContentLinkInfo=function(){if(!(this.props.actionHandler&&this.props.linkMetadata&&this.props.linkMetadata instanceof u.SharedContentLinkMetadata))return null;if(this.isSharingFolder()||this.props.linkMetadata instanceof u.SharedContentLinkMetadata&&this.props.linkMetadata.current_audience===u.LinkAudience.default_on)return o.createElement("div",null,b("Updating link"),o.createElement("div",{className:"c-loader"}));var e,t=this.props.linkMetadata.audience_options.size>1;this.props.linkMetadata.current_audience===u.LinkAudience.members?e=this.props.hasDisplayableMembers&&!this.props.hasNonOwnerMembers?l.reactFormat(b("<strong>Only you</strong> can use the link"),{strong:o.DOM.strong()}):l.reactFormat(b("<strong>Invited members</strong> with the link can view"),{strong:o.DOM.strong()}):this.props.linkMetadata.current_audience===u.LinkAudience.team?e=l.reactFormat(b("<strong>Members of %(team_name)s</strong> with the link can view"),{strong:o.DOM.strong(),team_name:a.em_snippet(this.props.teamName||"",10)}):this.props.linkMetadata.current_audience===u.LinkAudience.public&&(e=l.reactFormat(b("<strong>Anyone</strong> with the link can view"),{strong:o.DOM.strong()}));var n;if(t){var s=o.createElement("button",{className:"c-borderless-button change-audience-button"},e,o.createElement(c,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-gray"}));n=o.createElement(_.SettingDropdown,{currentValue:this.props.linkMetadata.current_audience,valuesList:this.props.linkMetadata.audience_options.valueSeq().toArray(),optionsDict:f.getAudienceOptionsDict(this.props.contentInfo&&this.props.contentInfo.isFolder()||!1,this.props.teamName||"",this.props.hasNonOwnerMembers||!1,this.props.hasDisplayableMembers||!1),onValueSelected:this.props.actionHandler.handleSelectLinkAudience,customButton:s,openUp:this.props.mode!==y.MODES.LINK_ONLY})}else n=e;var r=[];this.props.linkMetadata.expiry&&r.push(h.formatSharedContentLinkExpiry(this.props.linkMetadata,!0)),this.props.linkMetadata.password_protected&&this.props.linkMetadata.expiry&&r.push(this.renderDivider()),this.props.linkMetadata.password_protected&&r.push(b("Password protected"));var i;if(this.props.linkMetadata.audience_restricting_shared_folder&&this.props.linkMetadata.audience_restricting_shared_folder.audience===this.props.linkMetadata.current_audience){var d=this.props.linkMetadata.audience_restricting_shared_folder.name;i=l.reactFormat(b("Applied via <strong>%(folder_name)s</strong>"),{strong:o.DOM.strong(),folder_name:d})}else this.props.contentInfo&&this.props.contentInfo.isFolder()&&this.props.linkMetadata.current_audience!==u.LinkAudience.members&&(i=b("Applies to all items in this folder"));return o.createElement("div",null,o.createElement("div",null,n),o.createElement("div",null,r),i)},t})(o.Component);S.displayName="ModalLinkInfo",t.ModalLinkInfo=S}),define("modules/clean/sharing/views/sharing_bubble_menu",["require","exports","tslib","external/classnames","external/react","modules/clean/react/bubble_menu","modules/clean/react/sprite","modules/clean/sharing/constants","modules/clean/sharing/strings","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=d.i18n_default_project("sharing")._,p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getMemberActionInfo=function(){var e=l.ACCESS_NAME;this.props.canMakeViewerNoComment&&(e=l.ACCESS_NAME_NO_COMMENT);var t=l.MEMBER_ACTION_FOLDER;this.props.canMakeViewerNoComment&&(t=l.MEMBER_ACTION_FOLDER_NO_COMMENT);var n=l.MEMBER_ACTION_FILE;this.props.canMakeViewerNoComment&&(n=l.MEMBER_ACTION_FILE_NO_COMMENT);var s=c("Remove");return this.props.allowRelinquishMembership&&(s=c("Remove my access")),[[a.MEMBER_ACTION.MAKE_EDITOR,{value:a.ACCESS_LEVEL.WRITER,title:e[a.ACCESS_LEVEL.WRITER],folder_description:t[a.MEMBER_ACTION.MAKE_EDITOR],file_description:n[a.MEMBER_ACTION.MAKE_EDITOR]}],[a.MEMBER_ACTION.MAKE_VIEWER,{value:a.ACCESS_LEVEL.READER,title:e[a.ACCESS_LEVEL.READER],folder_description:t[a.MEMBER_ACTION.MAKE_VIEWER],file_description:n[a.MEMBER_ACTION.MAKE_VIEWER]}],[a.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT,{value:a.ACCESS_LEVEL.READER_NO_COMMENT,title:e[a.ACCESS_LEVEL.READER_NO_COMMENT],folder_description:t[a.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT],file_description:n[a.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]}],[a.MEMBER_ACTION.MAKE_OWNER,{value:a.ACCESS_LEVEL.OWNER,title:c("Make owner")}],[a.MEMBER_ACTION.REMOVE,{value:"remove",title:r.createElement("div",{className:"u-font-danger"},s)}]]},t.prototype.renderMenuItem=function(e){var t=this,n=e.value,s=e.title,a=e.file_description,l=e.folder_description,d=null;d=this.props.contentInfo&&this.props.contentInfo.isFolder()?l:a;var c=null;n!==this.props.currentAccess&&(c=function(){return t.props.onAccessChange(n)});var p=null;return n===this.props.currentAccess&&(p=r.createElement(i,{alt:"",group:"web",name:"check_gray"})),r.createElement(o.BubbleMenuItem,{className:"sharing-access-menu-item",key:n,onClick:c},r.createElement("div",{className:"sharing-access-menu-item__left-margin u-l-ib u-l-ib--t"},p),r.createElement("div",{className:"sharing-access-menu-item__label u-l-ib u-l-ib--t"},r.createElement("div",{className:"u-font-nowrap u-font-black sharing-access-menu-item__title"},s),r.createElement("div",{className:"u-font-wrap u-font-meta sharing-access-menu-item__description"},d)))},t.prototype.renderCurrentAccessText=function(e){var t=s({"sharing-access-menu__current-access":!0,"u-font-nowrap":!0,"c-btn--disabled":e,"sharing-access-menu__current-access--button":this.props.asButton,"c-btn":this.props.asButton,"c-btn--secondary":this.props.asButton,"u-trim-margin":this.props.asButton,"c-borderless-button":!this.props.asButton,"change-access-button":!this.props.asButton&&!e}),n=l.ACCESS_NAME[this.props.currentAccess];this.props.canMakeViewerNoComment&&(n=l.ACCESS_NAME_NO_COMMENT[this.props.currentAccess]);var o=null;return e||(o=[r.createElement("div",{className:"gray-arrow",key:"gray"},r.createElement(i,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-gray"})),r.createElement("div",{className:"blue-arrow",key:"blue"},r.createElement(i,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-blue"}))]),r.createElement("button",{className:t},n,o)},t.prototype.render=function(){for(var e=[],t=0,n=this.getMemberActionInfo();t<n.length;t++){var s=n[t],i=s[0],l=s[1];(l.value===this.props.currentAccess||this.props.memberPermissions&&this.props.memberPermissions.get(i)&&this.props.memberPermissions.get(i).allow||l.value===a.MEMBER_ACTION.REMOVE&&this.props.allowRelinquishMembership)&&e.push(this.renderMenuItem(l))}if(e.length<=1||this.props.pendingAccessChange)return this.renderCurrentAccessText(!0);var d=0;return this.props.asButton&&(d=-5),r.createElement(o.BubbleMenu,{targetButton:this.renderCurrentAccessText(this.props.disabled||!1),targetFixed:!0,position:o.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,className:"sharing-access-menu o-list-ui o-list-ui--dividers",items:e,shouldShowArrow:!1,disabled:this.props.disabled,verticalDisplacement:d})},t})(r.Component);p.displayName="SharingBubbleMenu",p.defaultProps={allowRelinquishMembership:!1,asButton:!1,canInviteMembers:!1,canMakeViewerNoComment:!1,disabled:!1,pendingAccessChange:void 0},t.SharingBubbleMenu=p}),define("modules/clean/sharing/views/viewer_info",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){e.when_last_seen&&(this.time_last_seen=new Date(1e3*e.when_last_seen));var t=e.seen_state_user;this.account_id=t.user_id,this.display_name=t.display_name,this.email=t.email,this.photo_circle_url=t.photo_circle_url,this.same_team=!0}return e.prototype.displayName=function(){return this.display_name},e.prototype.memberId=function(){return""},e})();t.ViewerInfo=n}),define("modules/clean/sharing/views/wrapped_group_viewers_maker",["require","exports","external/react","modules/clean/datetime","modules/clean/em_string","modules/clean/react/title_bubble","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a.i18n_default_project("sharing"),d=l._,c=l.ungettext;(function(e){function t(e,t){for(var s=c("%(num_viewers)d viewer","%(num_viewers)d viewers",e.length).format({num_viewers:e.length}),r=e.length<=10,i=r?e.length:9,l=a(e[0],t),d=1;d<i;d++)l=l.concat(n.createElement("br",null),a(e[d],t));if(!r){var p=e.length-i,u=c("and %(num_others)d other","and %(num_others)d others",p).format({num_others:p});l=l.concat(n.createElement("br",null),n.createElement("span",{className:"group-tooltip__member-name"},u))}return{element:n.createElement(o,{content:n.createElement("div",null,l),className:"group-tooltip",children:n.createElement("span",{className:"u-font-meta sharing-member-info__viewer-count-text"},s),position:o.POSITIONS.BOTTOM,isTargetPositionFixed:!0}),elementText:s}}function a(e,t){var o=t.has(e.account_id)?d("Viewing now"):s.ago(e.time_last_seen,!1,!0);return[n.createElement("span",{className:"group-tooltip__member-name"},r.em_snippet(e.displayName(),i.SNIPPET_SIZES.DISPLAY_NAME)),n.createElement("span",{className:"u-font-meta dot"},"·"),o]}e.make=t})(t.WrappedGroupViewersMaker||(t.WrappedGroupViewersMaker={}))}),define("modules/clean/sharing/wizard/exp_share_a_folder_wizard_modal",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/react/flag","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/radio","modules/clean/react/tooltip","modules/clean/static_urls","modules/constants/payments","modules/core/i18n"],function(e,t,n,s,r,o,i,a,l,d,c,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:m._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderContent())},t.prototype.getButtons=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu",t=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},s.createElement("button",{className:"c-btn c-btn--secondary",onClick:this.handleSubmit},m._("Share anyway")),s.createElement("a",{className:"c-btn c-btn--primary u-mar-left-s",href:e},m._("Add more space")));return s.createElement(i.Flag,{spacing:"s",rightAttachment:t})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio(),this.renderFooter())},t.prototype.renderRadio=function(){var e=s.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},s.createElement("span",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("I’d like to create and share a new folder"),this.renderWarningTooltip())),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("I’d like to share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:m._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.renderWarningTooltip=function(){var e=s.createElement(o,{src:p.static_url("/static/images/out-of-space-lp/error-vflis8APx.png"),srcHiRes:p.static_url("/static/images/out-of-space-lp/error@2x-vflgzXrb2.png")}),t=m._("If you create and share a new folder, your contents will not sync to your Dropbox");return s.createElement(c.Tooltip,{tooltip_classname:"exp-shared-folder-wizard__tooltip",position:c.TooltipPosition.TOP,tooltip_contents:t},e)},t.prototype.renderFooter=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__footer u-mar-top-s"},a.reactFormat(m._("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:s.createElement("span",{className:"exp-shared-folder-wizard__footer--warning"})}))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component);h.defaultProps={user:{},onSubmit:function(){},expProOQCreateSFVariant:"OFF"};var _=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:m._("Share a folder from your personal Dropbox"),buttonComponent:this.getButtons()},this.renderContent())},t.prototype.getButtons=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu",t=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},s.createElement("button",{className:"button-as-link",onClick:this.handleSubmit},m._("Continue sharing")),s.createElement("span",{className:"exp-shared-folder-wizard__buttons-or"},"or"),s.createElement("a",{className:"c-btn c-btn--primary",href:e},m._("Upgrade now")));return s.createElement(i.Flag,{spacing:"s",rightAttachment:t})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderHeader(),this.renderRadio())},t.prototype.renderHeader=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__header"},m._("Your Dropbox is full. You currently have 0 MB of personal Dropbox space left.")," ",s.createElement("br",null),m._("What would you like to do?"))},t.prototype.renderRadio=function(){var e=s.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title--bold u-l-ib u-pad-left-xs"},m._("Create and share a new folder")),s.createElement("div",{className:"exp-shared-folder-wizard__option-subtext u-l-ib u-pad-left-xs"},s.createElement("span",{className:"exp-shared-folder-wizard__option-subtext--warning"},m._("If you create and share a new folder, it will not sync to your Dropbox.")))),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title--bold u-l-ib u-pad-left-xs"},m._("Share an existing folder")),s.createElement("div",{className:"exp-shared-folder-wizard__option-subtext u-l-ib u-pad-left-xs"},m._("If you share an existing folder, you will only be able to view contents."))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:m._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component),f=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"existing-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:m._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderHeader(),this.renderContent())},t.prototype.getButtons=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu",t=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},s.createElement("button",{className:"button-as-link",onClick:this.handleSubmit},m._("Continue anyway")),s.createElement("span",{className:"exp-shared-folder-wizard__buttons-or"},"or"),s.createElement("a",{className:"c-btn c-btn--primary",href:e},m._("Upgrade your plan")));return s.createElement(i.Flag,{spacing:"s",rightAttachment:t})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio())},t.prototype.renderHeader=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu";return s.createElement("div",{className:"exp-shared-folder-wizard__header"},a.reactFormat(m._("You have 0 MB of personal Dropbox space left. If you create and share a new folder, it will not sync to your Dropbox. <a>Upgrade your plan to sync more shared folders.</a>"),{a:s.createElement("a",{href:e,"aria-label":m._("Link to upgrade page")})}))},t.prototype.renderRadio=function(){var e=s.createElement("div",{className:"c-radio-wrapper u-pad-m"},s.createElement("input",{disabled:!0,type:"radio",value:"new-folder",id:"radio-existing-folder-disabled","aria-checked":"false"}),s.createElement("label",{className:"c-radio-content",htmlFor:"radio-existing-folder-disabled"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title--disabled u-l-ib u-pad-left-xs"},m._("I’d like to create and share a new folder")))),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("I’d like to share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:m._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component),g=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:m._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderHeader(),this.renderContent(),"new-folder"===this.state.option&&this.renderUpsell())},t.prototype.getButtons=function(){var e=u.OUT_OF_SPACE_URL+"?oqa=sfcu",t=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},"new-folder"===this.state.option?s.createElement("a",{className:"c-btn c-btn--primary",href:e},m._("Upgrade your plan")):s.createElement("button",{className:"c-btn c-btn--primary",onClick:this.handleSubmit},m._("Next")));return s.createElement(i.Flag,{spacing:"s",rightAttachment:t})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio())},t.prototype.renderHeader=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__header--V6"},m._("What do you want to do?"))},t.prototype.renderRadio=function(){var e=s.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("Create and share a new folder"))),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},m._("Share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:m._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.renderUpsell=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__footer-upsell"},a.reactFormat(m._("<warning>Your Dropbox is out of space.</warning> If you try to create and share a new folder, you will not be able to add new content to your Dropbox. Upgrade your plan to get more space."),{warning:s.createElement("span",{className:"exp-shared-folder-wizard__footer-upsell--warning"})}))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component);t.ExpShareAFolderWizardModalV3=r(h,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),t.ExpShareAFolderWizardModalV4=r(_,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),t.ExpShareAFolderWizardModalV5=r(f,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),t.ExpShareAFolderWizardModalV6=r(g,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"])}),function(){var e=function(e,n){function s(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return s.prototype=n.prototype,e.prototype=new s,e.__super__=n.prototype,e},t={}.hasOwnProperty;define("modules/clean/sharing/wizard/share_a_folder_wizard_modal",["external/react","modules/clean/react/css","modules/clean/react/flag","modules/clean/react/image","modules/clean/react/input","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/radio","modules/core/i18n","modules/clean/user","modules/clean/static_urls","modules/clean/viewer"],function(t,n,s,r,o,i,a,l,d,c,p,u){var m,h,_,f,g,y,v,b,S,w,I,E;return o.text,I=i.reactFormat,_=a.Modal,f=l.RadioGroup,g=l.RadioItem,y=l.RadioItemVariant,E=p.static_url,S=t.createElement,w=t.DOM,b=d.i18n_default_project("sharing")._,v=t.createClass({displayName:"ShareAFolderWizardModal",propTypes:{onSubmit:t.PropTypes.func,user:t.PropTypes.instanceOf(c).isRequired},getInitialState:function(){return{option:"new-folder"}},render:function(){return S(_,{autoClose:!1,className:"shared-folder-wizard",buttonComponent:w.span(),title:function(){switch(this.props.user.role){case"work":return b("Share a folder from your %(team_name)s Dropbox").format({team_name:u.get_viewer().team_name});case"personal":return b("Share a folder from your personal Dropbox")}}.call(this)},this._renderContent())},_renderContent:function(){return w.form({className:"shared-folder-wizard__contents",onSubmit:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},this._renderHeader(),this._renderRadio(),this._renderButtons())},_renderHeader:function(){return w.div({className:"shared-folder-wizard__header u-mar-bottom-s"},b("What would you like to do?"))},_renderRadio:function(){var e;return e={value:this.state.option,requestChange:this._handleChange},w.div({className:"radio-input"},S(f,{variant:y.Normal,legend:b("Share a Folder options"),displayLegend:!1,valueLink:e},this._renderRadioItems()))},_renderRadioItems:function(){var e,t;return t=S(g,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},w.div({className:"new-folder_title u-l-ib u-pad-left-xs"},b("I’d like to create and share a new folder"))),e=S(g,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},w.div({className:"existing-folder_title u-l-ib u-pad-left-xs"},b("I’d like to share an existing folder"))),[t,e]},_handleChange:function(e){return this.setState({option:e})},_renderButtons:function(){return w.div({className:"u-mar-top-m clearfix"},w.div({className:"u-l-fr"},w.button({className:"c-btn c-btn--primary",onClick:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},b("Next"))))}}),m=(function(t){function n(e,t,s){n.__super__.constructor.call(this,e,t,s),this.state.showInterstitial=!0}return e(n,t),n.prototype.render=function(){return this.state.showInterstitial?S(_,{autoClose:!1,className:"shared-folder-wizard-interstitial",buttonComponent:w.span(),title:b("Your Dropbox is full")},this._renderInterstitial()):n.__super__.render.call(this)},n.prototype._renderInterstitial=function(){return w.div({
className:"shared-folder-wizard-interstitial"},w.div({className:"shared-folder-wizard-interstitial__content"},w.div({className:"shared-folder-wizard-interstitial__header"},I(b("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:w.span({className:"shared-folder-wizard-interstitial__header--warning"})})),w.div({className:"shared-folder-wizard-interstitial__body"},b("If you create and share a new folder, you can add contents, but it will not sync to your Dropbox."))),w.div({className:"shared-folder-wizard-interstitial__image"},S(r,{src:E("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")})),S(s.Flag,{spacing:"s",rightAttachment:w.div({className:"shared-folder-wizard-interstitial__buttons u-mar-top-l"},w.button({className:"c-btn c-btn--secondary",onClick:(function(e){return function(t){return t.nativeEvent.preventDefault(),e.setState({showInterstitial:!1})}})(this)},b("Share anyway")),w.a({className:"c-btn c-btn--primary u-mar-left-s",href:"/upgrade?oqa=sfcu"},b("Add more space")))}))},n})(v),h=(function(t){function n(e,t,s){n.__super__.constructor.call(this,e,t,s)}return e(n,t),n.prototype.render=function(){return S(_,{autoClose:!1,className:"shared-folder-wizard",buttonComponent:w.span(),title:b("Share a folder from your personal Dropbox")},this._renderContentV2())},n.prototype._renderContentV2=function(){return w.form({className:"shared-folder-wizard__contents",onSubmit:(function(e){return function(t){return t.nativeEvent.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},this._renderHeader(),this._renderRadio(),this._renderUpsell())},n.prototype._renderUpsell=function(){return w.div({className:"shared-folder-wizard-upsell u-mar-top-l"},w.div({className:"shared-folder-wizard-upsell__content"},w.div({className:"shared-folder-wizard-upsell__header"},I(b("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:w.span({className:"shared-folder-wizard-upsell__header--warning"})})),w.div({className:"shared-folder-wizard-upsell__body"},"If you create and share a new folder, you can add contents, but it will not sync to your Dropbox.")),w.div({className:"shared-folder-wizard-upsell__image"},S(r,{src:E("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")})),S(s.Flag,{spacing:"s",rightAttachment:w.div({className:"shared-folder-wizard-upsell__buttons u-mar-top-l"},w.button({className:"c-btn c-btn--secondary"},b("Share anyway")),w.a({className:"c-btn c-btn--primary u-mar-left-s",href:"/upgrade?oqa=sfcu"},b("Add more space")))}))},n})(v),v=n(v,["/static/css/sharing/wizard_modals-vfl2L3rOp.css"]),m=n(m,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),h=n(h,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflqIfPFv.css"]),{ShareAFolderWizardModal:v,ExpShareAFolderWizardModalV1:m,ExpShareAFolderWizardModalV2:h}})}.call(this),function(){define("modules/clean/sharing/wizard/share_existing_folder_wizard_modal",["external/react","modules/clean/react/css","modules/clean/react/input","modules/clean/react/modal","modules/clean/react/tree_view","modules/core/i18n","modules/clean/user","modules/clean/viewer"],function(e,t,n,s,r,o,i,a){var l,d,c,p,u,m;return n.text,d=s.Modal,l=r.FolderTreeView,u=e.createElement,m=e.DOM,p=o.i18n_default_project("sharing")._,c=e.createClass({displayName:"ShareExistingFolderWizardModal",propTypes:{onBack:e.PropTypes.func,onSubmit:e.PropTypes.func,user:e.PropTypes.instanceOf(i).isRequired},getInitialState:function(){return{folderPath:null,errorMsg:null}},render:function(){return u(d,{autoClose:!1,className:"existing-shared-folder-wizard",buttonComponent:m.span(),onDismissCompleted:function(){return d.close()},title:function(){switch(this.props.user.role){case"work":return p("Choose a folder from your %(team_name)s Dropbox").format({team_name:a.get_viewer().team_name});case"personal":return p("Choose a folder from your personal Dropbox")}}.call(this)},this._renderContent())},_renderContent:function(){return m.form({className:"existing-shared-folder-wizard__contents",onSubmit:(function(e){return function(){return e.props.onSubmit(e.state.folderPath,e._setError)}})(this)},this._renderError(),this._renderTreeView(),this._renderButtons())},_renderError:function(){var e;if(null!=this.state.folderPath&&(null!=(e=this.state.errorMsg)?e.length:void 0)>0)return m.div({className:"text-input-error-wrapper"},m.div({className:"text-input-error-text u-font-danger"},this.state.errorMsg))},_renderTreeView:function(){return m.div({className:"wizard-tree-view"},u(l,{user:this.props.user,onFolderSelected:this._setFolderPath,ref:"treeView"}))},_renderButtons:function(){return m.div({className:"u-mar-top-m clearfix"},m.div({className:"u-l-fr"},m.button({className:"c-btn c-btn--primary",disabled:!this._isValid(),onClick:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.folderPath,e._setError)}})(this)},p("Next"))),m.div({className:"u-l-fl"},m.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:(function(e){return function(t){var n,s;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),d.close(),"function"==typeof(s=e.props).onBack?s.onBack():void 0}})(this)},p("Back"))))},_setFolderPath:function(e){return this.setState({folderPath:e,errorMsg:null})},_setError:function(e){var t;return this.setState({errorMsg:null!=e&&null!=(t=e.path)?t.message_text:void 0})},_isValid:function(){return null!=this.state.folderPath&&null==this.state.errorMsg}}),c=t(c,["/static/css/sharing/wizard_modals-vfl2L3rOp.css"]),{ShareExistingFolderWizardModal:c}})}.call(this),function(){var e=[].slice;define("modules/clean/sharing/wizard/wizard_modals",["external/react","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/analytics","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/react/modal","modules/clean/sharing/api","modules/constants/browse","modules/clean/sharing/constants","modules/clean/sharing/share_modal_util","modules/clean/sharing/ui_util","modules/clean/sharing/wizard/share_existing_folder_wizard_modal","modules/clean/sharing/wizard/share_a_folder_wizard_modal","modules/clean/sharing/wizard/exp_share_a_folder_wizard_modal"],function(t,n,s,r,o,i,a,l,d,c,p,u,m,h){var _,f,g,y,v,b,S,w,I,E,C,N,M,T,A,P,k,x,F,L;return _=n.EmailVerification,N=r.SharingExperimentsLogger,w=i.Modal,C=a.SharingApi,M=d.TRUELINK,T=c.generateModalSessionId,k=c.showNewFolderShareModal,L=c.showShareModal,P=p.sharingNotificationError,E=u.ShareExistingFolderWizardModal,I=m.ShareAFolderWizardModal,f=m.ExpShareAFolderWizardModalV1,g=m.ExpShareAFolderWizardModalV2,y=h.ExpShareAFolderWizardModalV3,v=h.ExpShareAFolderWizardModalV4,b=h.ExpShareAFolderWizardModalV5,S=h.ExpShareAFolderWizardModalV6,A=function(e,t,n,s){var r,i,a;return a=function(){if(!L(e,{fqPath:t,isFolder:!0,exists:!0,origin:"WIZARD",shouldFetchNsId:!0,modalSessionId:null!=s?s:void 0}))throw new Error("Tiburon UI must be allowed")},r=function(e){var t;if(t=o.extract_errors(e.responseText),t!==!1)return"string"==typeof t?P(t):"function"==typeof n?n(t):void 0},M.TRUELINK_UI[e.id]?a():(i=new C(e),i.validate_shareable_existing_sf_path(t,a,r))},F=function(n,s,r){return null!=r&&N.log(n.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:r}),w.showInstance(t.createElement(E,{user:n,onBack:s,onSubmit:function(t,s){var o;return o=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],null!=r&&N.log(n.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD_ERROR",{modalSessionId:r}),s.apply(null,t)},null!=r&&N.log(n.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:r}),A(n,t,o)}}))},x=function(e){var n,r,o;if(_.get_for_user(e).verified_or_show(s.SHARE_FOLDER))return o=T(),N.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_A_FOLDER_WIZARD",{modalSessionId:o}),n=l.EXP_SUBGROWTH_PRO_OQ_CREATE_SF,r=(function(){switch(n){case"V1":return f;case"V2":return g;case"V3":return y;case"V4":return v;case"V5":return b;case"V6":return S;default:return I}})(),w.showInstance(t.createElement(r,{user:e,onSubmit:function(t){return null!=o&&N.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_A_FOLDER_WIZARD",{target:t,modalSessionId:o}),"new-folder"===t?k(e,o,e.cdm_tmf_path):"existing-folder"===t?F(e,x.bind(this,e,o),o):void 0},expProOQCreateSFVariant:n})),o},{shareExistingFolder:A,showShareAFolderWizardModal:x}})}.call(this),define("modules/clean/stormcrow/stormcrow_exposure_logger",["require","exports","modules/clean/ajax"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){this.exposures={}}return e.prototype.logExposure=function(e,t){n.SilentBackgroundRequest({url:"/log/stormcrow_exposures",data:{stormcrow_name:e,variant:t}})},e.prototype.logExposuresOnce=function(e){var t=this;Object.keys(e).forEach(function(n){if(!(n in t.exposures)){var s=e[n];n&&s&&(t.exposures[n]=s,t.logExposure(n,s))}})},e})();t.StormcrowExposureLogger=s}),define("modules/clean/teams/admin/api/admin_console_api_client",["require","exports","modules/clean/api_v2/client","modules/clean/filepath","modules/clean/sharing/api/util/types","modules/clean/viewer"],function(e,t,n,s,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){void 0===e&&(e=!1);var t=o.get_viewer();t.work_user&&(this.teamMemberId=t.work_user.team_member_id),this.userId=t.get_uid_by_role("work"),this.rpcClient=new n.TeamActionsClient,this.isCMForCDM=e}return e.prototype.setPermanentDeletePolicy=function(e){var t={permanent_delete_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_permanent_delete_policy",t)},e.prototype.setMultipleAccountsPolicy=function(e){var t={multiple_accounts_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_multiple_accounts_policy",t)},e.prototype.setFileRequestPolicy=function(e){var t={file_request_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_file_request_policy",t)},e.prototype.setOfficeAddInPolicy=function(e){var t={office_addin_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_office_addin_policy",t)},e.prototype.setSharedLinkPolicy=function(e,t){var n={sharing_outside_enabled:e};1==e&&(n.default_visibility=t);return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_link_policy",n)},e.prototype.setSharedFolderSharingPolicy=function(e){var t={sharing_outside_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_folder_sharing_policy",t)},e.prototype.setSharedFolderJoiningPolicy=function(e){var t={joining_outside_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_folder_joining_policy",t)},e.prototype.setCommentingPolicy=function(e){var t={commenting_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_commenting_policy",t)},e.prototype.setPasswordStrength=function(e,t){var n="enabled"===e?t:"minimal_requirements",s={password_strength_policy:n};return this.rpcClient.rpc(this.userId,"team/set_password_requirements",s)},e.prototype.resetAllPasswords=function(){return this.rpcClient.rpc(this.userId,"team/reset_all_passwords")},e.prototype.setViewerInfoSetting=function(e){var t={viewer_info_policy:e};return this.rpcClient.rpc(this.userId,"team/set_viewer_info_policy",t)},e.prototype.setPaperPolicy=function(e,t,n,s){var r={paper_enabled:e};t&&(r.dropbox_terms="agree");var o={paper_deployment_type:n,enabled_members_update:{users_to_add:this.make_user_selector_list(s.users_to_add),users_to_remove:this.make_user_selector_list(s.users_to_remove)}};r.paper_deployment_mode=o;return this.rpcClient.rpc(this.userId,"team/paper/set_paper_policy",r)},e.prototype.setPaperSharingPolicy=function(e,t){var n={external_sharing_allowed:void 0===e||e,default_visibility:t};return this.rpcClient.rpc(this.userId,"team/paper/set_paper_sharing_policy",n)},e.prototype.setRequestMembershipPolicy=function(e){var t={request_membership:e};return this.rpcClient.rpc(this.userId,"team/set_request_membership_policy",t)},e.prototype.setSuggestMembersPolicy=function(e){var t={suggest_members_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_suggest_members_policy",t)},e.prototype.deviceManagementGetExcludedUsers=function(){return this.rpcClient.rpc(this.userId,"team/device_management/get_excluded_users",null)},e.prototype.deviceManagementUpdateExcludedUsers=function(e,t){var n={users_to_add:e,users_to_remove:t};return this.rpcClient.rpc(this.userId,"team/device_management/update_excluded_users",n)},e.prototype.deviceManagementConfigureSettings=function(e){return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",e)},e.mapValueToRolloutMethod=function(e){return 0===e?"unlink_all":1===e?"unlink_most_inactive":"add_member_to_exceptions"},e.prototype.deviceManagementConfigureSettingsForAcf=function(t,n,s,r,o){var i={is_enabled:!0,can_user_remove_device:n,rollout_method:{".tag":e.mapValueToRolloutMethod(o)},users_to_add:t.users_to_add,users_to_remove:t.users_to_remove};i.desktop_devices_limit=s==-1?{".tag":"unlimited"}:{limited:Number(s),".tag":"limited"},i.mobile_devices_limit=r==-1?{".tag":"unlimited"}:{limited:Number(r),".tag":"limited"};return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",i)},e.prototype.deviceManagementExclusionList=function(e){return this.rpcClient.rpc(this.userId,"team/device_management/update_excluded_users",e)},e.prototype.deviceManagementConfigureSettingsDisable=function(){var e={is_enabled:!1};return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",e)},e.prototype.deviceManagementRemoveDevice=function(e,t,n){var s={user_id:e,device_id:t,delete_data:n};return this.rpcClient.rpc(this.userId,"team/device_management/remove_device",s)},e.prototype.deviceManagementRemoveClient=function(e,t,n,s){var r={user_id:e,device_id:t,client_unique_identifier:n,delete_data:s};return this.rpcClient.rpc(this.userId,"team/device_management/remove_client",r)},e.prototype.webSessionManagementConfigureSettings=function(e,t){var n={remember_session_expires:e,idle_session_timeout:t};return this.rpcClient.rpc(this.userId,"team/web_session_management/configure_settings",n)},e.prototype.teamFolderArchive=function(e,t){void 0===t&&(t=!1);var n={team_folder_id:String(e),force_async_off:!t};return this.rpcClient.rpc(this.userId,"team/team_folder/archive",n)},e.prototype.teamFolderUnarchive=function(e){var t={team_folder_id:String(e)};return this.rpcClient.rpc(this.userId,"team/team_folder/activate",t)},e.prototype.teamFolderCreate=function(e){var t={name:e};return this.rpcClient.rpc(this.userId,"team/team_folder/create",t)},e.prototype.teamFoldersList=function(e){void 0===e&&(e=1e3);var t={limit:e};return this.rpcClient.rpc(this.userId,"team/team_folder/list",t)},e.prototype.teamFolderRename=function(e,t){var n={team_folder_id:String(e),name:t};return this.rpcClient.rpc(this.userId,"team/team_folder/rename",n)},e.prototype.teamFolderPermanentlyDelete=function(e){var t={team_folder_id:String(e)};return this.rpcClient.rpc(this.userId,"team/team_folder/permanently_delete",t)},e.prototype.setGroupsCreationPolicy=function(e){var t={group_creation:e};return this.rpcClient.rpc(this.userId,"team/groups/set_creation_policy",t)},e.prototype.setNTSBlockTrafficPolicy=function(e){var t={block_traffic_enabled:e};return this.rpcClient.rpc(this.userId,"team/nts/set_block_traffic_policy",t)},e.prototype.configureSso=function(e,t,n,s,r){var o={sso_policy:e,saml_cert:t,sign_in_url:n,sign_out_url:s,nameid_format:r};return this.rpcClient.rpc(this.userId,"team/configure_sso",o)},e.prototype.configureGoogleLoginPolicy=function(e){var t={google_login_enabled:e};return this.rpcClient.rpc(this.userId,"team/configure_google_login_policy",t)},e.prototype.setResellerSupportSetting=function(e){var t={reseller_support_enabled:e};return this.rpcClient.rpc(this.userId,"team/change_reseller_support",t)},e.prototype.folderCreate=function(e,t,n){"/"!=t&&(t+="/");var s="ns:"+e+t+n,r={path:s},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/create_folder",r,o)},e.prototype.bulkFileDelete=function(e){for(var t=[],n=null,s=0,r=e.length;s<r;s++)n=e[s],t.push({path:"ns:"+n.ns_id+n.ns_path});var o={entries:t},i={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/delete_batch_with_changeset_sync",o,i)},e.prototype.fileRename=function(e,t,n){var s="ns:"+e+t,r=t.substring(0,t.lastIndexOf("/"))+"/"+n,o="ns:"+e+r,i={from_path:s,to_path:o,autorename:!0},a={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/move",i,a)},e.prototype.shareFolder=function(e,t,n,s){void 0===n&&(n=null),void 0===s&&(s=!1);var o="ns:"+e+t,i=r.combinedPolicyDiffToApi(n);i.path=o,i.confidentiality=s?"confidential":"not_confidential";var a={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/alpha/share_folder",i,a)},e.prototype.validateFolderPath=function(e,t,n,s){var r="ns:"+e+t,o={path:r,actions:n,list_members_arg:s},i={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/validate_folder_path",o,i)},e.prototype.restoreFile=function(e,t,n){var s="ns:"+e+t,r={path:s,rev:n},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/restore",r,o)},e.prototype.restorePaths=function(e){var t={entries:e},n={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/restore_path_batch_sync",t,n)},e.prototype.permanentDeleteFile=function(e,t){var n="ns:"+e+t,s={path:n},r={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/permanently_delete",s,r)},e.prototype.listRevisions=function(e,t){var n="ns:"+e+t,s={path:n},r={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/list_revisions",s,r)},e.prototype.setTSDWritePolicy=function(e){var t={is_writable:e};return this.rpcClient.rpc(this.userId,"team/team_folder/set_tsd_writable_setting",t)},e.prototype.setInfinitePolicy=function(e){var t={setting:e};return this.rpcClient.rpc(this.userId,"team/set_infinite_policy",t)},e.prototype.setSmartSyncDesktopPolicy=function(e){var t={setting:e};return this.rpcClient.rpc(this.userId,"team/set_smart_sync_desktop_policy",t)},e.prototype.getTeamFolderNsPathForFile=function(e){return this.isCMForCDM?e.fq_path:"/"+e.fq_path.split("/").slice(2).join("/")},e.prototype.bulkFileMove=function(e,t,n){for(var r,o,i=[],a=null,l=0,d=t.length;l<d;l++)r=t[l],a=this.getTeamFolderNsPathForFile(r),o=s.filename(r.fq_path),i.push({from_path:"ns:"+e+a,to_path:"ns:"+e+n+"/"+o});var c={entries:i,autorename:!0},p={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/move_batch_sync",c,p)},e.prototype.bulkFileCopy=function(e,t,n,r){void 0===r&&(r=null);for(var o,i,a=[],l=null,d=0,c=t.length;d<c;d++)o=t[d],l=this.getTeamFolderNsPathForFile(o),i=s.filename(o.fq_path),a.push({from_path:"ns:"+e+l,to_path:"ns:"+e+n+"/"+i});var p={entries:a,autorename:!0,allow_shared_folder:!0,fsw_request:r},u={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/copy_batch_sync",p,u)},e.prototype.setMemberSpaceLimits=function(e){var t={limit_level:e};return this.rpcClient.rpc(this.userId,"team/member_space_limits/set_default_limit",t)},e.prototype.setMslCapsType=function(e){var t={caps_type:e};return this.rpcClient.rpc(this.userId,"team/member_space_limits/set_caps_type",t)},e.prototype.setCustomQuota=function(e,t){var n={users_and_quotas:[{user:this._create_user_selector_json(e),quota_gb:t}]};return this.rpcClient.rpc(this.userId,"team/member_space_limits/set_custom_quota",n)},e.prototype.removeCustomQuota=function(e){var t={users:[this._create_user_selector_json(e)]};return this.rpcClient.rpc(this.userId,"team/member_space_limits/remove_custom_quota",t)},e.prototype._create_user_selector_json=function(e){return{".tag":"email",email:e}},e.prototype.make_user_selector_list=function(e){return void 0===e&&(e=[]),e.map(this._create_user_selector_json)},e.prototype.memberSpaceLimitsUpdateExclusionList=function(e){var t=this.make_user_selector_list(e.users_to_add),n=this.make_user_selector_list(e.users_to_remove);return this.rpcClient.rpc(this.userId,"team/member_space_limits/update_excluded_users",{users_to_add:t,users_to_remove:n})},e.prototype.listAllMembers=function(e,t){void 0===t&&(t=null);var n={shared_folder_id:String(e)};t&&(n.path=t);var s={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/list_all_members",n,s)},e.prototype.teamFolderGetAccessPoints=function(e,t,n){var s={dropbox_id:e,team_folder_id:String(t),path:n};return this.rpcClient.rpc(this.userId,"team/team_folder/get_access_points",s)},e.prototype.teamFolderGetFileMetadata=function(e,t){void 0===t&&(t=null);var n={team_folder_id:String(e)};return t&&(n.path=t),this.rpcClient.rpc(this.userId,"team/team_folder/get_file_metadata",n)},e.prototype.getUserInfos=function(e){var t={account_ids:e},n={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"users/get_account_batch",t,n)},e.prototype.emmConfigureSettings=function(e,t){var n=this,s={};["users_to_add","users_to_remove"].forEach(function(e){return s[e]=n.make_user_selector_list(t[e])});var r={emm_policy:{".tag":e},exclusion_list:s};return this.rpcClient.rpc(this.userId,"team/emm/configure_settings",r)},e.prototype.emmRefreshToken=function(){return this.rpcClient.rpc(this.userId,"team/emm/refresh_token")},e.prototype.emmGenerateUsageReport=function(){var e={report_type:"mobile_app_usage"};return this.rpcClient.rpc(this.userId,"team/emm/generate_report",e)},e})();t.AdminConsoleApiClient=i,t.default=i}),function(){define("modules/clean/teams/membership_discovery_util",["modules/clean/ajax","modules/clean/loggers/growth_features_events_logger","modules/clean/react/modal","modules/constants/python","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,s,r,o,i,a){var l,d,c,p,u,m,h,_,f;return l=s.TRADEMARK_BUSINESS,d=o._,f=o.ungettext,p=function(t,n){return e.WebRequest({url:"/team/discover/get_discoverable_team_for_folder",type:"POST",data:{ns_id:t},success:function(e){return e=JSON.parse(e),n(null!=e?e.team:void 0)},error:function(){return n()}})},h=function(t,n){return e.WebRequest({url:"/team/discover/join_ajax",data:{team_id:t,cont:"#"},success:function(e){switch(e=JSON.parse(e),null!=e?e.result:void 0){case"request_sent":i.success(d("Request to join sent."));break;case"can_join":r.redirect(e.url);break;case"max_team_size_achieved":i.error(d("This team has reached the maximum size. Please ask the admins of this team to upgrade to %(trademark_business)s, which allows teams to add as many members as possible.").format({trademark_business:l}));break;case"pending_approval":i.success(d("Your request to join is pending."));break;default:i.error(d("Invalid request"))}return"function"==typeof n?n(e):void 0},error:function(){return i.error(d("Error sending request.")),"function"==typeof n?n():void 0}})},m=function(t,n,s){return e.WebRequest({url:"/account/team/add_users",subject_user:n,data:{emails:t,team_id:s},success:function(e){var t;if(e=JSON.parse(e),e.num_invited)return t=f("Invitation sent.","Invitations sent.",e.num_invited),i.success(t)},error:function(){var e;return e=f("Error sending invitation.","Error sending invitations.",t.length),i.error(e)}})},u=function(s,o,l,c){return e.WebRequest({url:"/account/team/add_users",subject_user:o,data:{emails:s,team_id:l},success:function(e){var n,r;if(n={subject_user_id:o.id,team_id:l,num_suggested_users:s.length},t.logMagnetEvent("send_admin_invite_ajax_success",n),e=JSON.parse(e),e.num_invited)return r=f("Invitation sent.","Invitations sent.",e.num_invited),i.success(r)},error:function(e){var i;return i={subject_user_id:o.id,team_id:l,num_suggested_users:s.length,response_text:e.responseText},t.logMagnetEvent("send_admin_invite_ajax_fail",i),e.responseText.includes("You need an additional license to invite this user.")?n.SimpleModal.show({title_text:d("No available licenses"),body_html:d("You don’t have enough available licenses to invite additional members. Please visit the admin console to purchase more licenses."),confirm_text:d("Go to admin console"),confirm_callback:function(){return i={team_id:l,ui_object:"not_enough_licenses_modal"},t.logMagnetEvent("go_to_admin_console_clicked",i),r.redirect(new a({path:"/team/admin/members"}))},cancel_text:d("Not now"),cancel_callback:function(){return i={team_id:l,ui_object:"not_enough_licenses_modal"},t.logMagnetEvent("not_now_clicked",i)}}):_(s,c,function(){return r.redirect(new a({path:"/team/admin/requests",query:{invite_emails:s}}))})}})},_=function(t,n,s,r){return e.WebRequest({url:"/team/discover/suggest_ajax",data:{emails:JSON.stringify(t),ns_id:JSON.stringify(n)},success:function(e){var n;return n=f("Suggestion sent.","Suggestions sent.",t.length),i.success(n),"function"==typeof s?s(e):void 0},error:function(){var e;return e=f("Error sending suggestion.","Error sending suggestions.",t.length),i.error(e),"function"==typeof r?r():void 0}})},c=function(t,n,s){return e.WebRequest({url:"/team/discover/filter_suggestable_ajax",type:"POST",data:{emails:JSON.stringify(t)},success:function(e){return e=JSON.parse(e),"function"==typeof n?n(e):void 0},error:function(){return"function"==typeof s?s():void 0}})},{getDiscoverableTeamForFolder:p,sendAdminTeamInvitations:u,sendTeamRequest:h,sendLimitedTeamInvitations:m,sendTeamSuggestions:_,filterSuggestableUsers:c}})}.call(this),define("modules/clean/teams/modals/create_team_prompt_modal",["require","exports","tslib","external/react","modules/clean/ajax","modules/clean/analytics","modules/clean/react/button","modules/clean/react/image","modules/clean/react/modal","modules/clean/static_urls","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,s,r,o,i,a,l,d,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m;(function(e){e[e.CLICK_CREATE=0]="CLICK_CREATE",e[e.DISMISS=1]="DISMISS",e[e.CLICK_NEXT_TIME=2]="CLICK_NEXT_TIME"})(m||(m={}));var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickCreate=function(){var e=t.props.invitedMembers.map(function(e){return e.email}).filter(function(e){return"string"==typeof e&&""!==e}),n=new u({path:"/team",query:{tk:"tib_upsell",invite_members:e.join(",")}});c.redirect(n.toString()),t.logClick(m.CLICK_CREATE)},t.onClickNextTime=function(){l.Modal.close(),t.logClick(m.CLICK_NEXT_TIME)},t.onDismiss=function(){r.WebRequest({url:"/team/stop_show_create_team_modal"}),t.logClick(m.DISMISS)},t}return n.__extends(t,e),t.prototype.logClick=function(e){o.TeamsWebActionsLogger.log("share_crt_team_modal",{num_shared:this.props.invitedMembers.length,clicked_create:e===m.CLICK_CREATE,clicked_nxt_time:e===m.CLICK_NEXT_TIME,dismissed:e===m.DISMISS})},t.prototype.renderButtons=function(){return s.createElement("div",{className:"db-modal-buttons"},s.createElement(i.Button,{className:"dbmodal-button",importance:"primary",onClick:this.onClickCreate},p._("Create free work Dropbox")),s.createElement(i.Button,{className:"dbmodal-button",importance:"tertiary",onClick:this.onClickNextTime},p._("Ask me next time")))},t.prototype.render=function(){for(var e=[],t=0,n=this.props.invitedMembers;t<n.length;t++){var r=n[t];r.name&&r.name!==r.email&&e.push(r.name)}var o=p._("Work with these people often?");return 2===e.length&&2===this.props.invitedMembers.length?o=p._("Work with %(firstname_1)s and %(firstname_2)s often?").format({firstname_1:e[0],firstname_2:e[1]}):3===e.length&&3===this.props.invitedMembers.length&&(o=p._("Work with %(firstname_1)s, %(firstname_2)s, and %(firstname_3)s often?").format({firstname_1:e[0],firstname_2:e[1],firstname_3:e[2]})),s.createElement(l.Modal,{style:"clean",className:"create-team-modal-after-sharing",buttonComponent:this.renderButtons(),onDismiss:this.onDismiss,clickOutToClose:!1,showX:!0,width:500},s.createElement("div",null,s.createElement(a,{className:"create-team-modal__team-illo u-mar-top-l",alt:p._("Work together"),src:d.static_url("/static/images/teams/modals/illo_how-create-vfl99WbqQ.png"),srcHiRes:d.static_url("/static/images/teams/modals/illo_how-create@2x-vflvsB25f.png")}),s.createElement("h1",{className:"create-team-modal__header u-mar-top-m u-mar-bottom-s"},o),s.createElement("div",{className:"create-team-modal__subheader"},p._("Get a free 2 GB work Dropbox to organize projects in one place,               collaborate from anywhere, and stay in sync."))))},t})(s.Component);t.CreateTeamPromptModal=h});
//# sourceMappingURL=pkg-sharing.min.js-vfloFIPLG.map